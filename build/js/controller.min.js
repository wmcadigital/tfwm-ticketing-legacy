!function(){"use strict";function e(e,t,o,n,i,r,a,l,s){const c=this;function u(){c.deviceDetector=a,c.userAgent=a.raw.userAgent,c.userAgent.includes("SwiftOneApp")?c.oneApp=!0:c.oneApp=!1,c.userAgent.includes("android")?c.android=!0:c.android=!1}var m;function d(){s.innerWidth<890?(c.includeMobileTemplate=!0,c.includeDesktopTemplate=!1):(c.includeMobileTemplate=!1,c.includeDesktopTemplate=!0)}c.loadingText="Loading...",c.loadingStatus="loading",c.loadingArray=["Well, what are you waiting for?","Are we there yet?","Warming up the processors...","Reconfiguring the office coffee machine...","Doing something useful...","Are you ready?","So, do you come here often?","This may take some time...","I know this is painful to watch, but I have to load this.","Oh, no! Loading time...","Still Waiting... huh","Waiting for something in the server.","Creating randomly generated feature.","It's not you. It's me.","Eating your internet cookies...Yummy!"],c.loading=t((function(){c.loadingText=c.loadingArray[Math.round(Math.random()*(c.loadingArray.length-1))]}),3500),c.ticketID=n.ticket,c.filterAccordions={},c.relatedTickets={},c.priceLevelsList={},c.toggleClick=function(e){c.filterAccordions[e]=!c.filterAccordions[e]},c.modalShown=!1,c.toggleModal=function(){c.modalShown=!c.modalShown},c.toggleModalBus=function(){c.modalShownBus=!c.modalShownBus},c.toggleModalTrain=function(){c.modalShownTrain=!c.modalShownTrain},c.toggleModalSwift=function(){c.modalShownSwift=!c.modalShownSwift},c.toggleModalGPay=function(){c.modalShownGpay=!c.modalShownGpay},c.widthView=d,c.operatorList=[],c.limit=4,c.deviceDetect=u,c.openFilters=function(){document.getElementById("filterOverlay").style.display="block"},c.closeFilters=function(){document.getElementById("filterOverlay").style.display="none"},c.date=new Date,c.deviceDetect=u,c.gpay=!1,c.searchLocation=l.host(),c.deviceDetect(),m=c.ticketID,e.getTicket(m).then((function(t){c.all=t,c.all.relatedTickets.length&&(c.related=[],angular.forEach(c.all.relatedTickets,(function(t){e.getTicket(t.id).then((function(e){c.relatedTickets[t.id]=e,c.relatedList=c.relatedTickets[t.id],c.related.push(c.relatedList)}))}),c.related)),c.all.documents.length&&e.getTerms(m).then((function(e){c.relatedTerms=e})),e.getOperators().then((function(e){c.operatorList=e})),c.backToSearch=o,c.stationFromNameZone="1",c.loadingStatus="success"})),function(t){e.getTicketFull(t).then((function(e){c.full=e,c.priceLevels=e.priceLevels,c.gpay=!1,c.priceLevelsList=c.priceLevels.map((function(e){return!!e.type.includes("Google Pay")&&(c.gpay=!0,!0)}))}))}(c.ticketID),c.modalShownBus=!1,c.modalShownTrain=!1,c.modalShown=!1,c.modalShownSwift=!1,c.modalShownGpay=!1,c.includeDesktopTemplate=!1,c.includeMobileTemplate=!1,d();angular.element(s).bind("resize",(function(){d()}))}function t(){return function(e){return e?String(e).replace(/<[^>]+>/gm,""):""}}function o(){return function(e){return e?String(e).replace(/\n/gm,"<br><br>"):""}}angular.module("ticketingApp").controller("TicketDetailCtrl",e).filter("removeHTMLTags",t).filter("escapeFilter",o).directive("modalDialog",(function(){return{restrict:"E",scope:{show:"="},replace:!0,transclude:!0,link:function(e,t,o){e.dialogStyle={},o.width&&(e.dialogStyle.width=o.width),o.height&&(e.dialogStyle.height=o.height),o.modalclass&&(e.dialogStyle.class=o.modalclass),e.hideModal=function(){e.show=!1}},template:'<div ng-show="show" class="mod"><div ng-show="show" class="modal" ng-click="hideModal()"></div><div class="overlay modal-content {{dialogStyle.class}}" ng-style="dialogStyle"><div class="ng-modal-close modal__close js-modal-close" ng-click="hideModal()">X</div><div class="ng-modal-dialog-content" ng-transclude></div></div></div>'}})).directive("tabs",(function(){return{restrict:"E",transclude:!0,scope:{},controller:["$scope",function(e){const t=e.panes=[];e.select=function(e){angular.forEach(t,(function(e){e.selected=!1})),e.selected=!0},this.addPane=function(o){0===t.length&&e.select(o),t.push(o)}}],template:'<div class="cfx"><div class="arrdep-filters__toggle"><div class="radio-bar"><span ng-repeat="pane in panes" ng-class="{active:pane.selected}"><input name="option" id="{{pane.title}}" type="radio"><label ng-click="select(pane)" for="{{pane.title}}" style="height: 44px;">{{pane.title}}</label></span></div></div><div class="tab-content" ng-transclude></div></div>',replace:!0}})).directive("pane",(function(){return{require:"^tabs",restrict:"E",transclude:!0,scope:{title:"@"},link:function(e,t,o,n){n.addPane(e)},template:'<div class="tab-pane" ng-class="{active: selected}" ng-transclude></div>',replace:!0}})).directive("tooltip",(function(){return{restrict:"A",controller:["$scope",function(e){e.isShown=!1,this.showHover=function(){e.isShown=!0!==e.isShown}}],transclude:!0,link:function(e,t,o,n){e.copy=o.tooltipc,t.bind("click",(function(){e.$apply((function(){n.showHover()}))}))},template:'<div ng-transclude></div><p class="field-help tooltip" ng-show="isShown"><span class="close modal__close"></span><span data-ng-bind-html="copy"></span></p>'}})),e.$inject=["ticketingService","$interval","getURL","$routeParams","$scope","$timeout","deviceDetector","$location","$window"],t.$inject=[],o.$inject=[]}(),function(){"use strict";function e(e,t,o,n,i,r,a,l,s,c,u){const m=this;let d,f,h;function p(){m.all=[],m.filteredTickets=[],m.origTickets=[],m.otherTickets=[],m.stationList=[],m.stationoocList=[],m.stationicList=[],m.swiftPaygIds=[],m.loadingStatus="",m.swiftPaygloadingStatus="",m.passValue="",m.orderBy="orderSequence",m.limit=parseInt(r.search().limit)||6,m.limitExact=parseInt(r.search().limitExact)||6,m.postJSON={allowBus:r.search().allowBus||null,allowMetro:r.search().allowMetro||null,allowTrain:r.search().allowTrain||null,passengerType:r.search().passengerType||"",timeBand:r.search().timeBand||"",brand:r.search().brand||null,stationNames:r.search().stationNames||null},m.stationFromName=null,m.stationToName=null,m.stationFromTitle=null,m.stationToTitle=null,m.stationFromNameOocZ5=null,m.stationToNameOocZ5=null,m.fromStationInfo=null,m.excludebusParameter=r.search().excludeBus||null,m.buyOnDirectDebitParameter=r.search().buyOnDirectDebit||null,m.buyOnDirectPurchaseParameter=r.search().buyOnDirectPurchase||null,m.buyOnSwiftParameter=r.search().buyOnSwift||null,m.hasOnlinePurchaseChannelParameter=r.search().hasOnlinePurchaseChannel||null,m.purchaseTicParameter=r.search().purchaseTic||null,m.purchaseRailStationParameter=r.search().purchaseRailStation||null,m.purchasePayzoneParameter=r.search().purchasePayzone||null,m.busTravelAreaParameter=r.search().busTravelArea||null,m.operatorParameter=r.search().operator||null,m.railZoneFromParameter=r.search().railZoneFrom||null,m.railZoneToParameter=r.search().railZoneTo||null,m.timePeriodAnytimeParameter=r.search().timePeriodAll||null,m.timePeriod1Parameter=r.search().timePeriod1||null,m.timePeriod2Parameter=r.search().timePeriod2||null,m.timePeriod3Parameter=r.search().timePeriod3||null,m.timePeriod4Parameter=r.search().timePeriod4||null,m.clearModes=P,m.postedJSON={},m.stationFromReq=!1,m.stationToReq=!1,m.stationToReqtwo=!1,m.stationFromOOCReq=!0,m.timePeriodAll=!0,m.fromZoneNumber=null,m.toZoneNumber=null}function O(e){let t,n,a,s,c,u,d,f,h,p,O;m.loadingStatus="loading",angular.copy(m.postJSON,m.postedJSON),r.search({allowBus:m.postedJSON.allowBus,allowTrain:m.postedJSON.allowTrain,allowMetro:m.postedJSON.allowMetro,passengerType:m.postedJSON.passengerType,timeBand:m.postedJSON.timeBand,brand:m.postedJSON.brand,stationNames:m.postedJSON.stationNames,buyOnDirectDebit:m.buyOnDirectDebitParameter,buyOnDirectPurchase:m.buyOnDirectPurchaseParameter,buyOnSwift:m.buyOnSwiftParameter,hasOnlinePurchaseChannel:m.hasOnlinePurchaseChannelParameter,purchaseTic:m.purchaseTicParameter,purchaseRailStation:m.purchaseRailStationParameter,purchasePayzone:m.purchasePayzoneParameter,busTravelArea:m.busTravelAreaParameter,operator:m.operatorParameter,railZoneFrom:m.railZoneFromParameter,railZoneTo:m.railZoneToParameter,timePeriodAll:m.timePeriodAnytimeParameter,timePeriod1:m.timePeriod1Parameter,timePeriod2:m.timePeriod2Parameter,timePeriod3:m.timePeriod3Parameter,timePeriod4:m.timePeriod4Parameter,limit:m.limit,limitExact:m.limitExact,excludeBus:m.excludebusParameter}),m.searchFilters={},m.origFilters={},l.ticketSearch(e).then((function(e){for(m.all=e,m.original=e,angular.forEach(m.all,(function(e){-1===m.filterButtons.operator.indexOf(e.operator)&&m.filterButtons.operator.push(e.operator),-1===m.filterButtons.busTravelArea.indexOf(e.busTravelArea)&&m.filterButtons.busTravelArea.push(e.busTravelArea),-1===m.filterButtons.railZoneFrom.indexOf(e.railZoneFrom)&&m.filterButtons.railZoneFrom.push(e.railZoneFrom),-1===m.filterButtons.railZoneTo.indexOf(e.railZoneTo)&&m.filterButtons.railZoneTo.push(e.railZoneTo)})),t=m.postedJSON.allowBus||!1,n=m.postedJSON.allowTrain||!1,a=m.postedJSON.allowMetro||!1,!0!==m.postJSON.allowTrain&&"nnetwork"!==m.postJSON.brand&&"ntrain"!==m.postJSON.brand||(null!=m.fromStationInfoZone?m.fromZoneNumber=m.fromStationInfoZone:null!=m.fromStationInfo?m.fromZoneNumber=m.fromStationInfo.zone:m.fromZoneNumber=null,null!=m.toStationInfoZone?m.toZoneNumber=m.toStationInfoZone:null!=m.toStationInfo?m.toZoneNumber=m.toStationInfo.zone:m.toZoneNumber=null,"1"===m.fromZoneNumber?m.ffromzone=1:"2"===m.fromZoneNumber?m.ffromzone=2:"3"===m.fromZoneNumber?m.ffromzone=3:"4"===m.fromZoneNumber?m.ffromzone=4:"5"===m.fromZoneNumber?m.ffromzone=5:m.ffromzone=null,"1"===m.toZoneNumber?m.ftozone=1:"2"===m.toZoneNumber?m.ftozone=2:"3"===m.toZoneNumber?m.ftozone=3:"4"===m.toZoneNumber?m.ftozone=4:"5"===m.toZoneNumber?m.ftozone=5:m.ftozone=null,"1"===m.ViaOneZoneNumber?m.fViaOnezone=1:"2"===m.ViaOneZoneNumber?m.fViaOnezone=2:"3"===m.ViaOneZoneNumber?m.fViaOnezone=3:"4"===m.ViaOneZoneNumber?m.fViaOnezone=4:"5"===m.ViaOneZoneNumber?m.fViaOnezone=5:m.fViaOnezone=null,null!=m.ViaOneZoneNumber&&(m.ViaOneZoneNumber<m.fromZoneNumber?m.ffromzone=m.ViaOneZoneNumber:m.ViaOneZoneNumber>m.toZoneNumber&&(m.ftozone=m.ViaOneZoneNumber))),!0===m.postJSON.allowTrain?(m.exactMatch=[],null!==m.fromZoneNumber&&null!==m.toZoneNumber?m.ffromzone<m.ftozone?m.exactMatch=i("filter")(e,{allowBus:t,allowTrain:n,allowMetro:a,railZoneFrom:m.ffromzone,railZoneTo:m.ftozone}):m.ffromzone>m.ftozone?m.exactMatch=i("filter")(e,{allowBus:t,allowTrain:n,allowMetro:a,railZoneFrom:m.ftozone,railZoneTo:m.ffromzone}):m.ffromzone===m.ftozone&&(m.exactMatch=i("filter")(e,{allowBus:t,allowTrain:n,allowMetro:a,railZoneFrom:1,railZoneTo:m.ftozone})):m.exactMatch=i("filter")(e,{allowBus:t,allowTrain:n,allowMetro:a})):"nnetwork"===m.postJSON.brand||"ntrain"===m.postJSON.brand?(m.exactMatch=[],null!==m.fromZoneNumber&&null!==m.toZoneNumber?m.ffromzone<m.ftozone?m.exactMatch=i("filter")(e,{railZoneFrom:m.ffromzone,railZoneTo:m.ftozone}):m.ffromzone>m.ftozone?m.exactMatch=i("filter")(e,{railZoneFrom:m.ftozone,railZoneTo:m.ffromzone}):m.ffromzone===m.ftozone&&(m.exactMatch=i("filter")(e,{railZoneFrom:1,railZoneTo:m.ftozone})):m.exactMatch=i("filter")(e,{})):(m.postedJSON.stationNames=null,m.exactMatch=i("filter")(e,{allowBus:t,allowTrain:n,allowMetro:a})),p=m.all,O=m.exactMatch,s=0;s<O.length;s+=1)for(u=p.length,c=0;c<u;c+=1)O[s]===p[c]&&(p=p.slice(0,c).concat(p.slice(c+1,u)));m.otherResults=p,d=m.postedJSON.allowBus,f=m.postedJSON.allowTrain,h=m.postedJSON.allowMetro,(null!==d||null!==d&&null!==f||null!==d&&null!==h||null!==f&&null!==h)&&m.toggleFilter("mode"),null!==d&&null!==f&&null!==h&&m.toggleFilter("payment"),m.update(),m.loadingStatus="success",r.hash("sbmBtn"),o()}))}function S(){n((function(){n((function(){let e,t,o,n,i,r,l;m.filteredTickets.length&&(l={passengerType:m.postedJSON.passengerType,timeBand:m.postedJSON.timeBand,brand:m.postedJSON.brand,stationNames:m.postedJSON.stationNames,busTravelArea:m.searchFilters.busTravelArea,operator:m.searchFilters.operator,buyOnDirectDebit:m.searchFilters.buyOnDirectDebit,buyOnDirectPurchase:m.searchFilters.buyOnDirectPurchase||null,buyOnSwift:m.searchFilters.buyOnSwift,hasOnlinePurchaseChannel:m.searchFilters.hasOnlinePurchaseChannel,purchaseTic:m.searchFilters.purchaseTic,purchaseRailStation:m.searchFilters.purchaseRailStation,purchasePayzone:m.searchFilters.purchasePayzone,railZoneFrom:m.searchFilters.railZoneFrom,railZoneTo:m.searchFilters.railZoneTo,limit:m.limit,limitExact:m.limitExact,excludeBus:m.searchFilters.allowBus},t=c(l),m.postedJSON.allowBus&&(o="allowBus"),m.postedJSON.allowTrain&&(n="allowTrain"),m.postedJSON.allowMetro&&(i="allowMetro"),r=!0===m.searchFilters.timePeriod1?"&timePeriod1=true&timePeriod2=false&timePeriod3=false&timePeriod4=false":!0===m.searchFilters.timePeriod2?"&timePeriod1=false&timePeriod2=true&timePeriod3=false&timePeriod4=false":!0===m.searchFilters.timePeriod3?"&timePeriod1=false&timePeriod2=false&timePeriod3=true&timePeriod4=false":!0===m.searchFilters.timePeriod4?"&timePeriod1=false&timePeriod2=false&timePeriod3=false&timePeriod4=true":!0===m.timePeriodAll?"&timePeriodAll=true":"",!m.postedJSON.allowBus||m.postedJSON.allowTrain||m.postedJSON.allowMetro||(e="/?"+o+"&"+t+r,a.set("url",e)),m.postedJSON.allowBus&&m.postedJSON.allowTrain&&!m.postedJSON.allowMetro&&(e="/?"+o+"&"+n+"&"+t+r,a.set("url",e)),m.postedJSON.allowBus&&!m.postedJSON.allowTrain&&m.postedJSON.allowMetro&&(e="/?"+o+"&"+i+"&"+t+r,a.set("url",e)),m.postedJSON.allowBus||!m.postedJSON.allowTrain||m.postedJSON.allowMetro||(e="/?"+n+"&"+t+r,a.set("url",e)),!m.postedJSON.allowBus&&m.postedJSON.allowTrain&&m.postedJSON.allowMetro&&(e="/?"+n+"&"+i+"&"+t+r,a.set("url",e)),m.postedJSON.allowBus||m.postedJSON.allowTrain||!m.postedJSON.allowMetro||(e="/?"+i+"&"+t+r,a.set("url",e)),m.postedJSON.allowBus&&m.postedJSON.allowTrain&&m.postedJSON.allowMetro&&(e="/?"+o+"&"+n+"&"+i+"&"+t+r,a.set("url",e)),m.postedJSON.allowBus||m.postedJSON.allowTrain||m.postedJSON.allowMetro||(e="/?"+t+r,a.set("url",e)))}),0,!1)}),0,!1)}function P(){m.postJSON.allowBus=null,m.postJSON.allowTrain=null,m.postJSON.allowMetro=null}function N(){t.$broadcast("angucomplete-alt:clearInput","stationFrom"),m.stationFromName=null,m.postJSON.stationNames=null,m.stationFromReq=!1,m.stationFromNameOocZ5=null,m.fromStationInfoZone=null,m.fromStationText=null}function g(){t.$broadcast("angucomplete-alt:clearInput","stationTo"),m.stationToName=null,m.postJSON.stationNames=null,m.stationToReq=!1,m.stationToNameOocZ5=null,m.toStationInfoZone=null,m.toStationText=null}function T(){t.$broadcast("angucomplete-alt:clearInput","stationViaOne"),m.stationViaOneName=null,m.viaOneStationText=null,m.stationViaOneName=null,m.postJSON.stationNames=null}function b(){angular.element(document).ready((function(){n((function(){s.origTicketResults.refresh()}),0)}))}function w(){angular.element(document).ready((function(){n((function(){s.ticketResults.refresh()}),0)}))}function F(){m.passValue=m.postJSON.brand,"Swift PAYG"===m.passValue?(m.isHideCheck=!m.isHideCheck,m.postJSON.passengerType=null,m.postJSON.timeBand=null,m.postJSON.stationNames=null):"nbus"!==m.passValue&&"National Express"!==m.passValue&&"Diamond Bus"!==m.passValue&&"Stagecoach"!==m.passValue&&"Swift PAYG"!==m.passValue&&"West Midlands Metro"!==m.passValue||(m.postJSON.stationNames=null)}function y(){m.passValue=m.postJSON.brand,"Swift Go"===m.passValue?(m.isHideCheck=!m.isHideCheck,m.postJSON.timeBand=null,m.postJSON.stationNames=null):"nbus"!==m.passValue&&"National Express"!==m.passValue&&"Diamond Bus"!==m.passValue&&"Stagecoach"!==m.passValue&&"Swift PAYG"!==m.passValue&&"West Midlands Metro"!==m.passValue||(m.postJSON.stationNames=null)}function B(){l.getSwiftSearch().then((function(e){m.swiftPaygIds=[],angular.forEach(e,(function(e){e.swiftCurrentAmount&&m.swiftPaygIds.push(e)}))}))}m.submit=O,m.clearFilter=function(){r.url("").replace(),p(),m.excludeBusCheck=function(){return!1},m.excludeTrainCheck=function(){return!1},m.excludeTramCheck=function(){return!1},m.buyOnDirectDebitCheck=function(){return!1},m.buyOnDirectPurchaseCheck=function(){return!1},m.buyOnSwiftCheck=function(){return!1},m.hasOnlinePurchaseChannelCheck=function(){return!1},m.purchaseTicCheck=function(){return!1},m.purchaseRailStationCheck=function(){return!1},m.purchasePayzoneCheck=function(){return!1},m.timePeriod1CheckAll=function(){return!1},m.timePeriod1Check=function(){return!1},m.timePeriod2Check=function(){return!1},m.timePeriod3Check=function(){return!1},m.timePeriod4Check=function(){return!1},a.set("url",""),m.postJSON.stationNames=null,N(),g(),T()},m.getStations=function(){l.getStations().then((function(e){let t,o,n,r,a,l,s,c,u;m.stationList=e,null!==m.stationFromName&&(t=m.stationFromName||null,o=m.stationToName||null,n=m.stationViaOneName||null,r=i("filter")(e,{name:t}),a=i("filter")(e,{name:o}),l=i("filter")(e,{name:n}),s=r[0],c=a[0],u=l[0],m.fromStationInfo=s,m.toStationInfo=c,m.ViaOneStationInfo=u,null!=m.fromStationInfo&&(m.fromZoneNumber=m.fromStationInfo.zone,m.toZoneNumber=m.toStationInfo.zone,null!=m.ViaOneStationInfo&&(m.ViaOneZoneNumber=m.ViaOneStationInfo.zone)))}))},m.getoocStations=function(){l.getStations().then((function(e){const t=i("filter")(e,{outOfCounty:"true"});m.stationoocList=t}))},m.geticStations=function(){l.getStations().then((function(e){const t=i("filter")(e,{outOfCounty:"false"});m.stationicList=t}))},m.clearFromStation=N,m.clearToStation=g,m.clearViaOneStation=T,m.clearStation=function(){"[]"===r.search().stationNames&&N()},m.clearTime=function(){m.timePeriod1CheckAll=function(){return!1},m.timePeriod1Check=function(){return!1},m.timePeriod2Check=function(){return!1},m.timePeriod3Check=function(){return!1},m.timePeriod4Check=function(){return!1},m.timePeriodAll=!1,m.searchFilters.timePeriod1=!1,m.searchFilters.timePeriod2=!1,m.searchFilters.timePeriod3=!1,m.searchFilters.timePeriod4=!1,m.update()},m.checkTimeAll=function(){"yes"===m.timePeriodAll?(m.searchFilters.timePeriod1=!0,m.searchFilters.timePeriod2=!0,m.searchFilters.timePeriod3=!0,m.searchFilters.timePeriod4=!0,m.timePeriod1CheckAll=function(){return!0},m.timePeriod1Check=function(){return!1},m.timePeriod2Check=function(){return!1},m.timePeriod3Check=function(){return!1},m.timePeriod4Check=function(){return!1}):"no"===m.timePeriodAll&&(m.searchFilters.timePeriod1="",m.searchFilters.timePeriod2="",m.searchFilters.timePeriod3="",m.searchFilters.timePeriod4="")},m.checkTime=function(){m.timePeriodAll=!1,!1===m.timePeriodAll&&(m.timePeriod1CheckAll=function(){return!1})},m.getSwiftPAYG=B,m.updateGrid=S,m.update=function(){let e=m.all,t=m.exactMatch,o=m.otherResults;angular.forEach(m.searchFilters,(function(e,t){(-1!==t.indexOf("allow")&&e||!1===e&&-1===t.indexOf("allow"))&&delete m.searchFilters[t],m.searchFilters.timePeriod1&&(m.searchFilters.timePeriod2=!1,m.searchFilters.timePeriod3=!1,m.searchFilters.timePeriod4=!1),m.searchFilters.timePeriod2&&(m.searchFilters.timePeriod1=!1,m.searchFilters.timePeriod3=!1,m.searchFilters.timePeriod4=!1),m.searchFilters.timePeriod3&&(m.searchFilters.timePeriod1=!1,m.searchFilters.timePeriod2=!1,m.searchFilters.timePeriod4=!1),m.searchFilters.timePeriod4&&(m.searchFilters.timePeriod1=!1,m.searchFilters.timePeriod2=!1,m.searchFilters.timePeriod3=!1),"yes"===m.timePeriodAll&&(m.searchFilters.timePeriod1=!0,m.searchFilters.timePeriod2=!0,m.searchFilters.timePeriod3=!0,m.searchFilters.timePeriod4=!0)})),e=i("filter")(e,m.searchFilters),t=i("filter")(t,m.searchFilters),o=i("filter")(o,m.searchFilters),m.filteredTickets=i("orderBy")(e,m.orderBy),m.origTickets=i("orderBy")(t,m.orderBy),m.otherTickets=i("orderBy")(o,m.orderBy),"orderSequence"===m.orderBy?m.origTickets.sort((function(e,t){return m.sortPop="yes",m.sortPlw="no",m.sortPhl="no",t.buyOnDirectDebit-e.buyOnDirectDebit})):"ticketCurrentAmount"===m.orderBy?m.origTickets.sort((function(e,t){return m.sortPop="no",m.sortPlw="yes",m.sortPhl="no",e.ticketCurrentAmount-t.ticketCurrentAmount})):"-ticketCurrentAmount"===m.orderBy&&m.origTickets.sort((function(e,t){return m.sortPop="no",m.sortPlw="no",m.sortPhl="yes",t.ticketCurrentAmount-e.ticketCurrentAmount}));m.updateGrid()},m.loadMore=function(){m.limit+=6,r.search("limit",m.limit),m.updateGrid(),m.refreshOther()},m.loadMoreExact=function(){m.limitExact+=6,r.search("limitExact",m.limitExact),m.updateGrid(),m.refreshExact()},m.refreshExact=b,m.refreshOther=w,m.filterButtons={operator:[],operatorLength:0,busTravelArea:[],railZoneFrom:[],railZoneTo:[]},m.toggleFilter=function(e){m.filterButtons[e]=!m.filterButtons[e]},m.swiftPAYG=F,m.swiftABT=y,m.ntrainOOC=function(){m.passValue=m.postJSON.brand,"ntrain - Out of County"===m.passValue?(m.isHideCheck=!m.isHideCheck,m.stationFromReqOOC=!0,m.stationToReqOOC=!0,m.stationFromName=null,m.stationToName=null,m.stationViaOneName=null):(m.stationFromReqOOC=!1,m.stationToReqOOC=!1,r.search().stationNames&&(d=r.search().stationNames,f=d.toString(),h=f.split(","),m.stationFromName=h[0],m.stationToName=h[1],m.stationViaOneName=h[2]))},m.toggleModalFilter=function(){m.modalShownFilter=!m.modalShownFilter},m.searchLocation=r.host(),m.deviceDetect=function(){m.deviceDetector=u,m.userAgent=u.raw.userAgent,m.userAgent.includes("SwiftOneApp")?m.oneApp=!0:m.oneApp=!1;m.userAgent.includes("android")?m.android=!0:m.android=!1},m.selectPass=function(){m.passValue=m.postJSON.brand,""===m.passValue&&(console.log("select pass"),m.clearFilter())},p(),r.search().allowBus||r.search().allowMetro||r.search().allowTrain||r.search().brand&&r.search().passengerType&&r.search().timeBand||r.search().busTravelArea||r.search().operator||r.search().stationNames||r.search().brand?(m.clearStation(),r.search().stationNames&&!0===m.postJSON.allowTrain||"nnetwork"===m.postJSON.brand||"ntrain"===m.postJSON.brand?r.search().stationNames&&(d=r.search().stationNames,f=d.toString(),h=f.split(","),m.stationFromName=h[0],m.stationToName=h[1],m.stationViaOneName=h[2]):(m.stationFromName=null,m.stationToName=null),m.getStations(),O(m.postJSON)):r.url("").replace(),m.showDetails=!1,"Swift PAYG"===r.search().brand&&(B(),F()),"Swift Go"===r.search().brand&&y(),m.deviceDetect(),S.$inject=["$timeout","angularGridInstance"],m.fromEmpty="none",m.fromStationInputChanged=function(e){m.fromStationText=e},m.fromfocusState="None",m.fromFocusIn=function(){m.fromfocusState="In"},m.fromFocusOut=function(){m.fromfocusState="Out",null!=m.stationToName&&(m.stationFromReq=!0),null!=m.fromStationText&&null==m.stationFromName&&(m.stationFromReq=!0)},m.stationFromReq=!1,m.stationFromReqOOC=!0,m.stationFrom=function(e){e?(m.postJSON.stationNames=[],m.stationFromName=e.originalObject.name,m.postJSON.stationNames[0]=e.originalObject.name,m.stationFromNameZone=e.originalObject.zone,m.stationFromNameOoc=e.originalObject.outOfCounty,m.stationFromNameOocZ5=e.originalObject.zone5InCounty,m.fromZoneNumber=e.originalObject.zone,m.fromStationInfoZone=e.originalObject.zone,m.stationFromReq=!1,m.fromEmpty=!0):(m.stationFromName=null,m.stationFromReq=!1,m.fromEmpty=!1)},m.toEmpty="none",m.toStationInputChanged=function(e){m.toStationText=e},m.tofocusState="None",m.toFocusIn=function(){m.tofocusState="In",null!=m.stationFromName&&(m.stationToReq=!0)},m.toFocusOut=function(){m.tofocusState="Out",null!=m.stationFromName&&(m.stationToReq=!0),null!=m.toStationText&&null==m.stationToName&&(m.stationToReq=!0)},m.stationToReq=!1,m.stationToReqOOC=!0,m.stationTo=function(e){e?(m.stationToName=e.originalObject.name,m.postJSON.stationNames[1]=e.originalObject.name,m.stationToTitle=e.originalObject.name,m.stationToNameZone=e.originalObject.zone,m.stationToNameOoc=e.originalObject.outOfCounty,m.stationToNameOocZ5=e.originalObject.zone5InCounty,m.toZoneNumber=e.originalObject.zone,m.toStationInfoZone=e.originalObject.zone,m.stationToReq=!1,m.toEmpty=!0):(m.stationToName=null,m.stationToTitle=null,m.toEmpty=!1)},m.viaOneStationInputChanged=function(e){m.viaOneStationText=e},m.viaOnefocusState="None",m.stationViaOneFocusIn=function(){m.viaOnefocusState="In"},m.stationViaOneFocusOut=function(){m.viaOnefocusState="Out",null!=m.stationViaOneName&&(m.stationviaOneReq=!0),null==m.viaOneStationText&&null!=m.stationViaOneName||(m.stationViaOneReq=!0,m.stationToReq=!0,m.stationFromReq=!0)},m.stationViaOne=function(e){e&&(m.stationViaOneName=e.originalObject.name,m.postJSON.stationNames[2]=e.originalObject.name,m.stationViaOneTitle=e.originalObject.name,m.stationViaOneNameZone=e.originalObject.zone,m.stationViaOneNameOoc=e.originalObject.outOfCounty,m.stationViaOneNameOocZ5=e.originalObject.zone5InCounty,m.ViaOneZoneNumber=e.originalObject.zone,m.ViaOneStationInfoZone=e.originalObject.zone)},null!=m.stationViaOneName&&(m.stationVia=!0),m.excludebusParameter&&(m.filterButtons.mode=!m.filterButtons.mode,m.searchFilters.allowBus=!1,m.excludeBusCheck=function(){return!0}),m.buyOnDirectDebitParameter&&(m.filterButtons.payment=!m.filterButtons.payment,m.searchFilters.buyOnDirectDebit=!0,m.buyOnDirectDebitCheck=function(){return!0}),m.buyOnDirectPurchaseParameter&&(m.filterButtons.payment=!m.filterButtons.payment,m.searchFilters.buyOnDirectPurchase=!0,m.buyOnDirectPurchaseCheck=function(){return!0}),m.buyOnSwiftParameter&&(m.filterButtons.payment=!m.filterButtons.payment,m.searchFilters.buyOnSwift=!0,m.buyOnSwiftCheck=function(){return!0}),m.hasOnlinePurchaseChannelParameter&&(m.filterButtons.payment=!m.filterButtons.payment,m.searchFilters.hasOnlinePurchaseChannel=!0,m.hasOnlinePurchaseChannelCheck=function(){return!0}),m.purchaseTicParameter&&(m.filterButtons.payment=!m.filterButtons.payment,m.searchFilters.purchaseTic=!0,m.purchaseTicCheck=function(){return!0}),m.purchaseRailStationParameter&&(m.filterButtons.payment=!m.filterButtons.payment,m.searchFilters.purchaseRailStation=!0,m.purchaseRailStationCheck=function(){return!0}),m.purchasePayzoneParameter&&(m.filterButtons.payment=!m.filterButtons.payment,m.searchFilters.purchasePayzone=!0,m.purchasePayzoneCheck=function(){return!0}),m.busTravelAreaParameter&&(m.filterButtons.busTravelAreaBtn=!m.filterButtons.busTravelAreaBtn,m.searchFilters.busTravelArea=m.busTravelAreaParameter),m.operatorParameter&&(m.filterButtons.operatorBtn=!m.filterButtons.operatorBtn,m.searchFilters.operator=m.operatorParameter),m.railZoneFromParameter&&(m.filterButtons.railZoneBtn=!m.filterButtons.railZoneBtn,m.searchFilters.railZoneFrom=m.railZoneFromParameter),m.railZoneToParameter&&(m.filterButtons.railZoneBtn=!m.filterButtons.railZoneBtn,m.searchFilters.railZoneTo=m.railZoneToParameter),"true"===r.search().timePeriodAll&&(m.searchFilters.timeLimited=!1,m.searchFilters.timePeriod1="",m.filterButtons.time=!m.filterButtons.time,m.timePeriodAll=!0,m.timePeriod1CheckAll=function(){return!0}),"true"===r.search().timePeriod1&&(m.filterButtons.time=!m.filterButtons.time,m.searchFilters.timePeriod1=!0,m.timePeriod1Check=function(){return!0}),"true"===r.search().timePeriod2&&(m.filterButtons.time=!m.filterButtons.time,m.searchFilters.timePeriod2=!0,m.timePeriod2Check=function(){return!0}),"true"===r.search().timePeriod3&&(m.filterButtons.time=!m.filterButtons.time,m.searchFilters.timePeriod3=!0,m.timePeriod3Check=function(){return!0}),"true"===r.search().timePeriod4&&(m.filterButtons.time=!m.filterButtons.time,m.searchFilters.timePeriod4=!0,m.timePeriod4Check=function(){return!0}),m.hideModalFilter=function(){m.modalShownFilter=!m.modalShownFilter},m.modalShownFilter=!1,b.$inject=["$timeout","angularGridInstance"],w.$inject=["$timeout","angularGridInstance"],m.date=new Date}function t(){let e;return function(t,o,n){if(void 0!==t)return e=new RegExp(o,"g"),t.replace(e,n)}}angular.module("ticketingApp").controller("TicketingSearchCtrl",e).filter("replace",t),e.$inject=["ngAuthSettings","$scope","$anchorScroll","$timeout","$filter","$location","savedFilter","ticketingService","angularGridInstance","$httpParamSerializer","deviceDetector"],t.$inject=[]}();
//# sourceMappingURL=../../_sourcemaps/controller.min.js.map
