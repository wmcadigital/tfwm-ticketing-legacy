{"version":3,"sources":["services.js"],"names":["ticketingService","$http","uri","ticketSearch","data","getData","post","cache","getTicket","get","getTicketFull","getTerms","getStations","getOperators","getBrands","getSwiftSearch","jsonData","then","getDataComplete","getDataFail","response","console","warn","status","statusText","JSON","stringify","config","savedFilter","set","savedData","sessionStorage","setItem","parse","getItem","updatePageView","$location","update","dataLayer","push","event","attributes","route","absUrl","split","angular","module","factory","$inject"],"mappings":"CAAA,WACA,aASA,SAAAA,EAAAC,GACA,MAAAC,EAAA,cAEA,MAAA,CACAC,aAAA,SAAAC,GACA,OAAAC,EAAAJ,EAAAK,KAAAJ,EAAA,iBAAAE,EAAA,CAAAG,OAAA,IACA,EACAC,UAAA,SAAAJ,GACA,OAAAC,EAAAJ,EAAAQ,IAAAP,EAAA,WAAAE,EAAA,CAAAG,OAAA,IACA,EACAG,cAAA,SAAAN,GACA,OAAAC,EAAAJ,EAAAQ,IAAAP,EAAA,WAAAE,EAAA,YAAA,CAAAG,OAAA,IACA,EACAI,SAAA,SAAAP,GACA,OAAAC,EAAAJ,EAAAQ,IAAAP,EAAA,SAAAE,EAAA,CAAAG,OAAA,IACA,EACAK,YAAA,WACA,OAAAP,EAAAJ,EAAAQ,IAAAP,EAAA,gBAAA,CAAAK,OAAA,IACA,EACAM,aAAA,WACA,OAAAR,EAAAJ,EAAAQ,IAAAP,EAAA,YAAA,CAAAK,OAAA,IACA,EACAO,UAAA,WACA,OAAAT,EAAAJ,EAAAQ,IAAAP,EAAA,SAAA,CAAAK,OAAA,IACA,EACAQ,eAAA,WACA,OAAAV,EAAAJ,EAAAK,KAAAJ,EAAA,iBAAA,CAAAK,OAAA,IACA,GAGA,SAAAF,EAAAW,GACA,OAAAA,EAAAC,KAAAC,EAAAC,EACA,CAEA,SAAAD,EAAAE,GACA,OAAAA,EAAAhB,IACA,CAEA,SAAAe,EAAAC,GAGAC,QAAAC,KACA,WACAF,EAAAG,OACA,gBACAH,EAAAI,WACA,aACAC,KAAAC,UAAAN,EAAAhB,MACA,eACAqB,KAAAC,UAAAN,EAAAO,QAEA,CACA,CAGA,SAAAC,IAOA,MAAA,CACAC,IAPA,SAAAC,EAAA1B,GACA2B,eAAAC,QAAAF,EAAAL,KAAAC,UAAAtB,GACA,EAMAK,IALA,SAAAqB,GACA,OAAAL,KAAAQ,MAAAF,eAAAG,QAAAJ,GACA,EAKA,CAGA,SAAAK,EAAAC,GAUA,MAAA,CACAC,OATA,WACAC,UAAAC,KAAA,CACAC,MAAA,gBACAC,WAAA,CACAC,MAAAN,EAAAO,SAAAC,MAAA,wBAAA,KAGA,EAIA,CAzFAC,QACAC,OAAA,gBACAC,QAAA,mBAAA,CAAA,QAAA/C,IACA+C,QAAA,cAAA,CAAAnB,IACAmB,QAAA,iBAAA,CAAA,YAAAZ,IAEAnC,EAAAgD,QAAA,CAAA,SAuDApB,EAAAoB,QAAA,GAcAb,EAAAa,QAAA,CAAA,YAeA,CA7FA","file":"services-sc-test.min.js","sourcesContent":["(function() {\n  'use strict';\n\n  angular\n    .module('ticketingApp')\n    .factory('ticketingService', ['$http', ticketingService])\n    .factory('savedFilter', [savedFilter])\n    .factory('updatePageView', ['$location', updatePageView]);\n\n  ticketingService.$inject = ['$http'];\n  function ticketingService($http) {\n    const uri = 'https://ticketingv2-smartcitizen-test-c7bxbje6hrhgb2cp.uksouth-01.azurewebsites.net/';\n    // console.log('uri', uri);\n    return {\n      ticketSearch: function(data) {\n        return getData($http.post(uri + 'tickets/search', data, { cache: true }));\n      },\n      getTicket: function(data) {\n        return getData($http.get(uri + 'tickets/' + data, { cache: true }));\n      },\n      getTicketFull: function(data) {\n        return getData($http.get(uri + 'tickets/' + data + '/complete', { cache: true }));\n      },\n      getTerms: function(data) {\n        return getData($http.get(uri + 'terms/' + data, { cache: true }));\n      },\n      getStations: function() {\n        return getData($http.get(uri + 'station/train', { cache: true }));\n      },\n      getOperators: function() {\n        return getData($http.get(uri + 'operators', { cache: true }));\n      },\n      getBrands: function() {\n        return getData($http.get(uri + 'brands', { cache: true }));\n      },\n      getSwiftSearch: function() {\n        return getData($http.post(uri + 'tickets/search', { cache: true }));\n      }\n    };\n\n    function getData(jsonData) {\n      return jsonData.then(getDataComplete, getDataFail);\n    }\n\n    function getDataComplete(response) {\n      return response.data;\n    }\n\n    function getDataFail(response) {\n      // Log error\n      // console.log(response);\n      console.warn(\n        'Status: ' +\n          response.status +\n          '\\n\\nHeaders: ' +\n          response.statusText +\n          '\\n\\nData: ' +\n          JSON.stringify(response.data) +\n          '\\n\\nConfig: ' +\n          JSON.stringify(response.config)\n      );\n    }\n  }\n\n  savedFilter.$inject = [];\n  function savedFilter() {\n    function set(savedData, data) {\n      sessionStorage.setItem(savedData, JSON.stringify(data));\n    }\n    function get(savedData) {\n      return JSON.parse(sessionStorage.getItem(savedData));\n    }\n    return {\n      set: set,\n      get: get\n    };\n  }\n\n  updatePageView.$inject = ['$location'];\n  function updatePageView($location) {\n    // set function for updating GA pageview count...this is here for reusablility across controllers\n    function update() {\n      dataLayer.push({\n        event: 'ngRouteChange',\n        attributes: {\n          route: $location.absUrl().split('https://tfwm.org.uk/')[1]\n        }\n      });\n    }\n    return {\n      update: update\n    };\n  }\n})();\n"]}