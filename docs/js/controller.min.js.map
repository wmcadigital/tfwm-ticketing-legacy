{"version":3,"sources":["ticket.controller.js","tickets.controller.js"],"names":["TicketDetailCtrl","ticketingService","$interval","getURL","$routeParams","$scope","$timeout","deviceDetector","$location","$window","vm","this","data","widthView","innerWidth","includeMobileTemplate","includeDesktopTemplate","loadingText","loadingStatus","loadingArray","loading","Math","round","random","length","ticketID","ticket","filterAccordions","relatedTickets","priceLevelsList","toggleClick","type","modalShown","toggleModal","toggleModalBus","modalShownBus","toggleModalTrain","modalShownTrain","toggleModalSwift","modalShownSwift","toggleModalGPay","modalShownGpay","operatorList","limit","deviceDetect","userAgent","raw","includes","oneApp","android","openFilters","document","getElementById","style","display","closeFilters","date","Date","gpay","searchLocation","host","location","href","getTicket","then","response","all","related","angular","forEach","item","id","relatedList","push","catch","error","errorMessage","console","documents","getTerms","terms","relatedTerms","getOperators","operator","window","setTicketFinder","name","buyTicketUrl","queryString","split","baseUrl","matrixid","replace","backToSearch","stationFromNameZone","getTicketFull","full","priceLevels","map","initialiseFull","element","bind","removeHTMLTags","text","String","escapeFilter","module","controller","filter","directive","restrict","scope","show","transclude","link","attrs","dialogStyle","width","height","modalclass","class","hideModal","template","panes","select","pane","selected","addPane","panel","require","title","tabsCtrl","isShown","showHover","ctrl","copy","tooltipc","$apply","$inject","$exceptionHandler","$log","exception","log","Sentry","captureException","TicketingSearchCtrl","ngAuthSettings","$anchorScroll","$filter","savedFilter","angularGridInstance","$httpParamSerializer","stations","stationSel","stationSplit","apiTimeoutPromise","retryIntervalPromise","defaultVars","filteredTickets","origTickets","otherTickets","stationList","stationoocList","stationicList","swiftPaygIds","swiftPaygloadingStatus","passValue","orderBy","parseInt","search","limitExact","postJSON","allowBus","allowMetro","allowTrain","passengerType","timeBand","brand","stationNames","stationFromName","stationToName","stationFromTitle","stationToTitle","stationFromNameOocZ5","stationToNameOocZ5","fromStationInfo","eligibilityDate","excludebusParameter","excludeBus","buyOnDirectDebitParameter","buyOnDirectDebit","buyOnDirectPurchaseParameter","buyOnDirectPurchase","buyOnSwiftParameter","buyOnSwift","hasOnlinePurchaseChannelParameter","hasOnlinePurchaseChannel","purchaseTicParameter","purchaseTic","purchaseRailStationParameter","purchaseRailStation","purchasePayzoneParameter","purchasePayzone","busTravelAreaParameter","busTravelArea","operatorParameter","railZoneFromParameter","railZoneFrom","railZoneToParameter","railZoneTo","timePeriodAnytimeParameter","timePeriodAll","timePeriod1Parameter","timePeriod1","timePeriod2Parameter","timePeriod2","timePeriod3Parameter","timePeriod3","timePeriod4Parameter","timePeriod4","clearModes","postedJSON","stationFromReq","stationToReq","stationToReqtwo","stationFromOOCReq","fromZoneNumber","toZoneNumber","subtractYears","dates","years","dateCopy","setFullYear","getFullYear","submit","clearFilter","url","excludeBusCheck","excludeTrainCheck","excludeTramCheck","buyOnDirectDebitCheck","buyOnDirectPurchaseCheck","buyOnSwiftCheck","hasOnlinePurchaseChannelCheck","purchaseTicCheck","purchaseRailStationCheck","purchasePayzoneCheck","timePeriod1CheckAll","timePeriod1Check","timePeriod2Check","timePeriod3Check","timePeriod4Check","set","clearFromStation","clearToStation","clearViaOneStation","getStations","fromRail","toRail","ViaOneRail","dataFromRail","dataToRail","dataViaOnRail","dataFromRailData","dataToRailData","dataViaOneRailData","stationViaOneName","toStationInfo","ViaOneStationInfo","zone","ViaOneZoneNumber","getoocStations","OutOfCounty","outOfCounty","geticStations","inCounty","clearStation","clearTime","searchFilters","update","checkTimeAll","checkTime","getSwiftPAYG","updateGrid","filtered","filteredorg","exactMatch","filteredother","otherResults","val","key","indexOf","sort","a","b","sortPop","sortPlw","sortPhl","ticketCurrentAmount","loadMore","refreshOther","loadMoreExact","refreshExact","filterButtons","operatorLength","toggleFilter","swiftPAYG","swiftABT","ntrainOOC","isHideCheck","stationFromReqOOC","stationToReqOOC","toString","toggleModalFilter","modalShownFilter","os","isMobile","selectPass","slug","currentDate","year","newDate","fbus","ftrain","fmetro","i","j","arrlen","bus","train","metro","searchAll","searchExact","captureMessage","level","extra","absUrl","origFilters","ticketSearch","cancel","original","items","swiftCurrentAmount","baseUrl2","paygUrl","fromStationInfoZone","toStationInfoZone","ffromzone","ftozone","fViaOnezone","slice","concat","hash","retryTicketSearch","searchURL","urlstring","abus","atrain","ametro","atime","obj","$broadcast","fromStationText","toStationText","viaOneStationText","ready","origTicketResults","refresh","ticketResults","getSwiftSearch","showDetails","fromEmpty","fromStationInputChanged","str","fromfocusState","fromFocusIn","fromFocusOut","stationFrom","originalObject","stationFromNameOoc","zone5InCounty","toEmpty","toStationInputChanged","tofocusState","toFocusIn","toFocusOut","stationTo","stationToNameZone","stationToNameOoc","viaOneStationInputChanged","viaOnefocusState","stationViaOneFocusIn","stationViaOneFocusOut","stationviaOneReq","stationViaOneReq","stationViaOne","stationViaOneTitle","stationViaOneNameZone","stationViaOneNameOoc","stationViaOneNameOocZ5","ViaOneStationInfoZone","stationVia","mode","payment","busTravelAreaBtn","operatorBtn","railZoneBtn","timeLimited","time","hideModalFilter","regex","input","from","to","undefined","RegExp","factory"],"mappings":"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","file":"controller.min.js","sourcesContent":["/* eslint-disable angular/window-service */\n(function() {\n  'use strict';\n\n  angular\n    .module('ticketingApp')\n    .controller('TicketDetailCtrl', TicketDetailCtrl)\n    .filter('removeHTMLTags', removeHTMLTags)\n    .filter('escapeFilter', escapeFilter)\n    .directive('modalDialog', modalDialog)\n    .directive('tabs', tabs)\n    .directive('pane', pane)\n    .directive('tooltip', tooltip);\n\n  TicketDetailCtrl.$inject = [\n    'ticketingService',\n    '$interval',\n    'getURL',\n    '$routeParams',\n    '$scope',\n    '$timeout',\n    'deviceDetector',\n    '$location',\n    '$window'\n  ];\n\n  function TicketDetailCtrl(\n    ticketingService,\n    $interval,\n    getURL,\n    $routeParams,\n    $scope,\n    $timeout,\n    deviceDetector,\n    $location,\n    $window\n  ) {\n    const vm = this;\n    vm.loadingText = 'Loading...'; // default loading text\n    vm.loadingStatus = 'loading'; // default loading status\n    vm.loadingArray = 'Loading...'; // loading messages\n    vm.loading = $interval(function() {\n      vm.loadingText = vm.loadingArray[Math.round(Math.random() * (vm.loadingArray.length - 1))];\n    }, 3500); // show random loading message based on milliseconds set\n    vm.ticketID = $routeParams.ticket; // set Ticket ID to URL parameter\n    vm.filterAccordions = {};\n    vm.relatedTickets = {};\n    vm.priceLevelsList = {};\n    vm.toggleClick = toggleClick;\n    vm.modalShown = false;\n    vm.toggleModal = toggleModal;\n    vm.toggleModalBus = toggleModalBus;\n    vm.toggleModalTrain = toggleModalTrain;\n    vm.toggleModalSwift = toggleModalSwift;\n    vm.toggleModalGPay = toggleModalGPay;\n    vm.widthView = widthView; // Check width of page\n    vm.operatorList = []; // Define Operator list\n    vm.limit = 4; // Set paging limit for Alt tickets\n    vm.deviceDetect = deviceDetect; // Function to detect device\n    vm.openFilters = openFilters;\n    vm.closeFilters = closeFilters;\n    vm.date = new Date();\n    vm.gpay = false; // Default value for GPay products\n    vm.searchLocation = $location.host(); // Set the current host\n\n    // Redirects\n\n    if (\n      vm.ticketID === '630001' ||\n      vm.ticketID === '443' ||\n      vm.ticketID === '382' ||\n      vm.ticketID === '385' ||\n      vm.ticketID === '383' ||\n      vm.ticketID === '383002' ||\n      vm.ticketID === '382001'\n    ) {\n      $window.location.href = 'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/ticket/63';\n    }\n\n    if (\n      vm.ticketID === '650001' ||\n      vm.ticketID === '379001' ||\n      vm.ticketID === '442010' ||\n      vm.ticketID === '442009' ||\n      vm.ticketID === '442005' ||\n      vm.ticketID === '442006' ||\n      vm.ticketID === '442001' ||\n      vm.ticketID === '442002'\n    ) {\n      $window.location.href = 'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/ticket/65';\n    }\n\n    if (\n      vm.ticketID === '640001' ||\n      vm.ticketID === '651' ||\n      vm.ticketID === '664' ||\n      vm.ticketID === '665' ||\n      vm.ticketID === '439' ||\n      vm.ticketID === '389' ||\n      vm.ticketID === '393' ||\n      vm.ticketID === '422' ||\n      vm.ticketID === '427' ||\n      vm.ticketID === '428' ||\n      vm.ticketID === '418' ||\n      vm.ticketID === '419'\n    ) {\n      $window.location.href = 'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/ticket/45';\n    }\n\n    if (vm.ticketID === '640002') {\n      $window.location.href = 'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/ticket/48';\n    }\n\n    if (\n      vm.ticketID === '656' ||\n      vm.ticketID === '667' ||\n      vm.ticketID === '668' ||\n      vm.ticketID === '397' ||\n      vm.ticketID === '424' ||\n      vm.ticketID === '429' ||\n      vm.ticketID === '433' ||\n      vm.ticketID === '432'\n    ) {\n      $window.location.href = 'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/ticket/50';\n    }\n\n    if (vm.ticketID === '611' || vm.ticketID === '658' || vm.ticketID === '441') {\n      $window.location.href = 'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/ticket/57';\n    }\n\n    if (vm.ticketID === '640003') {\n      $window.location.href = 'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/ticket/652';\n    }\n\n    if (\n      vm.ticketID === '660021' ||\n      vm.ticketID === '660022' ||\n      vm.ticketID === '660030' ||\n      vm.ticketID === '660026' ||\n      vm.ticketID === '660016' ||\n      vm.ticketID === '553010' ||\n      vm.ticketID === '553011' ||\n      vm.ticketID === '553012'\n    ) {\n      $window.location.href = 'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/ticket/660029';\n    }\n\n    if (\n      vm.ticketID === '874' ||\n      vm.ticketID === '873' ||\n      vm.ticketID === '384' ||\n      vm.ticketID === '386' ||\n      vm.ticketID === '878' ||\n      vm.ticketID === '877' ||\n      vm.ticketID === '445'\n    ) {\n      $window.location.href = 'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/ticket/64';\n    }\n\n    if (\n      vm.ticketID === '676' ||\n      vm.ticketID === '677' ||\n      vm.ticketID === '442015' ||\n      vm.ticketID === '865' ||\n      vm.ticketID === '866'\n    ) {\n      $window.location.href = 'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/ticket/46';\n    }\n\n    if (vm.ticketID === '444' || vm.ticketID === '604') {\n      $window.location.href = 'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/ticket/630005';\n    }\n\n    if (vm.ticketID === '442014' || vm.ticketID === '442011') {\n      $window.location.href = 'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/ticket/58';\n    }\n\n    if (vm.ticketID === '602') {\n      $window.location.href =\n        'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/?allowBus&passengerType=Student&timeBand=Longer%20than%20a%20month&limit=6&limitExact=6#sbmBtn';\n    }\n\n    if (vm.ticketID === '714' || vm.ticketID === '718') {\n      $window.location.href = 'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/ticket/630002';\n    }\n\n    if (vm.ticketID === '715' || vm.ticketID === '719') {\n      $window.location.href = 'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/ticket/630003';\n    }\n\n    if (vm.ticketID === '394' || vm.ticketID === '395' || vm.ticketID === '396') {\n      $window.location.href = 'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/ticket/391';\n    }\n\n    if (vm.ticketID === '413' || vm.ticketID === '426' || vm.ticketID === '431') {\n      $window.location.href = 'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/ticket/59';\n    }\n\n    if (vm.ticketID === '399') {\n      $window.location.href = 'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/ticket/555';\n    }\n\n    if (vm.ticketID === '415') {\n      $window.location.href = 'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/ticket/557';\n    }\n\n    if (\n      vm.ticketID === '442010' ||\n      vm.ticketID === '442009' ||\n      vm.ticketID === '442005' ||\n      vm.ticketID === '442006' ||\n      vm.ticketID === '442001' ||\n      vm.ticketID === '442002'\n    ) {\n      $window.location.href = 'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/';\n    }\n\n    // Function to get the ticket data with api call\n    function initialise(data) {\n      ticketingService\n        .getTicket(data)\n        .then(function(response) {\n          vm.all = response;\n          if (vm.all.relatedTickets.length) {\n            vm.related = [];\n            angular.forEach(\n              vm.all.relatedTickets,\n              function(item) {\n                ticketingService\n                  .getTicket(item.id)\n                  .then(function(related) {\n                    vm.relatedTickets[item.id] = related;\n                    vm.relatedList = vm.relatedTickets[item.id];\n                    // push items into a single array\n                    vm.related.push(vm.relatedList);\n                  })\n                  .catch(function(error) {\n                    vm.errorMessage =\n                      'There was a problem loading ticket data. Please try again later.';\n                    vm.loadingStatus = 'error';\n                    console.error(error);\n                  });\n              },\n              vm.related\n            );\n          }\n          if (vm.all.documents.length) {\n            ticketingService\n              .getTerms(data)\n              .then(function(terms) {\n                vm.relatedTerms = terms;\n              })\n              .catch(function(error) {\n                vm.errorMessage =\n                  'There was a problem loading terms and conditions data. Please try again later.';\n                vm.loadingStatus = 'error';\n                console.error(error);\n              });\n          }\n          ticketingService\n            .getOperators()\n            .then(function(operator) {\n              vm.operatorList = operator;\n              // console.log(response);\n            })\n            .catch(function(error) {\n              vm.errorMessage =\n                'There was a problem loading operator data. Please try again later.';\n              vm.loadingStatus = 'error';\n              console.error(error);\n            });\n\n          if (window?.setTicketFinder?.name.includes('Unicard Desktop Production')) {\n            // console.log('Unicard app detected (Production)');\n            if (!vm.all.buyTicketUrl.includes('ticketing.networkwestmidlands.com')) {\n              // eslint-disable-next-line no-unused-vars\n              const [host, queryString] = vm.all.buyTicketUrl.split('?');\n              vm.all.buyTicketUrl =\n                'https://my.swiftcard.org.uk/ssp/swift/dnr_importBasket.jsp?' + queryString;\n            }\n          }\n\n          if (window?.setTicketFinder?.name.includes('Unicard Desktop Test')) {\n            // console.log('Unicard app detected (Test)');\n            if (!vm.all.buyTicketUrl.includes('ticketing.cenapps.org.uk')) {\n              // eslint-disable-next-line no-unused-vars\n              const [host, queryString] = vm.all.buyTicketUrl.split('?');\n              vm.all.buyTicketUrl =\n                'https://natex-ssp.unicard-uk.com/ssp/swift/dnr_importBasket.jsp?' + queryString;\n            }\n          }\n\n          // console.log('Buy ticket URL: ' + vm.all.buyTicketUrl);\n\n          // Check if the buy ticket url is a smartcitizen ticket finder and format it differently\n          if (\n            vm.all.buyTicketUrl &&\n            vm.all.buyTicketUrl.includes('matrixId') &&\n            window?.setTicketFinder?.name.includes('Smart Citizen')\n          ) {\n            let baseUrl = '';\n            if (window?.setTicketFinder?.name.includes('Smart Citizen Mobile Production')) {\n              baseUrl = 'https://m-public-tfwmlive.smartcitizen.net';\n            } else if (window?.setTicketFinder?.name.includes('Smart Citizen Desktop Production')) {\n              baseUrl = 'https://public-tfwmlive.smartcitizen.net';\n            } else if (window?.setTicketFinder?.name.includes('Smart Citizen Mobile Test')) {\n              baseUrl = 'https://m-public-tfwmtest.smartcitizen.net';\n            } else if (window?.setTicketFinder?.name.includes('Smart Citizen Production')) {\n              baseUrl = 'https://public-tfwmlive.smartcitizen.net';\n            } else if (window?.setTicketFinder?.name.includes('Smart Citizen Test')) {\n              baseUrl = 'https://public-tfwmtest.smartcitizen.net';\n            } else if (window?.setTicketFinder?.name.includes('Smart Citizen Desktop Test')) {\n              baseUrl = 'https://public-tfwmtest.smartcitizen.net';\n            } else if (window?.setTicketFinder?.name.includes('Smart Citizen Dev')) {\n              baseUrl = 'https://public-tfwmdev.smartcitizen.net';\n            }\n            // console.log('baseurl: ' + baseUrl);\n            // eslint-disable-next-line no-unused-vars\n            const [host, queryString] = vm.all.buyTicketUrl.split('?');\n            const matrixid = queryString\n              .replace('https://', '')\n              // eslint-disable-next-line no-useless-escape\n              .replace(/[\\[\\]]/g, '')\n              .replace(/[{}]/g, '')\n              .replace(/:/g, '=')\n              .replace(/'/g, '');\n            vm.all.buyTicketUrl = baseUrl + '?' + matrixid;\n          }\n          // console.log('Final: ' + vm.all.buyTicketUrl);\n\n          backButtonLogic(); // Determine back button logic\n          vm.loadingStatus = 'success'; // set success loading status\n        })\n        .catch(function(error) {\n          vm.errorMessage = 'There was a problem loading ticket data. Please try again later.';\n          vm.loadingStatus = 'error';\n          console.error(error);\n        });\n    }\n\n    // detect device in use\n    vm.deviceDetect();\n    function deviceDetect() {\n      vm.deviceDetector = deviceDetector;\n      vm.userAgent = deviceDetector.raw.userAgent;\n      // check if userAgent is Swift One app\n      if (vm.userAgent.includes('SwiftOneApp')) {\n        vm.oneApp = true;\n      } else {\n        vm.oneApp = false;\n      }\n      if (vm.userAgent.includes('android')) {\n        vm.android = true;\n      } else {\n        vm.android = false;\n      }\n    }\n\n    function openFilters() {\n      document.getElementById('filterOverlay').style.display = 'block';\n    }\n\n    function closeFilters() {\n      document.getElementById('filterOverlay').style.display = 'none';\n    }\n\n    function backButtonLogic() {\n      vm.backToSearch = getURL; // use session storage\n      // console.log(vm.backToSearch);\n      vm.stationFromNameZone = '1';\n    }\n\n    initialise(vm.ticketID); // initialise API to get ticket\n    initialiseFull(vm.ticketID); // initialise API to get ticket\n\n    function toggleClick(type) {\n      vm.filterAccordions[type] = !vm.filterAccordions[type];\n    }\n\n    function initialiseFull(data) {\n      ticketingService\n        .getTicketFull(data)\n        .then(function(response) {\n          vm.full = response;\n          vm.priceLevels = response.priceLevels;\n          vm.gpay = false;\n          vm.priceLevelsList = vm.priceLevels.map(function(item) {\n            if (item.type.includes('Google Pay')) {\n              vm.gpay = true;\n              return true;\n            }\n            return false;\n          });\n        })\n        .catch(function(error) {\n          vm.errorMessage = 'There was a problem loading ticket data. Please try again later.';\n          vm.loadingStatus = 'error';\n          console.error(error);\n        });\n    }\n\n    // popup modals\n\n    // bus\n    vm.modalShownBus = false;\n    function toggleModalBus() {\n      vm.modalShownBus = !vm.modalShownBus;\n    }\n\n    // train\n    vm.modalShownTrain = false;\n    function toggleModalTrain() {\n      vm.modalShownTrain = !vm.modalShownTrain;\n    }\n\n    // general\n    vm.modalShown = false; // hide modal on page load\n    function toggleModal() {\n      vm.modalShown = !vm.modalShown;\n    }\n\n    // swift\n    vm.modalShownSwift = false;\n    function toggleModalSwift() {\n      vm.modalShownSwift = !vm.modalShownSwift;\n    }\n\n    // google pay\n    vm.modalShownGpay = false;\n    function toggleModalGPay() {\n      vm.modalShownGpay = !vm.modalShownGpay;\n    }\n\n    // check resolution so the where can i use view is not shown twice\n    vm.includeDesktopTemplate = false;\n    vm.includeMobileTemplate = false;\n    widthView();\n    function widthView() {\n      const screenWidth = $window.innerWidth;\n\n      if (screenWidth < 890) {\n        vm.includeMobileTemplate = true;\n        vm.includeDesktopTemplate = false;\n      } else {\n        vm.includeMobileTemplate = false;\n        vm.includeDesktopTemplate = true;\n      }\n    }\n\n    // ensure where can i use view is reloaded when page resolution goes below 890px\n    const appWindow = angular.element($window);\n    appWindow.bind('resize', function() {\n      widthView();\n    });\n  }\n\n  // FILTERS\n  removeHTMLTags.$inject = [];\n  function removeHTMLTags() {\n    return function(text) {\n      return text ? String(text).replace(/<[^>]+>/gm, '') : '';\n    };\n  }\n\n  // escape filter for ticket t&c's\n  escapeFilter.$inject = [];\n  function escapeFilter() {\n    return function(text) {\n      return text ? String(text).replace(/\\n/gm, '<br><br>') : '';\n    };\n  }\n\n  // DIRECTIVES\n\n  function modalDialog() {\n    return {\n      restrict: 'E',\n      scope: {\n        show: '='\n      },\n      replace: true, // Replace with the template below\n      transclude: true, // we want to insert custom content inside the directive\n      link: function(scope, element, attrs) {\n        scope.dialogStyle = {};\n        if (attrs.width) scope.dialogStyle.width = attrs.width;\n        if (attrs.height) scope.dialogStyle.height = attrs.height;\n        if (attrs.modalclass) scope.dialogStyle.class = attrs.modalclass;\n        scope.hideModal = function() {\n          scope.show = false;\n        };\n      },\n      template:\n        '<div ng-show=\"show\" class=\"mod\">' +\n        '<div ng-show=\"show\" class=\"modal\" ng-click=\"hideModal()\"></div>' +\n        '<div class=\"overlay modal-content {{dialogStyle.class}}\" ng-style=\"dialogStyle\">' +\n        '<div class=\"ng-modal-close modal__close js-modal-close\" ng-click=\"hideModal()\">X</div>' +\n        '<div class=\"ng-modal-dialog-content\" ng-transclude></div>' +\n        '</div>' +\n        '</div>'\n    };\n  }\n\n  function tabs() {\n    return {\n      restrict: 'E',\n      transclude: true,\n      scope: {},\n      controller: [\n        '$scope',\n        function($scope) {\n          // eslint-disable-next-line no-multi-assign\n          const panes = ($scope.panes = []);\n\n          // eslint-disable-next-line no-shadow\n          $scope.select = function(pane) {\n            // eslint-disable-next-line no-shadow\n            angular.forEach(panes, function(pane) {\n              pane.selected = false;\n            });\n            pane.selected = true;\n          };\n\n          this.addPane = function(panel) {\n            if (panes.length === 0) $scope.select(panel);\n            panes.push(panel);\n          };\n        }\n      ],\n      template:\n        '<div class=\"cfx\">' +\n        '<div class=\"arrdep-filters__toggle\">' +\n        '<div class=\"radio-bar\">' +\n        '<span ng-repeat=\"pane in panes\" ng-class=\"{active:pane.selected}\">' +\n        '<input name=\"option\" id=\"{{pane.title}}\" type=\"radio\">' +\n        '<label ng-click=\"select(pane)\" for=\"{{pane.title}}\" style=\"height: 44px;\">{{pane.title}}</label>' +\n        '</span>' +\n        '</div>' +\n        '</div>' +\n        '<div class=\"tab-content\" ng-transclude></div>' +\n        '</div>',\n      replace: true\n    };\n  }\n\n  function pane() {\n    return {\n      require: '^tabs',\n      restrict: 'E',\n      transclude: true,\n      scope: { title: '@' },\n      link: function(scope, element, attrs, tabsCtrl) {\n        tabsCtrl.addPane(scope);\n      },\n      template: '<div class=\"tab-pane\" ng-class=\"{active: selected}\" ng-transclude></div>',\n      replace: true\n    };\n  }\n\n  function tooltip() {\n    return {\n      restrict: 'A',\n      controller: [\n        '$scope',\n        function($scope) {\n          $scope.isShown = false;\n          this.showHover = function() {\n            $scope.isShown = $scope.isShown !== true;\n          };\n        }\n      ],\n      transclude: true,\n      link: function(scope, element, attrs, ctrl) {\n        scope.copy = attrs.tooltipc;\n        element.bind('click', function() {\n          scope.$apply(function() {\n            ctrl.showHover();\n          });\n        });\n      },\n      template:\n        '<div ng-transclude></div>' +\n        '<p class=\"field-help tooltip\" ng-show=\"isShown\">' +\n        '<span class=\"close modal__close\"></span>' +\n        '<span data-ng-bind-html=\"copy\"></span>' +\n        '</p>'\n    };\n  }\n})();\n","/* eslint-disable angular/window-service */\n/* eslint-disable no-useless-escape */\n(function() {\n  'use strict';\n\n  angular\n    .module('ticketingApp')\n    .factory('$exceptionHandler', $exceptionHandler)\n    .controller('TicketingSearchCtrl', TicketingSearchCtrl)\n    .filter('replace', replace);\n\n  $exceptionHandler.$inject = ['$log', '$window'];\n  function $exceptionHandler($log, $window) {\n    return function(exception) {\n      console.log('Exception caught by $exceptionHandler:');\n      $log.error(exception);\n      if ($window.Sentry && $window.Sentry.captureException) {\n        $window.Sentry.captureException(exception);\n      }\n    };\n  }\n\n  TicketingSearchCtrl.$inject = [\n    'ngAuthSettings',\n    '$scope',\n    '$interval',\n    '$anchorScroll',\n    '$timeout',\n    '$filter',\n    '$location',\n    'savedFilter',\n    'ticketingService',\n    'angularGridInstance',\n    '$httpParamSerializer',\n    'deviceDetector'\n  ];\n\n  function TicketingSearchCtrl(\n    ngAuthSettings,\n    $scope,\n    $interval,\n    $anchorScroll,\n    $timeout,\n    $filter,\n    $location,\n    savedFilter,\n    ticketingService,\n    angularGridInstance,\n    $httpParamSerializer,\n    deviceDetector\n  ) {\n    const vm = this;\n    let stations;\n    let stationSel;\n    let stationSplit;\n    let apiTimeoutPromise = null;\n    let retryIntervalPromise = null;\n    vm.submit = submit; // Function to submit initial search\n    vm.clearFilter = clearFilter; // Function to reset filters\n    vm.getStations = getStations; // Function to retrieve stations\n    vm.getoocStations = getoocStations; // Function to retrieve out of county stations\n    vm.geticStations = geticStations; // Function to retrieve in county stations\n    vm.clearFromStation = clearFromStation; // Function to clear from station\n    vm.clearToStation = clearToStation; // Function to clear to station\n    vm.clearViaOneStation = clearViaOneStation; // Function to clear via one station\n    vm.clearStation = clearStation; // Function to clear to from station if not in url - []\n    vm.clearTime = clearTime; // Function to clear time selection\n    vm.checkTimeAll = checkTimeAll; // Function to check time checkboxes\n    vm.checkTime = checkTime; // Function to check time checkboxes\n    vm.getSwiftPAYG = getSwiftPAYG; // Function to retrieve stations\n    vm.updateGrid = updateGrid; // Function to update results grid\n    vm.update = update; // Do filtering logic in controller so sessions can be stored\n    vm.loadMore = loadMore; // function to load more results\n    vm.loadMoreExact = loadMoreExact; // function to load more exact results\n    vm.refreshExact = refreshExact; // function to refresh the exact results grid\n    vm.refreshOther = refreshOther; // function to refresh the other results grid\n    vm.filterButtons = {\n      operator: [],\n      operatorLength: 0,\n      busTravelArea: [],\n      railZoneFrom: [],\n      railZoneTo: []\n    }; // set an object for the filters show/hide toggle to fall into\n    vm.toggleFilter = toggleFilter;\n    vm.swiftPAYG = swiftPAYG; // Function for hiding fields if Swift PAYG is selected\n    vm.swiftABT = swiftABT; // Function for hiding fields if Swift ABT is selected\n    vm.ntrainOOC = ntrainOOC; // Function for setting out of county tickets\n    vm.toggleModalFilter = toggleModalFilter;\n    vm.searchLocation = $location.host(); // Set the current host\n    vm.deviceDetect = deviceDetect; // Function to detect device\n    vm.selectPass = selectPass; // Function to reset filters if select your pass is selected\n    // Set up the default Vars on page load, and so that they can be reset with 'reset filters' button\n    function defaultVars() {\n      vm.all = []; // Set results to blank array\n      vm.filteredTickets = []; // Define filtered results as blank array\n      vm.origTickets = []; // Define original filtered results as blank array\n      vm.otherTickets = []; // Define other filtered results as blank array\n      vm.stationList = []; // Define Station list\n      vm.stationoocList = []; // Define out of county Station list\n      vm.stationicList = []; // Define in county Station list\n      vm.swiftPaygIds = []; // Define Swift PAYG tickets\n      vm.loadingStatus = ''; // Set results status to blank\n      vm.swiftPaygloadingStatus = ''; // Set results status to blank\n      vm.passValue = ''; // Set pass select value to blank\n      vm.orderBy = 'orderSequence';\n      vm.limit = parseInt($location.search().limit) || 6; // Set paging limit to what's in url or default to 6\n      vm.limitExact = parseInt($location.search().limitExact) || 6; // Set paging limit for exact results to what's in url or default to 6\n      vm.postJSON = {\n        allowBus: $location.search().allowBus || null,\n        allowMetro: $location.search().allowMetro || null,\n        allowTrain: $location.search().allowTrain || null,\n        passengerType: $location.search().passengerType || '',\n        timeBand: $location.search().timeBand || '',\n        brand: $location.search().brand || null,\n        stationNames: $location.search().stationNames || null\n      }; // Define postJSON default values\n      vm.stationFromName = null; // Clear Stations\n      vm.stationToName = null;\n      vm.stationFromTitle = null;\n      vm.stationToTitle = null;\n      vm.stationFromNameOocZ5 = null;\n      vm.stationToNameOocZ5 = null;\n      // vm.openFilters = openFilters;\n      // vm.closeFilters = closeFilters;\n      vm.fromStationInfo = null;\n      vm.eligibilityDate = null;\n\n      // url parameters\n      // exclude bus\n      vm.excludebusParameter = $location.search().excludeBus || null;\n\n      // direct debit\n      vm.buyOnDirectDebitParameter = $location.search().buyOnDirectDebit || null;\n\n      // quick buy\n      vm.buyOnDirectPurchaseParameter = $location.search().buyOnDirectPurchase || null;\n\n      // swift\n      vm.buyOnSwiftParameter = $location.search().buyOnSwift || null;\n\n      // buy online\n      vm.hasOnlinePurchaseChannelParameter = $location.search().hasOnlinePurchaseChannel || null;\n\n      // tic\n      vm.purchaseTicParameter = $location.search().purchaseTic || null;\n\n      // rail station\n      vm.purchaseRailStationParameter = $location.search().purchaseRailStation || null;\n\n      // payzone\n      vm.purchasePayzoneParameter = $location.search().purchasePayzone || null;\n\n      // bus travel area\n      vm.busTravelAreaParameter = $location.search().busTravelArea || null;\n\n      // bus operator\n      vm.operatorParameter = $location.search().operator || null;\n\n      // rail from zone\n      vm.railZoneFromParameter = $location.search().railZoneFrom || null;\n\n      // rail to zone\n      vm.railZoneToParameter = $location.search().railZoneTo || null;\n\n      // anytime\n      vm.timePeriodAnytimeParameter = $location.search().timePeriodAll || null;\n\n      // pre 9.30\n      vm.timePeriod1Parameter = $location.search().timePeriod1 || null;\n\n      // 9.30 - 3.30\n      vm.timePeriod2Parameter = $location.search().timePeriod2 || null;\n\n      // 3.30 - 6\n      vm.timePeriod3Parameter = $location.search().timePeriod3 || null;\n\n      // after 6\n      vm.timePeriod4Parameter = $location.search().timePeriod4 || null;\n\n      vm.clearModes = clearModes;\n      vm.postedJSON = {}; // Define the object to hold the initial search criteria\n\n      vm.stationFromReq = false; // set from station to not required\n      vm.stationToReq = false; // set from station to not required\n      vm.stationToReqtwo = false;\n      vm.stationFromOOCReq = true; // if Train OOC pass selected make station required\n      vm.timePeriodAll = true;\n      vm.fromZoneNumber = null;\n      vm.toZoneNumber = null;\n    }\n\n    defaultVars();\n\n    vm.slug = 'testing789';\n\n    console.log('v2.16.3');\n\n    // work out 16-18 elibility year\n    function subtractYears(dates, years) {\n      //  make copy with \"Date\" constructor\n      const dateCopy = new Date(dates);\n      dateCopy.setFullYear(date.getFullYear() - years);\n      return dateCopy;\n    }\n\n    const currentDate = new Date();\n    const year = currentDate.getFullYear();\n\n    const date = new Date(`${year}-09-01T00:00:00.000Z`);\n    let newDate = subtractYears(date, 18);\n\n    if (currentDate > date) {\n      newDate = subtractYears(date, 18);\n    } else {\n      newDate = subtractYears(date, 19);\n    }\n\n    vm.eligibilityDate = newDate.getFullYear();\n\n    // If location.search contains search criteria force the submit on page load\n    if (\n      $location.search().allowBus ||\n      $location.search().allowMetro ||\n      $location.search().allowTrain ||\n      ($location.search().brand &&\n        $location.search().passengerType &&\n        $location.search().timeBand) ||\n      $location.search().busTravelArea ||\n      $location.search().operator ||\n      $location.search().stationNames ||\n      $location.search().brand\n    ) {\n      vm.clearStation();\n      // Set initial value of from & to stations if in Url\n      if (\n        ($location.search().stationNames && vm.postJSON.allowTrain === true) ||\n        vm.postJSON.brand === 'nnetwork' ||\n        vm.postJSON.brand === 'ntrain'\n      ) {\n        if ($location.search().stationNames) {\n          stations = $location.search().stationNames;\n          stationSel = stations.toString();\n          stationSplit = stationSel.split(',');\n          vm.stationFromName = stationSplit['0'];\n          vm.stationToName = stationSplit['1'];\n          vm.stationViaOneName = stationSplit['2'];\n        }\n      } else {\n        vm.stationFromName = null;\n        vm.stationToName = null;\n      }\n      vm.getStations();\n      submit(vm.postJSON);\n    } else {\n      $location.url('').replace();\n    }\n\n    vm.showDetails = false;\n\n    // if back button pressed or breadcrumb selected. If brand is Swift PAYG make sure relevant tickets are shown\n    if ($location.search().brand === 'Swift PAYG') {\n      getSwiftPAYG();\n      swiftPAYG();\n    }\n\n    // if back button pressed or breadcrumb selected. If brand is Swift ABT\n    if ($location.search().brand === 'Swift Go') {\n      swiftABT();\n    }\n\n    // detect device in use\n    vm.deviceDetect();\n    function deviceDetect() {\n      vm.deviceDetector = deviceDetector;\n      vm.userAgent = deviceDetector.raw.userAgent;\n      // check if userAgent is Swift One app\n      if (vm.userAgent.includes('SwiftOneApp')) {\n        vm.oneApp = true;\n      } else {\n        vm.oneApp = false;\n      }\n      if (vm.userAgent.includes('android')) {\n        vm.android = true;\n      } else {\n        vm.android = false;\n      }\n      if (vm.deviceDetector.os === 'android' || vm.deviceDetector.os === 'ios') {\n        vm.isMobile = true;\n      } else {\n        vm.isMobile = false;\n      }\n    }\n\n    // Get Rail stations for autocomplete\n    function getStations() {\n      // console.log(\"get stations\");\n      ticketingService\n        .getStations()\n        .then(function(response) {\n          let fromRail;\n          let toRail;\n          let ViaOneRail;\n          let dataFromRail;\n          let dataToRail;\n          let dataViaOnRail;\n          let dataFromRailData;\n          let dataToRailData;\n          let dataViaOneRailData;\n          // console.log(\"rail stations\");\n          // console.log(response);\n          vm.stationList = response;\n          // if going direct to page with stations work out zone information\n          if (vm.stationFromName !== null) {\n            fromRail = vm.stationFromName || null;\n            toRail = vm.stationToName || null;\n            ViaOneRail = vm.stationViaOneName || null;\n            dataFromRail = $filter('filter')(response, { name: fromRail });\n            dataToRail = $filter('filter')(response, { name: toRail });\n            dataViaOnRail = $filter('filter')(response, { name: ViaOneRail });\n            dataFromRailData = dataFromRail['0'];\n            dataToRailData = dataToRail['0'];\n            dataViaOneRailData = dataViaOnRail['0'];\n            vm.fromStationInfo = dataFromRailData;\n            vm.toStationInfo = dataToRailData;\n            vm.ViaOneStationInfo = dataViaOneRailData;\n\n            if (vm.fromStationInfo != null) {\n              vm.fromZoneNumber = vm.fromStationInfo.zone;\n              vm.toZoneNumber = vm.toStationInfo.zone;\n              if (vm.ViaOneStationInfo != null) {\n                vm.ViaOneZoneNumber = vm.ViaOneStationInfo.zone;\n              }\n            }\n          }\n        })\n        .catch(function(error) {\n          vm.errorMessage =\n            'There was a problem loading train station data. Please try again later.';\n          vm.loadingStatus = 'error';\n          console.error(error);\n        });\n    }\n\n    function retryTicketSearch(data) {\n      // Retry after 5 seconds if not already retrying\n      if (!retryIntervalPromise) {\n        retryIntervalPromise = $interval(\n          function() {\n            submit(data);\n          },\n          5000,\n          2\n        ); // Only retry once per timeout/error\n      }\n    }\n\n    function submit(data) {\n      let fbus;\n      let ftrain;\n      let fmetro;\n      let i;\n      let j;\n      let arrlen;\n      let bus;\n      let train;\n      let metro;\n      let searchAll;\n      let searchExact;\n      vm.loadingStatus = 'loading';\n      angular.copy(vm.postJSON, vm.postedJSON); // save initial search variables\n\n      // Set a timeout for the API call (e.g., 10 seconds)\n      apiTimeoutPromise = $timeout(function() {\n        vm.errorMessage = 'The ticket search is taking too long. Retrying...';\n        vm.loadingStatus = 'timeout';\n\n        // Sentry log for slow API\n        if (window.Sentry && window.Sentry.captureMessage) {\n          window.Sentry.captureMessage('Ticket search API call is slow or unresponsive', {\n            level: 'warning',\n            extra: {\n              postJSON: vm.postJSON,\n              url: $location.absUrl()\n            }\n          });\n        }\n\n        submit(data);\n      }, 10000);\n\n      $location.search({\n        allowBus: vm.postedJSON.allowBus,\n        allowTrain: vm.postedJSON.allowTrain,\n        allowMetro: vm.postedJSON.allowMetro,\n        passengerType: vm.postedJSON.passengerType,\n        timeBand: vm.postedJSON.timeBand,\n        brand: vm.postedJSON.brand,\n        stationNames: vm.postedJSON.stationNames,\n        buyOnDirectDebit: vm.buyOnDirectDebitParameter,\n        buyOnDirectPurchase: vm.buyOnDirectPurchaseParameter,\n        buyOnSwift: vm.buyOnSwiftParameter,\n        hasOnlinePurchaseChannel: vm.hasOnlinePurchaseChannelParameter,\n        purchaseTic: vm.purchaseTicParameter,\n        purchaseRailStation: vm.purchaseRailStationParameter,\n        purchasePayzone: vm.purchasePayzoneParameter,\n        busTravelArea: vm.busTravelAreaParameter,\n        operator: vm.operatorParameter,\n        railZoneFrom: vm.railZoneFromParameter,\n        railZoneTo: vm.railZoneToParameter,\n        timePeriodAll: vm.timePeriodAnytimeParameter,\n        timePeriod1: vm.timePeriod1Parameter,\n        timePeriod2: vm.timePeriod2Parameter,\n        timePeriod3: vm.timePeriod3Parameter,\n        timePeriod4: vm.timePeriod4Parameter,\n        limit: vm.limit,\n        limitExact: vm.limitExact,\n        excludeBus: vm.excludebusParameter\n      }); // set search url for sharing/tracking\n\n      vm.searchFilters = {}; // set scope for search filters and reset on every search\n\n      vm.origFilters = {}; // set scope for original search filters and reset on every search\n      // console.log('this is posted');\n      // console.log(vm.postedJSON);\n\n      // work out all tickets available\n      ticketingService\n        .ticketSearch(data)\n        .then(function(response) {\n          $timeout.cancel(apiTimeoutPromise);\n          vm.all = response;\n          vm.original = response;\n\n          // For each item in the results\n          angular.forEach(vm.all, function(items) {\n            // Check the operator and push it to filters\n            if (vm.filterButtons.operator.indexOf(items.operator) === -1) {\n              vm.filterButtons.operator.push(items.operator);\n            }\n\n            // Check bus area\n            if (vm.filterButtons.busTravelArea.indexOf(items.busTravelArea) === -1) {\n              vm.filterButtons.busTravelArea.push(items.busTravelArea);\n            }\n\n            // Check rail zone from\n            if (vm.filterButtons.railZoneFrom.indexOf(items.railZoneFrom) === -1) {\n              vm.filterButtons.railZoneFrom.push(items.railZoneFrom);\n            }\n\n            // Check rail zone to\n            if (vm.filterButtons.railZoneTo.indexOf(items.railZoneTo) === -1) {\n              vm.filterButtons.railZoneTo.push(items.railZoneTo);\n            }\n\n            // eslint-disable-next-line angular/window-service\n            // console.log(window?.setTicketFinder?.name);\n            // console.log(items);\n            // console.log(items.buyTicketUrl);\n\n            // unicard\n            // \"https://natex-ssp.unicard-uk.com/ssp/swift/dnr_importBasket.jsp?[{matrixId:'CAA118'}]\",\n            // \"https://ticketing.cenapps.org.uk/DirectDebit/34\",\n\n            // \"https://my.swiftcard.org.uk/ssp/swift/dnr_importBasket.jsp?[{matrixId:'KAA045'}]\",\n            // \"buyTicketUrl\": \"https://ticketing.networkwestmidlands.com/DirectDebit/411\",\n\n            // Smart Citizen\n            // https://m-public-tfwmtest.smartcitizen.net/?matrixId=AAA116\n            // https://m-public-tfwm.smartcitizen.net/?matrixId=AAA116\n\n            // https://public-tfwmdev.smartcitizen.net/?matrixId=AAA116\n            // https://public-tfwmtest.smartcitizen.net/?matrixId=AAA116\n\n            // https://public-tfwmlive.smartcitizen.net//?matrixId=AAA116\n\n            // console.log('Original: ' + items.buyTicketUrl);\n\n            if (window?.setTicketFinder?.name.includes('TfWM Ticket Finder')) {\n              // console.log('Unicard app detected (Production)');\n              if (!items.buyTicketUrl.includes('ticketing.networkwestmidlands.com')) {\n                // eslint-disable-next-line no-unused-vars\n                const [host, queryString] = items.buyTicketUrl.split('?');\n                items.buyTicketUrl =\n                  'https://my.swiftcard.org.uk/ssp/swift/dnr_importBasket.jsp?' + queryString;\n              }\n            }\n\n            if (window?.setTicketFinder?.name.includes('Unicard Desktop Test')) {\n              // console.log('Unicard app detected (Test)');\n              if (!items.buyTicketUrl.includes('ticketing.cenapps.org.uk')) {\n                // eslint-disable-next-line no-unused-vars\n                const [host, queryString] = items.buyTicketUrl.split('?');\n                items.buyTicketUrl =\n                  'https://natex-ssp.unicard-uk.com/ssp/swift/dnr_importBasket.jsp?' + queryString;\n              }\n            }\n\n            // console.log(window?.setTicketFinder?.name);\n\n            if (\n              items.swiftCurrentAmount &&\n              window?.setTicketFinder?.name.includes('Smart Citizen')\n            ) {\n              console.log('payg detected');\n              let baseUrl2 = '';\n              if (window?.setTicketFinder?.name.includes('Smart Citizen Mobile Production')) {\n                baseUrl2 = 'https://m-public-tfwmlive.smartcitizen.net';\n              } else if (\n                window?.setTicketFinder?.name.includes('Smart Citizen Desktop Production')\n              ) {\n                baseUrl2 = 'https://public-tfwmlive.smartcitizen.net';\n              } else if (window?.setTicketFinder?.name.includes('Smart Citizen Mobile Test')) {\n                baseUrl2 = 'https://m-public-tfwmtest.smartcitizen.net';\n              } else if (window?.setTicketFinder?.name.includes('Smart Citizen Production')) {\n                baseUrl2 = 'https://public-tfwmlive.smartcitizen.net';\n              } else if (window?.setTicketFinder?.name.includes('Smart Citizen Test')) {\n                baseUrl2 = 'https://public-tfwmtest.smartcitizen.net';\n              } else if (window?.setTicketFinder?.name.includes('Smart Citizen Desktop Test')) {\n                baseUrl2 = 'https://public-tfwmtest.smartcitizen.net';\n              } else if (window?.setTicketFinder?.name.includes('Smart Citizen Dev')) {\n                baseUrl2 = 'https://public-tfwmdev.smartcitizen.net';\n              }\n\n              const paygUrl = baseUrl2 + '/?matrixId=AAC001';\n\n              console.log(paygUrl);\n\n              items.buyTicketUrl = baseUrl2 + '/?matrixId=AAC001';\n            }\n\n            // Check if the buy ticket url is a smartcitizen ticket finder and format it differently\n            if (\n              items.buyTicketUrl.includes('matrixId') &&\n              window?.setTicketFinder?.name.includes('Smart Citizen')\n            ) {\n              // console.log('Smart Citizen app detected' + window?.setTicketFinder?.name);\n              let baseUrl = '';\n              if (window?.setTicketFinder?.name.includes('Smart Citizen Mobile Production')) {\n                baseUrl = 'https://m-public-tfwmlive.smartcitizen.net';\n              } else if (\n                window?.setTicketFinder?.name.includes('Smart Citizen Desktop Production')\n              ) {\n                baseUrl = 'https://public-tfwmlive.smartcitizen.net';\n              } else if (window?.setTicketFinder?.name.includes('Smart Citizen Mobile Test')) {\n                baseUrl = 'https://m-public-tfwmtest.smartcitizen.net';\n              } else if (window?.setTicketFinder?.name.includes('Smart Citizen Production')) {\n                baseUrl = 'https://public-tfwmlive.smartcitizen.net';\n              } else if (window?.setTicketFinder?.name.includes('Smart Citizen Test')) {\n                baseUrl = 'https://public-tfwmtest.smartcitizen.net';\n              } else if (window?.setTicketFinder?.name.includes('Smart Citizen Desktop Test')) {\n                baseUrl = 'https://public-tfwmtest.smartcitizen.net';\n              } else if (window?.setTicketFinder?.name.includes('Smart Citizen Dev')) {\n                baseUrl = 'https://public-tfwmdev.smartcitizen.net';\n              }\n              // console.log('baseurl: ' + baseUrl);\n              // eslint-disable-next-line no-unused-vars\n              const [host, queryString] = items.buyTicketUrl.split('?');\n              const matrixid = queryString\n                .replace('https://', '')\n                .replace(/[\\[\\]]/g, '')\n                .replace(/[{}]/g, '')\n                .replace(/:/g, '=')\n                .replace(/'/g, '');\n              items.buyTicketUrl = baseUrl + '?' + matrixid;\n            }\n            // console.log('Final: ' + items.buyTicketUrl);\n            return items.buyTicketUrl;\n          });\n\n          fbus = vm.postedJSON.allowBus || false;\n          ftrain = vm.postedJSON.allowTrain || false;\n          fmetro = vm.postedJSON.allowMetro || false;\n\n          if (\n            vm.postJSON.allowTrain === true ||\n            vm.postJSON.brand === 'nnetwork' ||\n            vm.postJSON.brand === 'ntrain'\n          ) {\n            if (vm.fromStationInfoZone != null) {\n              vm.fromZoneNumber = vm.fromStationInfoZone;\n            } else if (vm.fromStationInfo != null) {\n              vm.fromZoneNumber = vm.fromStationInfo.zone;\n            } else {\n              vm.fromZoneNumber = null;\n            }\n\n            if (vm.toStationInfoZone != null) {\n              vm.toZoneNumber = vm.toStationInfoZone;\n            } else if (vm.toStationInfo != null) {\n              vm.toZoneNumber = vm.toStationInfo.zone;\n            } else {\n              vm.toZoneNumber = null;\n            }\n\n            if (vm.fromZoneNumber === '1') {\n              vm.ffromzone = 1;\n            } else if (vm.fromZoneNumber === '2') {\n              vm.ffromzone = 2;\n            } else if (vm.fromZoneNumber === '3') {\n              vm.ffromzone = 3;\n            } else if (vm.fromZoneNumber === '4') {\n              vm.ffromzone = 4;\n            } else if (vm.fromZoneNumber === '5') {\n              vm.ffromzone = 5;\n            } else {\n              vm.ffromzone = null;\n            }\n\n            if (vm.toZoneNumber === '1') {\n              vm.ftozone = 1;\n            } else if (vm.toZoneNumber === '2') {\n              vm.ftozone = 2;\n            } else if (vm.toZoneNumber === '3') {\n              vm.ftozone = 3;\n            } else if (vm.toZoneNumber === '4') {\n              vm.ftozone = 4;\n            } else if (vm.toZoneNumber === '5') {\n              vm.ftozone = 5;\n            } else {\n              vm.ftozone = null;\n            }\n\n            if (vm.ViaOneZoneNumber === '1') {\n              vm.fViaOnezone = 1;\n            } else if (vm.ViaOneZoneNumber === '2') {\n              vm.fViaOnezone = 2;\n            } else if (vm.ViaOneZoneNumber === '3') {\n              vm.fViaOnezone = 3;\n            } else if (vm.ViaOneZoneNumber === '4') {\n              vm.fViaOnezone = 4;\n            } else if (vm.ViaOneZoneNumber === '5') {\n              vm.fViaOnezone = 5;\n            } else {\n              vm.fViaOnezone = null;\n            }\n\n            if (vm.ViaOneZoneNumber != null) {\n              if (vm.ViaOneZoneNumber < vm.fromZoneNumber) {\n                vm.ffromzone = vm.ViaOneZoneNumber;\n              } else if (vm.ViaOneZoneNumber > vm.toZoneNumber) {\n                vm.ftozone = vm.ViaOneZoneNumber;\n              }\n            }\n          }\n\n          if (vm.postJSON.allowTrain === true) {\n            vm.exactMatch = [];\n            if (vm.fromZoneNumber !== null && vm.toZoneNumber !== null) {\n              // exact results won't work if from zone is greater then the to zone so do a check\n              if (vm.ffromzone < vm.ftozone) {\n                vm.exactMatch = $filter('filter')(response, {\n                  allowBus: fbus,\n                  allowTrain: ftrain,\n                  allowMetro: fmetro,\n                  railZoneFrom: vm.ffromzone,\n                  railZoneTo: vm.ftozone\n                });\n              } else if (vm.ffromzone > vm.ftozone) {\n                vm.exactMatch = $filter('filter')(response, {\n                  allowBus: fbus,\n                  allowTrain: ftrain,\n                  allowMetro: fmetro,\n                  railZoneFrom: vm.ftozone,\n                  railZoneTo: vm.ffromzone\n                });\n              } else if (vm.ffromzone === vm.ftozone) {\n                vm.exactMatch = $filter('filter')(response, {\n                  allowBus: fbus,\n                  allowTrain: ftrain,\n                  allowMetro: fmetro,\n                  railZoneFrom: 1,\n                  railZoneTo: vm.ftozone\n                });\n              }\n            } else {\n              vm.exactMatch = $filter('filter')(response, {\n                allowBus: fbus,\n                allowTrain: ftrain,\n                allowMetro: fmetro\n              });\n            }\n          } else if (vm.postJSON.brand === 'nnetwork' || vm.postJSON.brand === 'ntrain') {\n            vm.exactMatch = [];\n            if (vm.fromZoneNumber !== null && vm.toZoneNumber !== null) {\n              // exact results won't work if from zone is greater then the to zone so do a check\n              if (vm.ffromzone < vm.ftozone) {\n                vm.exactMatch = $filter('filter')(response, {\n                  railZoneFrom: vm.ffromzone,\n                  railZoneTo: vm.ftozone\n                });\n              } else if (vm.ffromzone > vm.ftozone) {\n                vm.exactMatch = $filter('filter')(response, {\n                  railZoneFrom: vm.ftozone,\n                  railZoneTo: vm.ffromzone\n                });\n              } else if (vm.ffromzone === vm.ftozone) {\n                vm.exactMatch = $filter('filter')(response, {\n                  railZoneFrom: 1,\n                  railZoneTo: vm.ftozone\n                });\n              }\n            } else {\n              vm.exactMatch = $filter('filter')(response, {});\n            }\n          } else {\n            // console.log(\"Exact Search without rail\");\n            vm.postedJSON.stationNames = null; // make sure no stations are included if train not checked.\n            vm.exactMatch = $filter('filter')(response, {\n              allowBus: fbus,\n              allowTrain: ftrain,\n              allowMetro: fmetro\n            });\n          }\n\n          // compare search results and exact search results and display difference\n          searchAll = vm.all;\n          searchExact = vm.exactMatch;\n          // console.log('all results');\n          // console.log(searchAll);\n          // console.log(\"search exact results\");\n          // console.log(vm.exactMatch);\n\n          for (i = 0; i < searchExact.length; i += 1) {\n            arrlen = searchAll.length;\n            for (j = 0; j < arrlen; j += 1) {\n              if (searchExact[i] === searchAll[j]) {\n                searchAll = searchAll.slice(0, j).concat(searchAll.slice(j + 1, arrlen));\n              }\n            }\n          }\n\n          vm.otherResults = searchAll;\n\n          bus = vm.postedJSON.allowBus;\n          train = vm.postedJSON.allowTrain;\n          metro = vm.postedJSON.allowMetro;\n\n          // if 1 or 2 modes selected open up the exclude mode filter\n          if (\n            bus !== null ||\n            (bus !== null && train !== null) ||\n            (bus !== null && metro !== null) ||\n            (train !== null && metro !== null)\n          ) {\n            vm.toggleFilter('mode');\n          }\n\n          // if all modes selected open up how to buy filter\n          if (bus !== null && train !== null && metro !== null) {\n            vm.toggleFilter('payment');\n          }\n\n          vm.update(); // When feed is loaded run it through the filters\n          vm.loadingStatus = 'success';\n          vm.errorMessage = ''; // Clear any error messages\n          // scroll to results\n          $location.hash('sbmBtn');\n          $anchorScroll();\n        })\n        .catch(function(error) {\n          vm.errorMessage = 'There was a problem loading ticket data. Please try again later.';\n          vm.loadingStatus = 'error';\n          retryTicketSearch(data);\n          console.error(error);\n        });\n    }\n\n    function update() {\n      let filtered = vm.all;\n      let filteredorg = vm.exactMatch;\n      let filteredother = vm.otherResults;\n\n      // For each filter in the search filters loop through and delete any that state false, this is so it doesn't explicitly match false and shows everything.\n      angular.forEach(vm.searchFilters, function(val, key) {\n        // if Key/Property contains 'Allow\" and the value is true || if Key/Property doesn't contain 'Allow' and val is false (this is to make sure the opposite/exclude filter values are deleted as the trues will be false and vice versa)\n        if (\n          (key.indexOf('allow') !== -1 && val) ||\n          (val === false && key.indexOf('allow') === -1)\n        ) {\n          // Delete the filter and value\n          delete vm.searchFilters[key];\n        }\n        // if pre 9.30 is selected\n        if (vm.searchFilters.timePeriod1) {\n          vm.searchFilters.timePeriod2 = false;\n          vm.searchFilters.timePeriod3 = false;\n          vm.searchFilters.timePeriod4 = false;\n        }\n        // if 9.30 - 3.30 is selected\n        if (vm.searchFilters.timePeriod2) {\n          vm.searchFilters.timePeriod1 = false;\n          vm.searchFilters.timePeriod3 = false;\n          vm.searchFilters.timePeriod4 = false;\n        }\n        // if 3.30 - 6 is selected\n        if (vm.searchFilters.timePeriod3) {\n          vm.searchFilters.timePeriod1 = false;\n          vm.searchFilters.timePeriod2 = false;\n          vm.searchFilters.timePeriod4 = false;\n        }\n        // if after 6 is selected\n        if (vm.searchFilters.timePeriod4) {\n          vm.searchFilters.timePeriod1 = false;\n          vm.searchFilters.timePeriod2 = false;\n          vm.searchFilters.timePeriod3 = false;\n        }\n        // if anytime is selected\n        if (vm.timePeriodAll === 'yes') {\n          // vm.searchFilters.timeLimited = false;\n          // vm.searchFilters.timePeriod1 = '';\n          vm.searchFilters.timePeriod1 = true;\n          vm.searchFilters.timePeriod2 = true;\n          vm.searchFilters.timePeriod3 = true;\n          vm.searchFilters.timePeriod4 = true;\n        }\n      });\n\n      // Filter results by the filters selected\n      filtered = $filter('filter')(filtered, vm.searchFilters);\n      filteredorg = $filter('filter')(filteredorg, vm.searchFilters);\n      filteredother = $filter('filter')(filteredother, vm.searchFilters);\n\n      // Sort results by selected option\n      vm.filteredTickets = $filter('orderBy')(filtered, vm.orderBy);\n      vm.origTickets = $filter('orderBy')(filteredorg, vm.orderBy);\n      vm.otherTickets = $filter('orderBy')(filteredother, vm.orderBy);\n\n      // order filtering\n      if (vm.orderBy === 'orderSequence') {\n        vm.origTickets.sort(function(a, b) {\n          // set conditional attributes for refresher\n          vm.sortPop = 'yes';\n          vm.sortPlw = 'no';\n          vm.sortPhl = 'no';\n          return b.buyOnDirectDebit - a.buyOnDirectDebit;\n        });\n      } else if (vm.orderBy === 'ticketCurrentAmount') {\n        vm.origTickets.sort(function(a, b) {\n          vm.sortPop = 'no';\n          vm.sortPlw = 'yes';\n          vm.sortPhl = 'no';\n          return a.ticketCurrentAmount - b.ticketCurrentAmount;\n        });\n      } else if (vm.orderBy === '-ticketCurrentAmount') {\n        vm.origTickets.sort(function(a, b) {\n          vm.sortPop = 'no';\n          vm.sortPlw = 'no';\n          vm.sortPhl = 'yes';\n          return b.ticketCurrentAmount - a.ticketCurrentAmount;\n        });\n      }\n\n      // console.log(\"Search Filters:\");\n      // console.log(vm.searchFilters);\n      // console.log(\"Filtered Tickets:\");\n      // console.log(vm.filteredTickets);\n      // console.log('Original Search:');\n      // console.log(vm.origTickets);\n      // console.log('Other Results:');\n      // console.log(vm.otherTickets);\n\n      vm.updateGrid();\n    }\n\n    updateGrid.$inject = ['$timeout', 'angularGridInstance'];\n    function updateGrid() {\n      $timeout(\n        function() {\n          $timeout(\n            function() {\n              let searchURL;\n              let urlstring;\n              let abus;\n              let atrain;\n              let ametro;\n              let atime;\n              let obj;\n              if (vm.filteredTickets.length) {\n                // set storage url according to search filters\n                // set data to be displayed in serializer\n                obj = {\n                  passengerType: vm.postedJSON.passengerType,\n                  timeBand: vm.postedJSON.timeBand,\n                  brand: vm.postedJSON.brand,\n                  stationNames: vm.postedJSON.stationNames,\n                  busTravelArea: vm.searchFilters.busTravelArea,\n                  operator: vm.searchFilters.operator,\n                  buyOnDirectDebit: vm.searchFilters.buyOnDirectDebit,\n                  buyOnDirectPurchase: vm.searchFilters.buyOnDirectPurchase || null,\n                  buyOnSwift: vm.searchFilters.buyOnSwift,\n                  hasOnlinePurchaseChannel: vm.searchFilters.hasOnlinePurchaseChannel,\n                  purchaseTic: vm.searchFilters.purchaseTic,\n                  purchaseRailStation: vm.searchFilters.purchaseRailStation,\n                  purchasePayzone: vm.searchFilters.purchasePayzone,\n                  railZoneFrom: vm.searchFilters.railZoneFrom,\n                  railZoneTo: vm.searchFilters.railZoneTo,\n                  limit: vm.limit,\n                  limitExact: vm.limitExact,\n                  excludeBus: vm.searchFilters.allowBus\n                };\n\n                urlstring = $httpParamSerializer(obj);\n\n                if (vm.postedJSON.allowBus) {\n                  abus = 'allowBus';\n                }\n\n                if (vm.postedJSON.allowTrain) {\n                  atrain = 'allowTrain';\n                }\n\n                if (vm.postedJSON.allowMetro) {\n                  ametro = 'allowMetro';\n                }\n\n                // work out time of day selection and update searchURL\n                if (vm.searchFilters.timePeriod1 === true) {\n                  atime = '&timePeriod1=true&timePeriod2=false&timePeriod3=false&timePeriod4=false';\n                } else if (vm.searchFilters.timePeriod2 === true) {\n                  atime = '&timePeriod1=false&timePeriod2=true&timePeriod3=false&timePeriod4=false';\n                } else if (vm.searchFilters.timePeriod3 === true) {\n                  atime = '&timePeriod1=false&timePeriod2=false&timePeriod3=true&timePeriod4=false';\n                } else if (vm.searchFilters.timePeriod4 === true) {\n                  atime = '&timePeriod1=false&timePeriod2=false&timePeriod3=false&timePeriod4=true';\n                } else if (vm.timePeriodAll === true) {\n                  atime = '&timePeriodAll=true';\n                } else {\n                  atime = '';\n                }\n\n                // bus only\n                if (\n                  vm.postedJSON.allowBus &&\n                  !vm.postedJSON.allowTrain &&\n                  !vm.postedJSON.allowMetro\n                ) {\n                  searchURL = '/?' + abus + '&' + urlstring + atime;\n                  // console.log(\"bus only - \" + searchURL);\n                  savedFilter.set('url', searchURL);\n                }\n\n                // bus and train\n                if (\n                  vm.postedJSON.allowBus &&\n                  vm.postedJSON.allowTrain &&\n                  !vm.postedJSON.allowMetro\n                ) {\n                  searchURL = '/?' + abus + '&' + atrain + '&' + urlstring + atime;\n                  // console.log(searchURL);\n                  savedFilter.set('url', searchURL);\n                }\n                // bus and metro\n                if (\n                  vm.postedJSON.allowBus &&\n                  !vm.postedJSON.allowTrain &&\n                  vm.postedJSON.allowMetro\n                ) {\n                  searchURL = '/?' + abus + '&' + ametro + '&' + urlstring + atime;\n                  // console.log(searchURL);\n                  savedFilter.set('url', searchURL);\n                }\n                // train only\n                if (\n                  !vm.postedJSON.allowBus &&\n                  vm.postedJSON.allowTrain &&\n                  !vm.postedJSON.allowMetro\n                ) {\n                  searchURL = '/?' + atrain + '&' + urlstring + atime;\n                  // console.log(searchURL);\n                  savedFilter.set('url', searchURL);\n                }\n                // train and metro\n                if (\n                  !vm.postedJSON.allowBus &&\n                  vm.postedJSON.allowTrain &&\n                  vm.postedJSON.allowMetro\n                ) {\n                  searchURL = '/?' + atrain + '&' + ametro + '&' + urlstring + atime;\n                  // console.log(searchURL);\n                  savedFilter.set('url', searchURL);\n                }\n                // metro only\n                if (\n                  !vm.postedJSON.allowBus &&\n                  !vm.postedJSON.allowTrain &&\n                  vm.postedJSON.allowMetro\n                ) {\n                  searchURL = '/?' + ametro + '&' + urlstring + atime;\n                  // console.log(searchURL);\n                  savedFilter.set('url', searchURL);\n                }\n                // all modes selected\n                if (\n                  vm.postedJSON.allowBus &&\n                  vm.postedJSON.allowTrain &&\n                  vm.postedJSON.allowMetro\n                ) {\n                  searchURL = '/?' + abus + '&' + atrain + '&' + ametro + '&' + urlstring + atime;\n                  // console.log(searchURL);\n                  savedFilter.set('url', searchURL);\n                }\n                // no modes selected\n                if (\n                  !vm.postedJSON.allowBus &&\n                  !vm.postedJSON.allowTrain &&\n                  !vm.postedJSON.allowMetro\n                ) {\n                  searchURL = '/?' + urlstring + atime;\n                  // console.log(searchURL);\n                  savedFilter.set('url', searchURL);\n                }\n                // load.log(searchURL);\n              }\n            },\n            0,\n            false\n          );\n        },\n        0,\n        false\n      );\n    }\n\n    // get Out Of County Rail stations for autocomplete\n    function getoocStations() {\n      ticketingService\n        .getStations()\n        .then(function(response) {\n          // console.log(\"out of county stations\");\n          // console.log(response);\n          const OutOfCounty = $filter('filter')(response, {\n            outOfCounty: 'true'\n          });\n          vm.stationoocList = OutOfCounty;\n        })\n        .catch(function(error) {\n          vm.errorMessage =\n            'There was a problem loading train station data. Please try again later.';\n          vm.loadingStatus = 'error';\n          console.error(error);\n        });\n    }\n\n    // get In County Rail stations for autocomplete\n    function geticStations() {\n      ticketingService\n        .getStations()\n        .then(function(response) {\n          const inCounty = $filter('filter')(response, { outOfCounty: 'false' });\n          vm.stationicList = inCounty;\n        })\n        .catch(function(error) {\n          vm.errorMessage =\n            'There was a problem loading train station data. Please try again later.';\n          vm.loadingStatus = 'error';\n          console.error(error);\n        });\n    }\n\n    // reset search\n    function clearFilter() {\n      $location.url('').replace();\n      defaultVars();\n      // clear filter checkboxes\n      vm.excludeBusCheck = function() {\n        return false;\n      };\n      vm.excludeTrainCheck = function() {\n        return false;\n      };\n      vm.excludeTramCheck = function() {\n        return false;\n      };\n      vm.buyOnDirectDebitCheck = function() {\n        return false;\n      };\n      vm.buyOnDirectPurchaseCheck = function() {\n        return false;\n      };\n      vm.buyOnSwiftCheck = function() {\n        return false;\n      };\n      vm.hasOnlinePurchaseChannelCheck = function() {\n        return false;\n      };\n      vm.purchaseTicCheck = function() {\n        return false;\n      };\n      vm.purchaseRailStationCheck = function() {\n        return false;\n      };\n      vm.purchasePayzoneCheck = function() {\n        return false;\n      };\n      vm.timePeriod1CheckAll = function() {\n        return false;\n      };\n      vm.timePeriod1Check = function() {\n        return false;\n      };\n      vm.timePeriod2Check = function() {\n        return false;\n      };\n      vm.timePeriod3Check = function() {\n        return false;\n      };\n      vm.timePeriod4Check = function() {\n        return false;\n      };\n      savedFilter.set('url', '');\n      vm.postJSON.stationNames = [];\n      clearFromStation();\n      clearToStation();\n      clearViaOneStation();\n    }\n\n    // if a pass is selected deselect all modes\n    function clearModes() {\n      vm.postJSON.allowBus = null;\n      vm.postJSON.allowTrain = null;\n      vm.postJSON.allowMetro = null;\n    }\n\n    // if no stations set in url make sure from station is set to null. This is to fix back function adding [] in from station\n    function clearStation() {\n      if ($location.search().stationNames === '[]') {\n        clearFromStation();\n      }\n    }\n\n    // clear time selections\n    function clearTime() {\n      // uncheck time of day checkboxes\n      vm.timePeriod1CheckAll = function() {\n        return false;\n      };\n      vm.timePeriod1Check = function() {\n        return false;\n      };\n      vm.timePeriod2Check = function() {\n        return false;\n      };\n      vm.timePeriod3Check = function() {\n        return false;\n      };\n      vm.timePeriod4Check = function() {\n        return false;\n      };\n      // make time selections false to reset default search criteria\n      vm.timePeriodAll = false;\n      vm.searchFilters.timePeriod1 = false;\n      vm.searchFilters.timePeriod2 = false;\n      vm.searchFilters.timePeriod3 = false;\n      vm.searchFilters.timePeriod4 = false;\n      vm.update();\n    }\n\n    function checkTimeAll() {\n      if (vm.timePeriodAll === 'yes') {\n        vm.searchFilters.timePeriod1 = true;\n        vm.searchFilters.timePeriod2 = true;\n        vm.searchFilters.timePeriod3 = true;\n        vm.searchFilters.timePeriod4 = true;\n\n        vm.timePeriod1CheckAll = function() {\n          return true;\n        };\n        vm.timePeriod1Check = function() {\n          return false;\n        };\n        vm.timePeriod2Check = function() {\n          return false;\n        };\n        vm.timePeriod3Check = function() {\n          return false;\n        };\n        vm.timePeriod4Check = function() {\n          return false;\n        };\n      } else if (vm.timePeriodAll === 'no') {\n        vm.searchFilters.timePeriod1 = '';\n        vm.searchFilters.timePeriod2 = '';\n        vm.searchFilters.timePeriod3 = '';\n        vm.searchFilters.timePeriod4 = '';\n      }\n    }\n\n    // disable anytime if another time period is selected\n    function checkTime() {\n      vm.timePeriodAll = false;\n      if (vm.timePeriodAll === false) {\n        vm.timePeriod1CheckAll = function() {\n          return false;\n        };\n      }\n    }\n\n    // rail stations - at least 2 required for api to work\n\n    // set From Rail Station\n    vm.fromEmpty = 'none';\n\n    vm.fromStationInputChanged = function(str) {\n      vm.fromStationText = str;\n    };\n\n    vm.fromfocusState = 'None';\n    vm.fromFocusIn = function() {\n      vm.fromfocusState = 'In';\n    };\n    vm.fromFocusOut = function() {\n      vm.fromfocusState = 'Out';\n\n      if (vm.stationToName != null) {\n        vm.stationFromReq = true;\n      }\n\n      if (vm.fromStationText != null && vm.stationFromName == null) {\n        vm.stationFromReq = true;\n      }\n    };\n\n    vm.stationFromReq = false; // set from station to not required\n    vm.stationFromReqOOC = true; // set ooc station to required\n    vm.stationFrom = function(selected) {\n      if (selected) {\n        vm.postJSON.stationNames = [];\n        vm.stationFromName = selected.originalObject.name; // set From station\n        vm.postJSON.stationNames[0] = selected.originalObject.name;\n        vm.stationFromNameZone = selected.originalObject.zone;\n        vm.stationFromNameOoc = selected.originalObject.outOfCounty;\n        vm.stationFromNameOocZ5 = selected.originalObject.zone5InCounty;\n        vm.fromZoneNumber = selected.originalObject.zone;\n        vm.fromStationInfoZone = selected.originalObject.zone;\n        vm.stationFromReq = false; // set from to required to ensure selection is made from list\n        vm.fromEmpty = true;\n      } else {\n        vm.stationFromName = null;\n        vm.postJSON.stationNames[0] = null;\n        vm.stationFromReq = false; // set from to required to ensure selection is made from list\n        vm.fromEmpty = false;\n      }\n    };\n\n    // reset from station\n    function clearFromStation() {\n      $scope.$broadcast('angucomplete-alt:clearInput', 'stationFrom');\n      $scope.$broadcast('angucomplete-alt:clearInput', 'stationFromOOC');\n      vm.stationFromName = null;\n      vm.postJSON.stationNames[0] = null;\n      vm.stationFromReq = false; // set from station to not required\n      vm.stationFromNameOocZ5 = null; // clear zone 5 in county\n      vm.fromStationInfoZone = null;\n      vm.fromStationText = null;\n    }\n\n    // set To Rail Station\n    vm.toEmpty = 'none';\n\n    vm.toStationInputChanged = function(str) {\n      vm.toStationText = str;\n    };\n\n    vm.tofocusState = 'None';\n    vm.toFocusIn = function() {\n      vm.tofocusState = 'In';\n\n      if (vm.stationFromName != null) {\n        vm.stationToReq = true;\n      }\n    };\n    vm.toFocusOut = function() {\n      vm.tofocusState = 'Out';\n\n      if (vm.stationFromName != null) {\n        vm.stationToReq = true;\n      }\n\n      if (vm.toStationText !== null && vm.stationToName === null) {\n        vm.stationToReq = true;\n      }\n    };\n\n    vm.stationToReq = false; // set to station to not required\n    vm.stationToReqOOC = true;\n    vm.stationTo = function(selected) {\n      if (selected) {\n        vm.stationToName = selected.title; // set To Station\n        vm.postJSON.stationNames[1] = selected.originalObject.name;\n        vm.stationToTitle = selected.originalObject.name;\n        vm.stationToNameZone = selected.originalObject.zone;\n        vm.stationToNameOoc = selected.originalObject.outOfCounty;\n        vm.stationToNameOocZ5 = selected.originalObject.zone5InCounty;\n        vm.toZoneNumber = selected.originalObject.zone;\n        vm.toStationInfoZone = selected.originalObject.zone;\n        vm.stationToReq = false; // set to to required to ensure selection is made from list\n        vm.toEmpty = true;\n      } else {\n        vm.stationToName = null;\n        vm.postJSON.stationNames[1] = null;\n        vm.stationToTitle = null;\n        vm.toEmpty = false;\n      }\n    };\n\n    // reset to station\n    function clearToStation() {\n      $scope.$broadcast('angucomplete-alt:clearInput', 'stationTo');\n      $scope.$broadcast('angucomplete-alt:clearInput', 'stationTo2');\n      $scope.$broadcast('angucomplete-alt:clearInput', 'stationTo3');\n      vm.stationToName = '';\n      vm.postJSON.stationNames[1] = null;\n      vm.stationToReq = false; // set to station to not required\n      vm.stationToNameOocZ5 = null; // clear zone 5 in county\n      vm.toStationInfoZone = null;\n      vm.toStationText = '';\n    }\n\n    // via station\n    vm.viaOneStationInputChanged = function(str) {\n      vm.viaOneStationText = str;\n    };\n\n    vm.viaOnefocusState = 'None';\n    vm.stationViaOneFocusIn = function() {\n      vm.viaOnefocusState = 'In';\n    };\n    vm.stationViaOneFocusOut = function() {\n      vm.viaOnefocusState = 'Out';\n\n      if (vm.stationViaOneName != null) {\n        vm.stationviaOneReq = true;\n      }\n\n      if (vm.viaOneStationText != null || vm.stationViaOneName == null) {\n        vm.stationViaOneReq = true;\n        vm.stationToReq = true;\n        vm.stationFromReq = true;\n      }\n    };\n\n    vm.stationViaOne = function(selected) {\n      if (selected) {\n        vm.stationViaOneName = selected.originalObject.name; // set To Station\n        vm.postJSON.stationNames[2] = selected.originalObject.name;\n        vm.stationViaOneTitle = selected.originalObject.name;\n        vm.stationViaOneNameZone = selected.originalObject.zone;\n        vm.stationViaOneNameOoc = selected.originalObject.outOfCounty;\n        vm.stationViaOneNameOocZ5 = selected.originalObject.zone5InCounty;\n        vm.ViaOneZoneNumber = selected.originalObject.zone;\n        vm.ViaOneStationInfoZone = selected.originalObject.zone;\n      }\n    };\n\n    // show via station if not null\n    if (vm.stationViaOneName != null) {\n      vm.stationVia = true;\n    }\n\n    // reset via one station\n    function clearViaOneStation() {\n      $scope.$broadcast('angucomplete-alt:clearInput', 'stationViaOne');\n      vm.stationViaOneName = null;\n      vm.viaOneStationText = null;\n      vm.stationViaOneName = null;\n      vm.postJSON.stationNames = [];\n    }\n\n    // control filters according to url parameters\n    // exclude bus\n    if (vm.excludebusParameter) {\n      // open how to buy filter\n      vm.filterButtons.mode = !vm.filterButtons.mode;\n      // set search filters to include DD\n      vm.searchFilters.allowBus = false;\n      // make sure DD is ticked\n      vm.excludeBusCheck = function() {\n        return true;\n      };\n    }\n\n    // direct debit\n    if (vm.buyOnDirectDebitParameter) {\n      // open how to buy filter\n      vm.filterButtons.payment = !vm.filterButtons.payment;\n      // set search filters to include DD\n      vm.searchFilters.buyOnDirectDebit = true;\n      // make sure DD is ticked\n      vm.buyOnDirectDebitCheck = function() {\n        return true;\n      };\n    }\n\n    // quick buy\n    if (vm.buyOnDirectPurchaseParameter) {\n      // open how to buy filter\n      vm.filterButtons.payment = !vm.filterButtons.payment;\n      // set search filters to include quick buy\n      vm.searchFilters.buyOnDirectPurchase = true;\n      // make sure quick buy is ticked\n      vm.buyOnDirectPurchaseCheck = function() {\n        return true;\n      };\n    }\n\n    // buy on swift\n    if (vm.buyOnSwiftParameter) {\n      // open how to buy filter\n      vm.filterButtons.payment = !vm.filterButtons.payment;\n      // set search filters to include swift\n      vm.searchFilters.buyOnSwift = true;\n      // make sure swift is ticked\n      vm.buyOnSwiftCheck = function() {\n        return true;\n      };\n    }\n\n    // buy online\n    if (vm.hasOnlinePurchaseChannelParameter) {\n      // pen how to buy filter\n      vm.filterButtons.payment = !vm.filterButtons.payment;\n      // set search filters to include buy online\n      vm.searchFilters.hasOnlinePurchaseChannel = true;\n      // make sure buy online is ticked\n      vm.hasOnlinePurchaseChannelCheck = function() {\n        return true;\n      };\n    }\n\n    // buy at tic\n    if (vm.purchaseTicParameter) {\n      // open how to buy filter\n      vm.filterButtons.payment = !vm.filterButtons.payment;\n      // set search filters to include buy from tic\n      vm.searchFilters.purchaseTic = true;\n      // make sure tic is ticked\n      vm.purchaseTicCheck = function() {\n        return true;\n      };\n    }\n\n    // buy rail station\n    if (vm.purchaseRailStationParameter) {\n      // open how to buy filter\n      vm.filterButtons.payment = !vm.filterButtons.payment;\n      // set search filters to include rail station\n      vm.searchFilters.purchaseRailStation = true;\n      // make sure rail station is ticked\n      vm.purchaseRailStationCheck = function() {\n        return true;\n      };\n    }\n\n    // payzone\n    if (vm.purchasePayzoneParameter) {\n      // open how to buy filter\n      vm.filterButtons.payment = !vm.filterButtons.payment;\n      // set search filters to include payzone\n      vm.searchFilters.purchasePayzone = true;\n      // make sure payzone is ticked\n      vm.purchasePayzoneCheck = function() {\n        return true;\n      };\n    }\n\n    // us travel area\n    if (vm.busTravelAreaParameter) {\n      // open bus area filter\n      vm.filterButtons.busTravelAreaBtn = !vm.filterButtons.busTravelAreaBtn;\n      // set search filters to include bus area\n      vm.searchFilters.busTravelArea = vm.busTravelAreaParameter;\n    }\n\n    // us operator\n    if (vm.operatorParameter) {\n      // open bus operator filter\n      vm.filterButtons.operatorBtn = !vm.filterButtons.operatorBtn;\n      // set search filters to include bus operator\n      vm.searchFilters.operator = vm.operatorParameter;\n    }\n\n    // from rail zone\n    if (vm.railZoneFromParameter) {\n      // open rail zones filter\n      vm.filterButtons.railZoneBtn = !vm.filterButtons.railZoneBtn;\n      // set search filters to include from rail zone\n      vm.searchFilters.railZoneFrom = vm.railZoneFromParameter;\n    }\n\n    // to rail zone\n    if (vm.railZoneToParameter) {\n      // open rail zone filter\n      vm.filterButtons.railZoneBtn = !vm.filterButtons.railZoneBtn;\n      // set search filters to include to rail zone\n      vm.searchFilters.railZoneTo = vm.railZoneToParameter;\n    }\n\n    // anytime\n    if ($location.search().timePeriodAll === 'true') {\n      // update search filters\n      vm.searchFilters.timeLimited = false;\n      vm.searchFilters.timePeriod1 = '';\n      // open time of day filter\n      vm.filterButtons.time = !vm.filterButtons.time;\n      // set search filters to include timePeriod1\n      vm.timePeriodAll = true;\n      // make sure payzone is ticked\n      vm.timePeriod1CheckAll = function() {\n        return true;\n      };\n    }\n\n    // pre 9.30\n    if ($location.search().timePeriod1 === 'true') {\n      // open time of day filter\n      vm.filterButtons.time = !vm.filterButtons.time;\n      // set search filters to include timePeriod1\n      vm.searchFilters.timePeriod1 = true;\n      // make sure payzone is ticked\n      vm.timePeriod1Check = function() {\n        return true;\n      };\n    }\n\n    // 9.30 - 3.30\n    if ($location.search().timePeriod2 === 'true') {\n      // open time of day filter\n      vm.filterButtons.time = !vm.filterButtons.time;\n      // set search filters to include timePeriod1\n      vm.searchFilters.timePeriod2 = true;\n      // make sure payzone is ticked\n      vm.timePeriod2Check = function() {\n        return true;\n      };\n    }\n\n    // 3.30 - 6\n    if ($location.search().timePeriod3 === 'true') {\n      // pen time of day filter\n      vm.filterButtons.time = !vm.filterButtons.time;\n      // set search filters to include timePeriod1\n      vm.searchFilters.timePeriod3 = true;\n      // make sure payzone is ticked\n      vm.timePeriod3Check = function() {\n        return true;\n      };\n    }\n\n    // after 6\n    if ($location.search().timePeriod4 === 'true') {\n      // open time of day filter\n      vm.filterButtons.time = !vm.filterButtons.time;\n      // set search filters to include timePeriod1\n      vm.searchFilters.timePeriod4 = true;\n      // make sure payzone is ticked\n      vm.timePeriod4Check = function() {\n        return true;\n      };\n    }\n\n    // filters\n    vm.hideModalFilter = function() {\n      vm.modalShownFilter = !vm.modalShownFilter;\n    };\n    vm.modalShownFilter = false;\n    function toggleModalFilter() {\n      vm.modalShownFilter = !vm.modalShownFilter;\n    }\n\n    // other matches and swift load more button\n    function loadMore() {\n      vm.limit += 6;\n      $location.search('limit', vm.limit);\n      vm.updateGrid();\n      vm.refreshOther();\n    }\n\n    // exact matches load more button\n    function loadMoreExact() {\n      vm.limitExact += 6;\n      $location.search('limitExact', vm.limitExact);\n      vm.updateGrid();\n      vm.refreshExact();\n    }\n\n    // refresh exact results grid\n    refreshExact.$inject = ['$timeout', 'angularGridInstance'];\n    function refreshExact() {\n      angular.element(document).ready(function() {\n        $timeout(function() {\n          angularGridInstance.origTicketResults.refresh();\n        }, 0);\n      });\n    }\n\n    // refresh other results grid\n    refreshOther.$inject = ['$timeout', 'angularGridInstance'];\n    function refreshOther() {\n      angular.element(document).ready(function() {\n        $timeout(function() {\n          angularGridInstance.ticketResults.refresh();\n        }, 0);\n      });\n    }\n\n    // toggle filter accordions\n    function toggleFilter(type) {\n      vm.filterButtons[type] = !vm.filterButtons[type];\n    }\n\n    // if pass is swift payg\n    function swiftPAYG() {\n      vm.passValue = vm.postJSON.brand;\n      if (vm.passValue === 'Swift PAYG') {\n        // console.log('swift payg');\n        vm.isHideCheck = !vm.isHideCheck;\n        vm.postJSON.passengerType = null;\n        vm.postJSON.timeBand = null;\n        vm.postJSON.stationNames = [];\n      } else if (\n        vm.passValue === 'nbus' ||\n        vm.passValue === 'National Express' ||\n        vm.passValue === 'Diamond Bus' ||\n        vm.passValue === 'Stagecoach' ||\n        vm.passValue === 'Swift PAYG' ||\n        vm.passValue === 'West Midlands Metro'\n      ) {\n        // Clear stationNames list if non-rail pass selected\n        vm.postJSON.stationNames = [];\n      }\n    }\n\n    // if pass is swift abt\n    function swiftABT() {\n      vm.passValue = vm.postJSON.brand;\n      if (vm.passValue === 'Swift Go') {\n        vm.isHideCheck = !vm.isHideCheck;\n        vm.postJSON.timeBand = null;\n        vm.postJSON.stationNames = [];\n      } else if (\n        vm.passValue === 'nbus' ||\n        vm.passValue === 'National Express' ||\n        vm.passValue === 'Diamond Bus' ||\n        vm.passValue === 'Stagecoach' ||\n        vm.passValue === 'Swift PAYG' ||\n        vm.passValue === 'West Midlands Metro'\n      ) {\n        // Clear stationNames list if non-rail pass selected\n        vm.postJSON.stationNames = [];\n      }\n    }\n\n    // if brand is ntrain out of county\n    function ntrainOOC() {\n      vm.passValue = vm.postJSON.brand;\n\n      if (vm.passValue === 'ntrain - Out of County') {\n        vm.isHideCheck = !vm.isHideCheck;\n        vm.stationFromReqOOC = true; // set from station to required\n        vm.stationToReqOOC = true; // set to station to required\n        vm.stationFromName = null;\n        vm.stationToName = null;\n        vm.stationViaOneName = null;\n      } else {\n        vm.stationFromReqOOC = false; // set from station to not required\n        vm.stationToReqOOC = false; // set to station to not required\n        if ($location.search().stationNames) {\n          // if station names in url assign station vars\n          stations = $location.search().stationNames;\n          stationSel = stations.toString();\n          stationSplit = stationSel.split(',');\n          vm.stationFromName = stationSplit['0'];\n          vm.stationToName = stationSplit['1'];\n          vm.stationViaOneName = stationSplit['2'];\n        }\n      }\n    }\n\n    // get tickets you can buy on swift\n    function getSwiftPAYG() {\n      ticketingService\n        .getSwiftSearch()\n        .then(function(response) {\n          vm.swiftPaygIds = [];\n\n          angular.forEach(response, function(item) {\n            if (item.swiftCurrentAmount) {\n              vm.swiftPaygIds.push(item);\n            }\n          });\n        })\n        .catch(function(error) {\n          vm.errorMessage = 'There was a problem loading Swift data. Please try again later.';\n          vm.loadingStatus = 'error';\n          console.error(error);\n        });\n    }\n\n    // if pass is swift abt\n    function selectPass() {\n      vm.passValue = vm.postJSON.brand;\n      if (vm.passValue === '') {\n        console.log('select pass');\n        vm.clearFilter();\n      }\n    }\n\n    // set current date to test for ticketFutureDate\n    vm.date = new Date();\n  }\n\n  // FILTERS\n\n  // filter to replace text\n  replace.$inject = [];\n  function replace() {\n    let regex;\n    return function(input, from, to) {\n      if (input === undefined) {\n        return;\n      }\n      regex = new RegExp(from, 'g');\n      return input.replace(regex, to);\n    };\n  }\n})();\n"]}