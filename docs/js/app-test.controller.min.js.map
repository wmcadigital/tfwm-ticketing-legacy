{"version":3,"sources":["ticket.controller.js","tickets.controller.js"],"names":["TicketDetailCtrl","ticketingService","$interval","getURL","$routeParams","$scope","$timeout","deviceDetector","$location","$window","vm","this","data","widthView","innerWidth","includeMobileTemplate","includeDesktopTemplate","loadingText","loadingStatus","loadingArray","loading","Math","round","random","length","ticketID","ticket","filterAccordions","relatedTickets","priceLevelsList","toggleClick","type","modalShown","toggleModal","toggleModalBus","modalShownBus","toggleModalTrain","modalShownTrain","toggleModalSwift","modalShownSwift","toggleModalGPay","modalShownGpay","operatorList","limit","deviceDetect","userAgent","raw","includes","oneApp","android","openFilters","document","getElementById","style","display","closeFilters","date","Date","gpay","searchLocation","host","isIframed","checkIfIframed","window","self","top","isEmbeddedApp","checkIfEmbeddedApp","ua","navigator","vendor","opera","isIOSWebView","test","MSStream","webkit","messageHandlers","isAndroidWebView","location","href","getTicket","then","response","all","related","angular","forEach","item","id","relatedList","push","catch","error","errorMessage","console","documents","getTerms","terms","relatedTerms","getOperators","operator","setTicketFinder","name","buyTicketUrl","queryString","split","baseUrl","matrixid","replace","backToSearch","stationFromNameZone","getTicketFull","full","priceLevels","map","initialiseFull","element","bind","removeHTMLTags","text","String","escapeFilter","module","controller","filter","html","directive","restrict","scope","show","transclude","link","attrs","dialogStyle","width","height","modalclass","class","hideModal","template","panes","select","pane","selected","addPane","panel","require","title","tabsCtrl","isShown","showHover","ctrl","copy","tooltipc","$apply","$inject","$exceptionHandler","$log","exception","log","Sentry","captureException","TicketingSearchCtrl","ngAuthSettings","$anchorScroll","$filter","savedFilter","angularGridInstance","$httpParamSerializer","stations","stationSel","stationSplit","apiTimeoutPromise","retryIntervalPromise","defaultVars","filteredTickets","origTickets","otherTickets","stationList","stationoocList","stationicList","swiftPaygIds","swiftPaygloadingStatus","passValue","orderBy","parseInt","search","limitExact","postJSON","allowBus","allowMetro","allowTrain","passengerType","timeBand","brand","stationNames","stationFromName","stationToName","stationFromTitle","stationToTitle","stationFromNameOocZ5","stationToNameOocZ5","fromStationInfo","eligibilityDate","excludebusParameter","excludeBus","buyOnDirectDebitParameter","buyOnDirectDebit","buyOnDirectPurchaseParameter","buyOnDirectPurchase","buyOnSwiftParameter","buyOnSwift","hasOnlinePurchaseChannelParameter","hasOnlinePurchaseChannel","purchaseTicParameter","purchaseTic","purchaseRailStationParameter","purchaseRailStation","purchasePayzoneParameter","purchasePayzone","busTravelAreaParameter","busTravelArea","operatorParameter","railZoneFromParameter","railZoneFrom","railZoneToParameter","railZoneTo","timePeriodAnytimeParameter","timePeriodAll","timePeriod1Parameter","timePeriod1","timePeriod2Parameter","timePeriod2","timePeriod3Parameter","timePeriod3","timePeriod4Parameter","timePeriod4","clearModes","postedJSON","stationFromReq","stationToReq","stationToReqtwo","stationFromOOCReq","fromZoneNumber","toZoneNumber","subtractYears","dates","years","dateCopy","setFullYear","getFullYear","submit","clearFilter","url","excludeBusCheck","excludeTrainCheck","excludeTramCheck","buyOnDirectDebitCheck","buyOnDirectPurchaseCheck","buyOnSwiftCheck","hasOnlinePurchaseChannelCheck","purchaseTicCheck","purchaseRailStationCheck","purchasePayzoneCheck","timePeriod1CheckAll","timePeriod1Check","timePeriod2Check","timePeriod3Check","timePeriod4Check","set","clearFromStation","clearToStation","clearViaOneStation","getStations","fromRail","toRail","ViaOneRail","dataFromRail","dataToRail","dataViaOnRail","dataFromRailData","dataToRailData","dataViaOneRailData","stationViaOneName","toStationInfo","ViaOneStationInfo","zone","ViaOneZoneNumber","getoocStations","OutOfCounty","outOfCounty","geticStations","inCounty","clearStation","clearTime","searchFilters","update","checkTimeAll","checkTime","getSwiftPAYG","updateGrid","filtered","filteredorg","exactMatch","filteredother","otherResults","val","key","indexOf","sort","a","b","sortPop","sortPlw","sortPhl","ticketCurrentAmount","loadMore","refreshOther","loadMoreExact","refreshExact","filterButtons","operatorLength","toggleFilter","swiftPAYG","swiftABT","ntrainOOC","isHideCheck","stationFromReqOOC","stationToReqOOC","toString","toggleModalFilter","modalShownFilter","os","isMobile","selectPass","slug","currentDate","year","newDate","fbus","ftrain","fmetro","i","j","arrlen","bus","train","metro","searchAll","searchExact","captureMessage","level","extra","absUrl","errors","undefined","origFilters","ticketSearch","cancel","original","items","swiftCurrentAmount","baseUrl2","paygUrl","fromStationInfoZone","toStationInfoZone","ffromzone","ftozone","fViaOnezone","slice","concat","hash","retryTicketSearch","searchURL","urlstring","abus","atrain","ametro","atime","obj","$broadcast","fromStationText","toStationText","viaOneStationText","ready","origTicketResults","refresh","ticketResults","getSwiftSearch","showDetails","fromEmpty","fromStationInputChanged","str","fromfocusState","fromFocusIn","fromFocusOut","stationFrom","originalObject","stationFromNameOoc","zone5InCounty","toEmpty","toStationInputChanged","tofocusState","toFocusIn","toFocusOut","stationTo","stationToNameZone","stationToNameOoc","viaOneStationInputChanged","viaOnefocusState","stationViaOneFocusIn","stationViaOneFocusOut","stationviaOneReq","stationViaOneReq","stationViaOne","stationViaOneTitle","stationViaOneNameZone","stationViaOneNameOoc","stationViaOneNameOocZ5","ViaOneStationInfoZone","stationVia","mode","payment","busTravelAreaBtn","operatorBtn","railZoneBtn","timeLimited","time","hideModalFilter","regex","input","from","to","RegExp","factory"],"mappings":"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","file":"app-test.controller.min.js","sourcesContent":["/* eslint-disable angular/window-service */\n(function() {\n  'use strict';\n\n  angular\n    .module('ticketingApp')\n    .controller('TicketDetailCtrl', TicketDetailCtrl)\n    .filter('removeHTMLTags', removeHTMLTags)\n    .filter('escapeFilter', escapeFilter)\n    .filter('openLinksNewWindow', openLinksNewWindow)\n    .directive('modalDialog', modalDialog)\n    .directive('tabs', tabs)\n    .directive('pane', pane)\n    .directive('tooltip', tooltip);\n\n  TicketDetailCtrl.$inject = [\n    'ticketingService',\n    '$interval',\n    'getURL',\n    '$routeParams',\n    '$scope',\n    '$timeout',\n    'deviceDetector',\n    '$location',\n    '$window'\n  ];\n\n  function TicketDetailCtrl(\n    ticketingService,\n    $interval,\n    getURL,\n    $routeParams,\n    $scope,\n    $timeout,\n    deviceDetector,\n    $location,\n    $window\n  ) {\n    const vm = this;\n    vm.loadingText = 'Loading...'; // default loading text\n    vm.loadingStatus = 'loading'; // default loading status\n    vm.loadingArray = 'Loading...'; // loading messages\n    vm.loading = $interval(function() {\n      vm.loadingText = vm.loadingArray[Math.round(Math.random() * (vm.loadingArray.length - 1))];\n    }, 3500); // show random loading message based on milliseconds set\n    vm.ticketID = $routeParams.ticket; // set Ticket ID to URL parameter\n    vm.filterAccordions = {};\n    vm.relatedTickets = {};\n    vm.priceLevelsList = {};\n    vm.toggleClick = toggleClick;\n    vm.modalShown = false;\n    vm.toggleModal = toggleModal;\n    vm.toggleModalBus = toggleModalBus;\n    vm.toggleModalTrain = toggleModalTrain;\n    vm.toggleModalSwift = toggleModalSwift;\n    vm.toggleModalGPay = toggleModalGPay;\n    vm.widthView = widthView; // Check width of page\n    vm.operatorList = []; // Define Operator list\n    vm.limit = 4; // Set paging limit for Alt tickets\n    vm.deviceDetect = deviceDetect; // Function to detect device\n    vm.openFilters = openFilters;\n    vm.closeFilters = closeFilters;\n    vm.date = new Date();\n    vm.gpay = false; // Default value for GPay products\n    vm.searchLocation = $location.host(); // Set the current host\n    vm.isIframed = false;\n    vm.checkIfIframed = checkIfIframed;\n    vm.isEmbeddedApp = false;\n    vm.checkIfEmbeddedApp = checkIfEmbeddedApp;\n\n    // Redirects\n\n    if (\n      vm.ticketID === '630001' ||\n      vm.ticketID === '443' ||\n      vm.ticketID === '382' ||\n      vm.ticketID === '385' ||\n      vm.ticketID === '383' ||\n      vm.ticketID === '383002' ||\n      vm.ticketID === '382001'\n    ) {\n      $window.location.href = 'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/ticket/63';\n    }\n\n    if (\n      vm.ticketID === '650001' ||\n      vm.ticketID === '379001' ||\n      vm.ticketID === '442010' ||\n      vm.ticketID === '442009' ||\n      vm.ticketID === '442005' ||\n      vm.ticketID === '442006' ||\n      vm.ticketID === '442001' ||\n      vm.ticketID === '442002'\n    ) {\n      $window.location.href = 'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/ticket/65';\n    }\n\n    if (\n      vm.ticketID === '640001' ||\n      vm.ticketID === '651' ||\n      vm.ticketID === '664' ||\n      vm.ticketID === '665' ||\n      vm.ticketID === '439' ||\n      vm.ticketID === '389' ||\n      vm.ticketID === '393' ||\n      vm.ticketID === '422' ||\n      vm.ticketID === '427' ||\n      vm.ticketID === '428' ||\n      vm.ticketID === '418' ||\n      vm.ticketID === '419'\n    ) {\n      $window.location.href = 'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/ticket/45';\n    }\n\n    if (vm.ticketID === '640002') {\n      $window.location.href = 'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/ticket/48';\n    }\n\n    if (\n      vm.ticketID === '656' ||\n      vm.ticketID === '667' ||\n      vm.ticketID === '668' ||\n      vm.ticketID === '397' ||\n      vm.ticketID === '424' ||\n      vm.ticketID === '429' ||\n      vm.ticketID === '433' ||\n      vm.ticketID === '432'\n    ) {\n      $window.location.href = 'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/ticket/50';\n    }\n\n    if (vm.ticketID === '611' || vm.ticketID === '658' || vm.ticketID === '441') {\n      $window.location.href = 'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/ticket/57';\n    }\n\n    if (vm.ticketID === '640003') {\n      $window.location.href = 'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/ticket/652';\n    }\n\n    if (\n      vm.ticketID === '660021' ||\n      vm.ticketID === '660022' ||\n      vm.ticketID === '660030' ||\n      vm.ticketID === '660026' ||\n      vm.ticketID === '660016' ||\n      vm.ticketID === '553010' ||\n      vm.ticketID === '553011' ||\n      vm.ticketID === '553012'\n    ) {\n      $window.location.href = 'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/ticket/660029';\n    }\n\n    if (\n      vm.ticketID === '874' ||\n      vm.ticketID === '873' ||\n      vm.ticketID === '384' ||\n      vm.ticketID === '386' ||\n      vm.ticketID === '878' ||\n      vm.ticketID === '877' ||\n      vm.ticketID === '445'\n    ) {\n      $window.location.href = 'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/ticket/64';\n    }\n\n    if (\n      vm.ticketID === '676' ||\n      vm.ticketID === '677' ||\n      vm.ticketID === '442015' ||\n      vm.ticketID === '865' ||\n      vm.ticketID === '866'\n    ) {\n      $window.location.href = 'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/ticket/46';\n    }\n\n    if (vm.ticketID === '444' || vm.ticketID === '604') {\n      $window.location.href = 'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/ticket/630005';\n    }\n\n    if (vm.ticketID === '442014' || vm.ticketID === '442011') {\n      $window.location.href = 'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/ticket/58';\n    }\n\n    if (vm.ticketID === '602') {\n      $window.location.href =\n        'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/?allowBus&passengerType=Student&timeBand=Longer%20than%20a%20month&limit=6&limitExact=6#sbmBtn';\n    }\n\n    if (vm.ticketID === '714' || vm.ticketID === '718') {\n      $window.location.href = 'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/ticket/630002';\n    }\n\n    if (vm.ticketID === '715' || vm.ticketID === '719') {\n      $window.location.href = 'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/ticket/630003';\n    }\n\n    if (vm.ticketID === '394' || vm.ticketID === '395' || vm.ticketID === '396') {\n      $window.location.href = 'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/ticket/391';\n    }\n\n    if (vm.ticketID === '413' || vm.ticketID === '426' || vm.ticketID === '431') {\n      $window.location.href = 'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/ticket/59';\n    }\n\n    if (vm.ticketID === '399') {\n      $window.location.href = 'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/ticket/555';\n    }\n\n    if (vm.ticketID === '415') {\n      $window.location.href = 'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/ticket/557';\n    }\n\n    if (\n      vm.ticketID === '442010' ||\n      vm.ticketID === '442009' ||\n      vm.ticketID === '442005' ||\n      vm.ticketID === '442006' ||\n      vm.ticketID === '442001' ||\n      vm.ticketID === '442002'\n    ) {\n      $window.location.href = 'https://wmcadigital.github.io/tfwm-ticketing-legacy//#/';\n    }\n\n    function checkIfIframed() {\n      // Returns true if the app is running inside an iframe\n      vm.isIframed = window.self !== window.top;\n      return vm.isIframed;\n    }\n\n    function checkIfEmbeddedApp() {\n      // Checks if the app is running inside an iOS or Android app WebView\n      const ua = navigator.userAgent || navigator.vendor || window.opera;\n      // Common patterns for iOS/Android WebViews\n      const isIOSWebView =\n        /iPhone|iPad|iPod/.test(ua) &&\n        !window.MSStream &&\n        window.webkit &&\n        window.webkit.messageHandlers;\n      const isAndroidWebView =\n        (/Android/.test(ua) && /wv/.test(ua)) ||\n        /Android.*Version\\/[\\d.]+.*Chrome\\/[\\d.]+ Mobile/.test(ua);\n\n      vm.isEmbeddedApp = isIOSWebView || isAndroidWebView;\n      return vm.isEmbeddedApp;\n    }\n\n    vm.checkIfEmbeddedApp();\n\n    // Function to get the ticket data with api call\n    function initialise(data) {\n      ticketingService\n        .getTicket(data)\n        .then(function(response) {\n          vm.all = response;\n          if (vm.all.relatedTickets.length) {\n            vm.related = [];\n            angular.forEach(\n              vm.all.relatedTickets,\n              function(item) {\n                ticketingService\n                  .getTicket(item.id)\n                  .then(function(related) {\n                    vm.relatedTickets[item.id] = related;\n                    vm.relatedList = vm.relatedTickets[item.id];\n                    // push items into a single array\n                    vm.related.push(vm.relatedList);\n                  })\n                  .catch(function(error) {\n                    vm.errorMessage =\n                      'There was a problem loading ticket data. Please try again later.';\n                    vm.loadingStatus = 'error';\n                    console.error(error);\n                  });\n              },\n              vm.related\n            );\n          }\n          if (vm.all.documents.length) {\n            ticketingService\n              .getTerms(data)\n              .then(function(terms) {\n                vm.relatedTerms = terms;\n              })\n              .catch(function(error) {\n                vm.errorMessage =\n                  'There was a problem loading terms and conditions data. Please try again later.';\n                vm.loadingStatus = 'error';\n                console.error(error);\n              });\n          }\n          ticketingService\n            .getOperators()\n            .then(function(operator) {\n              vm.operatorList = operator;\n              // console.log(response);\n            })\n            .catch(function(error) {\n              vm.errorMessage =\n                'There was a problem loading operator data. Please try again later.';\n              vm.loadingStatus = 'error';\n              console.error(error);\n            });\n\n          if (window?.setTicketFinder?.name.includes('Unicard Desktop Production')) {\n            // console.log('Unicard app detected (Production)');\n            if (!vm.all.buyTicketUrl.includes('ticketing.networkwestmidlands.com')) {\n              // eslint-disable-next-line no-unused-vars\n              const [host, queryString] = vm.all.buyTicketUrl.split('?');\n              vm.all.buyTicketUrl =\n                'https://my.swiftcard.org.uk/ssp/swift/dnr_importBasket.jsp?' + queryString;\n            }\n          }\n\n          if (window?.setTicketFinder?.name.includes('Unicard Desktop Test')) {\n            // console.log('Unicard app detected (Test)');\n            if (!vm.all.buyTicketUrl.includes('ticketing.cenapps.org.uk')) {\n              // eslint-disable-next-line no-unused-vars\n              const [host, queryString] = vm.all.buyTicketUrl.split('?');\n              vm.all.buyTicketUrl =\n                'https://natex-ssp.unicard-uk.com/ssp/swift/dnr_importBasket.jsp?' + queryString;\n            }\n          }\n\n          // console.log('Buy ticket URL: ' + vm.all.buyTicketUrl);\n\n          // Check if the buy ticket url is a smartcitizen ticket finder and format it differently\n          if (\n            vm.all.buyTicketUrl &&\n            vm.all.buyTicketUrl.includes('matrixId') &&\n            window?.setTicketFinder?.name.includes('Smart Citizen')\n          ) {\n            let baseUrl = '';\n            if (window?.setTicketFinder?.name.includes('Smart Citizen Mobile Production')) {\n              baseUrl = 'https://m-public-tfwm.smartcitizen.net';\n            } else if (window?.setTicketFinder?.name.includes('Smart Citizen Desktop Production')) {\n              baseUrl = 'https://public-tfwm.smartcitizen.net';\n            } else if (window?.setTicketFinder?.name.includes('Smart Citizen Mobile Test')) {\n              baseUrl = 'https://m-public-tfwmtest.smartcitizen.net';\n            } else if (window?.setTicketFinder?.name.includes('Smart Citizen Production')) {\n              baseUrl = 'https://public-tfwm.smartcitizen.net';\n            } else if (window?.setTicketFinder?.name.includes('Smart Citizen Test')) {\n              baseUrl = 'https://public-tfwmtest.smartcitizen.net';\n            } else if (window?.setTicketFinder?.name.includes('Smart Citizen Desktop Test')) {\n              baseUrl = 'https://public-tfwmtest.smartcitizen.net';\n            } else if (window?.setTicketFinder?.name.includes('Smart Citizen Dev')) {\n              baseUrl = 'https://public-tfwmdev.smartcitizen.net';\n            }\n            // console.log('baseurl: ' + baseUrl);\n            // eslint-disable-next-line no-unused-vars\n            const [host, queryString] = vm.all.buyTicketUrl.split('?');\n            const matrixid = queryString\n              .replace('https://', '')\n              // eslint-disable-next-line no-useless-escape\n              .replace(/[\\[\\]]/g, '')\n              .replace(/[{}]/g, '')\n              .replace(/:/g, '=')\n              .replace(/'/g, '');\n            vm.all.buyTicketUrl = baseUrl + '?' + matrixid;\n          }\n          // console.log('Final: ' + vm.all.buyTicketUrl);\n\n          backButtonLogic(); // Determine back button logic\n          vm.loadingStatus = 'success'; // set success loading status\n        })\n        .catch(function(error) {\n          vm.errorMessage = 'There was a problem loading ticket data. Please try again later.';\n          vm.loadingStatus = 'error';\n          console.error(error);\n        });\n    }\n\n    // detect device in use\n    vm.deviceDetect();\n    function deviceDetect() {\n      vm.deviceDetector = deviceDetector;\n      vm.userAgent = deviceDetector.raw.userAgent;\n      // check if userAgent is Swift One app\n      if (vm.userAgent.includes('SwiftOneApp')) {\n        vm.oneApp = true;\n      } else {\n        vm.oneApp = false;\n      }\n      if (vm.userAgent.includes('android')) {\n        vm.android = true;\n      } else {\n        vm.android = false;\n      }\n    }\n\n    function openFilters() {\n      document.getElementById('filterOverlay').style.display = 'block';\n    }\n\n    function closeFilters() {\n      document.getElementById('filterOverlay').style.display = 'none';\n    }\n\n    function backButtonLogic() {\n      vm.backToSearch = getURL; // use session storage\n      // console.log(vm.backToSearch);\n      vm.stationFromNameZone = '1';\n    }\n\n    initialise(vm.ticketID); // initialise API to get ticket\n    initialiseFull(vm.ticketID); // initialise API to get ticket\n\n    function toggleClick(type) {\n      vm.filterAccordions[type] = !vm.filterAccordions[type];\n    }\n\n    function initialiseFull(data) {\n      ticketingService\n        .getTicketFull(data)\n        .then(function(response) {\n          vm.full = response;\n          vm.priceLevels = response.priceLevels;\n          vm.gpay = false;\n          vm.priceLevelsList = vm.priceLevels.map(function(item) {\n            if (item.type.includes('Google Pay')) {\n              vm.gpay = true;\n              return true;\n            }\n            return false;\n          });\n        })\n        .catch(function(error) {\n          vm.errorMessage = 'There was a problem loading ticket data. Please try again later.';\n          vm.loadingStatus = 'error';\n          console.error(error);\n        });\n    }\n\n    // popup modals\n\n    // bus\n    vm.modalShownBus = false;\n    function toggleModalBus() {\n      vm.modalShownBus = !vm.modalShownBus;\n    }\n\n    // train\n    vm.modalShownTrain = false;\n    function toggleModalTrain() {\n      vm.modalShownTrain = !vm.modalShownTrain;\n    }\n\n    // general\n    vm.modalShown = false; // hide modal on page load\n    function toggleModal() {\n      vm.modalShown = !vm.modalShown;\n    }\n\n    // swift\n    vm.modalShownSwift = false;\n    function toggleModalSwift() {\n      vm.modalShownSwift = !vm.modalShownSwift;\n    }\n\n    // google pay\n    vm.modalShownGpay = false;\n    function toggleModalGPay() {\n      vm.modalShownGpay = !vm.modalShownGpay;\n    }\n\n    // check resolution so the where can i use view is not shown twice\n    vm.includeDesktopTemplate = false;\n    vm.includeMobileTemplate = false;\n    widthView();\n    function widthView() {\n      const screenWidth = $window.innerWidth;\n\n      if (screenWidth < 890) {\n        vm.includeMobileTemplate = true;\n        vm.includeDesktopTemplate = false;\n      } else {\n        vm.includeMobileTemplate = false;\n        vm.includeDesktopTemplate = true;\n      }\n    }\n\n    // ensure where can i use view is reloaded when page resolution goes below 890px\n    const appWindow = angular.element($window);\n    appWindow.bind('resize', function() {\n      widthView();\n    });\n  }\n\n  // FILTERS\n  removeHTMLTags.$inject = [];\n  function removeHTMLTags() {\n    return function(text) {\n      return text ? String(text).replace(/<[^>]+>/gm, '') : '';\n    };\n  }\n\n  // escape filter for ticket t&c's\n  escapeFilter.$inject = [];\n  function escapeFilter() {\n    return function(text) {\n      return text ? String(text).replace(/\\n/gm, '<br><br>') : '';\n    };\n  }\n\n  function openLinksNewWindow() {\n    return function(html) {\n      if (!html) return '';\n      // Add target=\"_blank\" to all <a> tags that don't already have it\n      return String(html).replace(/<a\\s(?![^>]*target=)/gi, '<a target=\"_blank\" ');\n    };\n  }\n\n  // DIRECTIVES\n\n  function modalDialog() {\n    return {\n      restrict: 'E',\n      scope: {\n        show: '='\n      },\n      replace: true, // Replace with the template below\n      transclude: true, // we want to insert custom content inside the directive\n      link: function(scope, element, attrs) {\n        scope.dialogStyle = {};\n        if (attrs.width) scope.dialogStyle.width = attrs.width;\n        if (attrs.height) scope.dialogStyle.height = attrs.height;\n        if (attrs.modalclass) scope.dialogStyle.class = attrs.modalclass;\n        scope.hideModal = function() {\n          scope.show = false;\n        };\n      },\n      template:\n        '<div ng-show=\"show\" class=\"mod\">' +\n        '<div ng-show=\"show\" class=\"modal\" ng-click=\"hideModal()\"></div>' +\n        '<div class=\"overlay modal-content {{dialogStyle.class}}\" ng-style=\"dialogStyle\">' +\n        '<div class=\"ng-modal-close modal__close js-modal-close\" ng-click=\"hideModal()\">X</div>' +\n        '<div class=\"ng-modal-dialog-content\" ng-transclude></div>' +\n        '</div>' +\n        '</div>'\n    };\n  }\n\n  function tabs() {\n    return {\n      restrict: 'E',\n      transclude: true,\n      scope: {},\n      controller: [\n        '$scope',\n        function($scope) {\n          // eslint-disable-next-line no-multi-assign\n          const panes = ($scope.panes = []);\n\n          // eslint-disable-next-line no-shadow\n          $scope.select = function(pane) {\n            // eslint-disable-next-line no-shadow\n            angular.forEach(panes, function(pane) {\n              pane.selected = false;\n            });\n            pane.selected = true;\n          };\n\n          this.addPane = function(panel) {\n            if (panes.length === 0) $scope.select(panel);\n            panes.push(panel);\n          };\n        }\n      ],\n      template:\n        '<div class=\"cfx\">' +\n        '<div class=\"arrdep-filters__toggle\">' +\n        '<div class=\"radio-bar\">' +\n        '<span ng-repeat=\"pane in panes\" ng-class=\"{active:pane.selected}\">' +\n        '<input name=\"option\" id=\"{{pane.title}}\" type=\"radio\">' +\n        '<label ng-click=\"select(pane)\" for=\"{{pane.title}}\" style=\"height: 44px;\">{{pane.title}}</label>' +\n        '</span>' +\n        '</div>' +\n        '</div>' +\n        '<div class=\"tab-content\" ng-transclude></div>' +\n        '</div>',\n      replace: true\n    };\n  }\n\n  function pane() {\n    return {\n      require: '^tabs',\n      restrict: 'E',\n      transclude: true,\n      scope: { title: '@' },\n      link: function(scope, element, attrs, tabsCtrl) {\n        tabsCtrl.addPane(scope);\n      },\n      template: '<div class=\"tab-pane\" ng-class=\"{active: selected}\" ng-transclude></div>',\n      replace: true\n    };\n  }\n\n  function tooltip() {\n    return {\n      restrict: 'A',\n      controller: [\n        '$scope',\n        function($scope) {\n          $scope.isShown = false;\n          this.showHover = function() {\n            $scope.isShown = $scope.isShown !== true;\n          };\n        }\n      ],\n      transclude: true,\n      link: function(scope, element, attrs, ctrl) {\n        scope.copy = attrs.tooltipc;\n        element.bind('click', function() {\n          scope.$apply(function() {\n            ctrl.showHover();\n          });\n        });\n      },\n      template:\n        '<div ng-transclude></div>' +\n        '<p class=\"field-help tooltip\" ng-show=\"isShown\">' +\n        '<span class=\"close modal__close\"></span>' +\n        '<span data-ng-bind-html=\"copy\"></span>' +\n        '</p>'\n    };\n  }\n})();\n","/* eslint-disable angular/window-service */\n/* eslint-disable no-useless-escape */\n(function() {\n  'use strict';\n\n  angular\n    .module('ticketingApp')\n    .factory('$exceptionHandler', $exceptionHandler)\n    .controller('TicketingSearchCtrl', TicketingSearchCtrl)\n    .filter('replace', replace);\n\n  $exceptionHandler.$inject = ['$log', '$window'];\n  function $exceptionHandler($log, $window) {\n    return function(exception) {\n      console.log('Exception caught by $exceptionHandler:');\n      $log.error(exception);\n      if ($window.Sentry && $window.Sentry.captureException) {\n        $window.Sentry.captureException(exception);\n      }\n    };\n  }\n\n  TicketingSearchCtrl.$inject = [\n    'ngAuthSettings',\n    '$scope',\n    '$interval',\n    '$anchorScroll',\n    '$timeout',\n    '$filter',\n    '$location',\n    'savedFilter',\n    'ticketingService',\n    'angularGridInstance',\n    '$httpParamSerializer',\n    'deviceDetector'\n  ];\n\n  function TicketingSearchCtrl(\n    ngAuthSettings,\n    $scope,\n    $interval,\n    $anchorScroll,\n    $timeout,\n    $filter,\n    $location,\n    savedFilter,\n    ticketingService,\n    angularGridInstance,\n    $httpParamSerializer,\n    deviceDetector\n  ) {\n    const vm = this;\n    let stations;\n    let stationSel;\n    let stationSplit;\n    let apiTimeoutPromise = null;\n    let retryIntervalPromise = null;\n    vm.submit = submit; // Function to submit initial search\n    vm.clearFilter = clearFilter; // Function to reset filters\n    vm.getStations = getStations; // Function to retrieve stations\n    vm.getoocStations = getoocStations; // Function to retrieve out of county stations\n    vm.geticStations = geticStations; // Function to retrieve in county stations\n    vm.clearFromStation = clearFromStation; // Function to clear from station\n    vm.clearToStation = clearToStation; // Function to clear to station\n    vm.clearViaOneStation = clearViaOneStation; // Function to clear via one station\n    vm.clearStation = clearStation; // Function to clear to from station if not in url - []\n    vm.clearTime = clearTime; // Function to clear time selection\n    vm.checkTimeAll = checkTimeAll; // Function to check time checkboxes\n    vm.checkTime = checkTime; // Function to check time checkboxes\n    vm.getSwiftPAYG = getSwiftPAYG; // Function to retrieve stations\n    vm.updateGrid = updateGrid; // Function to update results grid\n    vm.update = update; // Do filtering logic in controller so sessions can be stored\n    vm.loadMore = loadMore; // function to load more results\n    vm.loadMoreExact = loadMoreExact; // function to load more exact results\n    vm.refreshExact = refreshExact; // function to refresh the exact results grid\n    vm.refreshOther = refreshOther; // function to refresh the other results grid\n    vm.filterButtons = {\n      operator: [],\n      operatorLength: 0,\n      busTravelArea: [],\n      railZoneFrom: [],\n      railZoneTo: []\n    }; // set an object for the filters show/hide toggle to fall into\n    vm.toggleFilter = toggleFilter;\n    vm.swiftPAYG = swiftPAYG; // Function for hiding fields if Swift PAYG is selected\n    vm.swiftABT = swiftABT; // Function for hiding fields if Swift ABT is selected\n    vm.ntrainOOC = ntrainOOC; // Function for setting out of county tickets\n    vm.toggleModalFilter = toggleModalFilter;\n    vm.searchLocation = $location.host(); // Set the current host\n    vm.deviceDetect = deviceDetect; // Function to detect device\n    vm.selectPass = selectPass; // Function to reset filters if select your pass is selected\n    // Set up the default Vars on page load, and so that they can be reset with 'reset filters' button\n    function defaultVars() {\n      vm.all = []; // Set results to blank array\n      vm.filteredTickets = []; // Define filtered results as blank array\n      vm.origTickets = []; // Define original filtered results as blank array\n      vm.otherTickets = []; // Define other filtered results as blank array\n      vm.stationList = []; // Define Station list\n      vm.stationoocList = []; // Define out of county Station list\n      vm.stationicList = []; // Define in county Station list\n      vm.swiftPaygIds = []; // Define Swift PAYG tickets\n      vm.loadingStatus = ''; // Set results status to blank\n      vm.swiftPaygloadingStatus = ''; // Set results status to blank\n      vm.passValue = ''; // Set pass select value to blank\n      vm.orderBy = 'orderSequence';\n      vm.limit = parseInt($location.search().limit) || 6; // Set paging limit to what's in url or default to 6\n      vm.limitExact = parseInt($location.search().limitExact) || 6; // Set paging limit for exact results to what's in url or default to 6\n      vm.postJSON = {\n        allowBus: $location.search().allowBus || null,\n        allowMetro: $location.search().allowMetro || null,\n        allowTrain: $location.search().allowTrain || null,\n        passengerType: $location.search().passengerType || '',\n        timeBand: $location.search().timeBand || '',\n        brand: $location.search().brand || null,\n        stationNames: $location.search().stationNames || null\n      }; // Define postJSON default values\n      vm.stationFromName = null; // Clear Stations\n      vm.stationToName = null;\n      vm.stationFromTitle = null;\n      vm.stationToTitle = null;\n      vm.stationFromNameOocZ5 = null;\n      vm.stationToNameOocZ5 = null;\n      // vm.openFilters = openFilters;\n      // vm.closeFilters = closeFilters;\n      vm.fromStationInfo = null;\n      vm.eligibilityDate = null;\n\n      // url parameters\n      // exclude bus\n      vm.excludebusParameter = $location.search().excludeBus || null;\n\n      // direct debit\n      vm.buyOnDirectDebitParameter = $location.search().buyOnDirectDebit || null;\n\n      // quick buy\n      vm.buyOnDirectPurchaseParameter = $location.search().buyOnDirectPurchase || null;\n\n      // swift\n      vm.buyOnSwiftParameter = $location.search().buyOnSwift || null;\n\n      // buy online\n      vm.hasOnlinePurchaseChannelParameter = $location.search().hasOnlinePurchaseChannel || null;\n\n      // tic\n      vm.purchaseTicParameter = $location.search().purchaseTic || null;\n\n      // rail station\n      vm.purchaseRailStationParameter = $location.search().purchaseRailStation || null;\n\n      // payzone\n      vm.purchasePayzoneParameter = $location.search().purchasePayzone || null;\n\n      // bus travel area\n      vm.busTravelAreaParameter = $location.search().busTravelArea || null;\n\n      // bus operator\n      vm.operatorParameter = $location.search().operator || null;\n\n      // rail from zone\n      vm.railZoneFromParameter = $location.search().railZoneFrom || null;\n\n      // rail to zone\n      vm.railZoneToParameter = $location.search().railZoneTo || null;\n\n      // anytime\n      vm.timePeriodAnytimeParameter = $location.search().timePeriodAll || null;\n\n      // pre 9.30\n      vm.timePeriod1Parameter = $location.search().timePeriod1 || null;\n\n      // 9.30 - 3.30\n      vm.timePeriod2Parameter = $location.search().timePeriod2 || null;\n\n      // 3.30 - 6\n      vm.timePeriod3Parameter = $location.search().timePeriod3 || null;\n\n      // after 6\n      vm.timePeriod4Parameter = $location.search().timePeriod4 || null;\n\n      vm.clearModes = clearModes;\n      vm.postedJSON = {}; // Define the object to hold the initial search criteria\n\n      vm.stationFromReq = false; // set from station to not required\n      vm.stationToReq = false; // set from station to not required\n      vm.stationToReqtwo = false;\n      vm.stationFromOOCReq = true; // if Train OOC pass selected make station required\n      vm.timePeriodAll = true;\n      vm.fromZoneNumber = null;\n      vm.toZoneNumber = null;\n    }\n    vm.isEmbeddedApp = false;\n    vm.checkIfEmbeddedApp = checkIfEmbeddedApp;\n\n    defaultVars();\n\n    vm.slug = 'testing789';\n\n    console.log('v2.16.5');\n\n    function checkIfEmbeddedApp() {\n      // Checks if the app is running inside an iOS or Android app WebView\n      const ua = navigator.userAgent || navigator.vendor || window.opera;\n      // Common patterns for iOS/Android WebViews\n      const isIOSWebView =\n        /iPhone|iPad|iPod/.test(ua) &&\n        !window.MSStream &&\n        window.webkit &&\n        window.webkit.messageHandlers;\n      const isAndroidWebView =\n        (/Android/.test(ua) && /wv/.test(ua)) ||\n        /Android.*Version\\/[\\d.]+.*Chrome\\/[\\d.]+ Mobile/.test(ua);\n\n      vm.isEmbeddedApp = isIOSWebView || isAndroidWebView;\n      return vm.isEmbeddedApp;\n    }\n\n    vm.checkIfEmbeddedApp();\n\n    // work out 16-18 elibility year\n    function subtractYears(dates, years) {\n      //  make copy with \"Date\" constructor\n      const dateCopy = new Date(dates);\n      dateCopy.setFullYear(date.getFullYear() - years);\n      return dateCopy;\n    }\n\n    const currentDate = new Date();\n    const year = currentDate.getFullYear();\n\n    const date = new Date(`${year}-09-01T00:00:00.000Z`);\n    let newDate = subtractYears(date, 18);\n\n    if (currentDate > date) {\n      newDate = subtractYears(date, 18);\n    } else {\n      newDate = subtractYears(date, 19);\n    }\n\n    vm.eligibilityDate = newDate.getFullYear();\n\n    // If location.search contains search criteria force the submit on page load\n    if (\n      $location.search().allowBus ||\n      $location.search().allowMetro ||\n      $location.search().allowTrain ||\n      ($location.search().brand &&\n        $location.search().passengerType &&\n        $location.search().timeBand) ||\n      $location.search().busTravelArea ||\n      $location.search().operator ||\n      $location.search().stationNames ||\n      $location.search().brand\n    ) {\n      vm.clearStation();\n      // Set initial value of from & to stations if in Url\n      if (\n        ($location.search().stationNames && vm.postJSON.allowTrain === true) ||\n        vm.postJSON.brand === 'nnetwork' ||\n        vm.postJSON.brand === 'ntrain'\n      ) {\n        if ($location.search().stationNames) {\n          stations = $location.search().stationNames;\n          stationSel = stations.toString();\n          stationSplit = stationSel.split(',');\n          vm.stationFromName = stationSplit['0'];\n          vm.stationToName = stationSplit['1'];\n          vm.stationViaOneName = stationSplit['2'];\n        }\n      } else {\n        vm.stationFromName = null;\n        vm.stationToName = null;\n      }\n      vm.getStations();\n      submit(vm.postJSON);\n    } else {\n      $location.url('').replace();\n    }\n\n    vm.showDetails = false;\n\n    // if back button pressed or breadcrumb selected. If brand is Swift PAYG make sure relevant tickets are shown\n    if ($location.search().brand === 'Swift PAYG') {\n      getSwiftPAYG();\n      swiftPAYG();\n    }\n\n    // if back button pressed or breadcrumb selected. If brand is Swift ABT\n    if ($location.search().brand === 'Swift Go') {\n      swiftABT();\n    }\n\n    // detect device in use\n    vm.deviceDetect();\n    function deviceDetect() {\n      vm.deviceDetector = deviceDetector;\n      vm.userAgent = deviceDetector.raw.userAgent;\n      // check if userAgent is Swift One app\n      if (vm.userAgent.includes('SwiftOneApp')) {\n        vm.oneApp = true;\n      } else {\n        vm.oneApp = false;\n      }\n      if (vm.userAgent.includes('android')) {\n        vm.android = true;\n      } else {\n        vm.android = false;\n      }\n      if (vm.deviceDetector.os === 'android' || vm.deviceDetector.os === 'ios') {\n        vm.isMobile = true;\n      } else {\n        vm.isMobile = false;\n      }\n    }\n\n    // Get Rail stations for autocomplete\n    function getStations() {\n      // console.log(\"get stations\");\n      ticketingService\n        .getStations()\n        .then(function(response) {\n          let fromRail;\n          let toRail;\n          let ViaOneRail;\n          let dataFromRail;\n          let dataToRail;\n          let dataViaOnRail;\n          let dataFromRailData;\n          let dataToRailData;\n          let dataViaOneRailData;\n          // console.log(\"rail stations\");\n          // console.log(response);\n          vm.stationList = response;\n          // if going direct to page with stations work out zone information\n          if (vm.stationFromName !== null) {\n            fromRail = vm.stationFromName || null;\n            toRail = vm.stationToName || null;\n            ViaOneRail = vm.stationViaOneName || null;\n            dataFromRail = $filter('filter')(response, { name: fromRail });\n            dataToRail = $filter('filter')(response, { name: toRail });\n            dataViaOnRail = $filter('filter')(response, { name: ViaOneRail });\n            dataFromRailData = dataFromRail['0'];\n            dataToRailData = dataToRail['0'];\n            dataViaOneRailData = dataViaOnRail['0'];\n            vm.fromStationInfo = dataFromRailData;\n            vm.toStationInfo = dataToRailData;\n            vm.ViaOneStationInfo = dataViaOneRailData;\n\n            if (vm.fromStationInfo != null) {\n              vm.fromZoneNumber = vm.fromStationInfo.zone;\n              vm.toZoneNumber = vm.toStationInfo.zone;\n              if (vm.ViaOneStationInfo != null) {\n                vm.ViaOneZoneNumber = vm.ViaOneStationInfo.zone;\n              }\n            }\n          }\n        })\n        .catch(function(error) {\n          vm.errorMessage =\n            'There was a problem loading train station data. Please try again later.';\n          vm.loadingStatus = 'error';\n          console.error(error);\n        });\n    }\n\n    function retryTicketSearch(data) {\n      // Retry after 5 seconds if not already retrying\n      if (!retryIntervalPromise) {\n        retryIntervalPromise = $interval(\n          function() {\n            submit(data);\n          },\n          5000,\n          2\n        ); // Only retry once per timeout/error\n      }\n    }\n\n    function submit(data) {\n      let fbus;\n      let ftrain;\n      let fmetro;\n      let i;\n      let j;\n      let arrlen;\n      let bus;\n      let train;\n      let metro;\n      let searchAll;\n      let searchExact;\n      vm.loadingStatus = 'loading';\n      angular.copy(vm.postJSON, vm.postedJSON); // save initial search variables\n\n      // Set a timeout for the API call (e.g., 10 seconds)\n      apiTimeoutPromise = $timeout(function() {\n        vm.errorMessage = 'The ticket search is taking too long. Retrying...';\n        vm.loadingStatus = 'timeout';\n\n        // Sentry log for slow API\n        if (window.Sentry && window.Sentry.captureMessage) {\n          // Capture warning about slow API call\n          window.Sentry.captureMessage('Ticket search API call is slow or unresponsive', {\n            level: 'warning',\n            extra: {\n              postJSON: vm.postJSON,\n              url: $location.absUrl(),\n              errors: window.console && window.console.errors ? window.console.errors : undefined\n            }\n          });\n        }\n\n        submit(data);\n      }, 10000);\n\n      $location.search({\n        allowBus: vm.postedJSON.allowBus,\n        allowTrain: vm.postedJSON.allowTrain,\n        allowMetro: vm.postedJSON.allowMetro,\n        passengerType: vm.postedJSON.passengerType,\n        timeBand: vm.postedJSON.timeBand,\n        brand: vm.postedJSON.brand,\n        stationNames: vm.postedJSON.stationNames,\n        buyOnDirectDebit: vm.buyOnDirectDebitParameter,\n        buyOnDirectPurchase: vm.buyOnDirectPurchaseParameter,\n        buyOnSwift: vm.buyOnSwiftParameter,\n        hasOnlinePurchaseChannel: vm.hasOnlinePurchaseChannelParameter,\n        purchaseTic: vm.purchaseTicParameter,\n        purchaseRailStation: vm.purchaseRailStationParameter,\n        purchasePayzone: vm.purchasePayzoneParameter,\n        busTravelArea: vm.busTravelAreaParameter,\n        operator: vm.operatorParameter,\n        railZoneFrom: vm.railZoneFromParameter,\n        railZoneTo: vm.railZoneToParameter,\n        timePeriodAll: vm.timePeriodAnytimeParameter,\n        timePeriod1: vm.timePeriod1Parameter,\n        timePeriod2: vm.timePeriod2Parameter,\n        timePeriod3: vm.timePeriod3Parameter,\n        timePeriod4: vm.timePeriod4Parameter,\n        limit: vm.limit,\n        limitExact: vm.limitExact,\n        excludeBus: vm.excludebusParameter\n      }); // set search url for sharing/tracking\n\n      vm.searchFilters = {}; // set scope for search filters and reset on every search\n\n      vm.origFilters = {}; // set scope for original search filters and reset on every search\n      // console.log('this is posted');\n      // console.log(vm.postedJSON);\n\n      // work out all tickets available\n      ticketingService\n        .ticketSearch(data)\n        .then(function(response) {\n          $timeout.cancel(apiTimeoutPromise);\n          vm.all = response;\n          vm.original = response;\n\n          // For each item in the results\n          angular.forEach(vm.all, function(items) {\n            // Check the operator and push it to filters\n            if (vm.filterButtons.operator.indexOf(items.operator) === -1) {\n              vm.filterButtons.operator.push(items.operator);\n            }\n\n            // Check bus area\n            if (vm.filterButtons.busTravelArea.indexOf(items.busTravelArea) === -1) {\n              vm.filterButtons.busTravelArea.push(items.busTravelArea);\n            }\n\n            // Check rail zone from\n            if (vm.filterButtons.railZoneFrom.indexOf(items.railZoneFrom) === -1) {\n              vm.filterButtons.railZoneFrom.push(items.railZoneFrom);\n            }\n\n            // Check rail zone to\n            if (vm.filterButtons.railZoneTo.indexOf(items.railZoneTo) === -1) {\n              vm.filterButtons.railZoneTo.push(items.railZoneTo);\n            }\n\n            // eslint-disable-next-line angular/window-service\n            // console.log(window?.setTicketFinder?.name);\n            // console.log(items);\n            // console.log(items.buyTicketUrl);\n\n            // unicard\n            // \"https://natex-ssp.unicard-uk.com/ssp/swift/dnr_importBasket.jsp?[{matrixId:'CAA118'}]\",\n            // \"https://ticketing.cenapps.org.uk/DirectDebit/34\",\n\n            // \"https://my.swiftcard.org.uk/ssp/swift/dnr_importBasket.jsp?[{matrixId:'KAA045'}]\",\n            // \"buyTicketUrl\": \"https://ticketing.networkwestmidlands.com/DirectDebit/411\",\n\n            // Smart Citizen\n            // https://m-public-tfwmtest.smartcitizen.net/?matrixId=AAA116\n            // https://m-public-tfwm.smartcitizen.net/?matrixId=AAA116\n\n            // https://public-tfwmdev.smartcitizen.net/?matrixId=AAA116\n            // https://public-tfwmtest.smartcitizen.net/?matrixId=AAA116\n\n            // https://public-tfwm.smartcitizen.net//?matrixId=AAA116\n\n            // console.log('Original: ' + items.buyTicketUrl);\n\n            if (window?.setTicketFinder?.name.includes('TfWM Ticket Finder')) {\n              // console.log('Unicard app detected (Production)');\n              if (!items.buyTicketUrl.includes('ticketing.networkwestmidlands.com')) {\n                // eslint-disable-next-line no-unused-vars\n                const [host, queryString] = items.buyTicketUrl.split('?');\n                items.buyTicketUrl =\n                  'https://my.swiftcard.org.uk/ssp/swift/dnr_importBasket.jsp?' + queryString;\n              }\n            }\n\n            if (window?.setTicketFinder?.name.includes('Unicard Desktop Test')) {\n              // console.log('Unicard app detected (Test)');\n              if (!items.buyTicketUrl.includes('ticketing.cenapps.org.uk')) {\n                // eslint-disable-next-line no-unused-vars\n                const [host, queryString] = items.buyTicketUrl.split('?');\n                items.buyTicketUrl =\n                  'https://natex-ssp.unicard-uk.com/ssp/swift/dnr_importBasket.jsp?' + queryString;\n              }\n            }\n\n            // console.log(window?.setTicketFinder?.name);\n\n            if (\n              items.swiftCurrentAmount &&\n              window?.setTicketFinder?.name.includes('Smart Citizen')\n            ) {\n              console.log('payg detected');\n              let baseUrl2 = '';\n              if (window?.setTicketFinder?.name.includes('Smart Citizen Mobile Production')) {\n                baseUrl2 = 'https://m-public-tfwm.smartcitizen.net';\n              } else if (\n                window?.setTicketFinder?.name.includes('Smart Citizen Desktop Production')\n              ) {\n                baseUrl2 = 'https://public-tfwm.smartcitizen.net';\n              } else if (window?.setTicketFinder?.name.includes('Smart Citizen Mobile Test')) {\n                baseUrl2 = 'https://m-public-tfwmtest.smartcitizen.net';\n              } else if (window?.setTicketFinder?.name.includes('Smart Citizen Production')) {\n                baseUrl2 = 'https://public-tfwm.smartcitizen.net';\n              } else if (window?.setTicketFinder?.name.includes('Smart Citizen Test')) {\n                baseUrl2 = 'https://public-tfwmtest.smartcitizen.net';\n              } else if (window?.setTicketFinder?.name.includes('Smart Citizen Desktop Test')) {\n                baseUrl2 = 'https://public-tfwmtest.smartcitizen.net';\n              } else if (window?.setTicketFinder?.name.includes('Smart Citizen Dev')) {\n                baseUrl2 = 'https://public-tfwmdev.smartcitizen.net';\n              }\n\n              const paygUrl = baseUrl2 + '/?matrixId=AAC001';\n\n              console.log(paygUrl);\n\n              items.buyTicketUrl = baseUrl2 + '/?matrixId=AAC001';\n            }\n\n            // Check if the buy ticket url is a smartcitizen ticket finder and format it differently\n            if (\n              items.buyTicketUrl.includes('matrixId') &&\n              window?.setTicketFinder?.name.includes('Smart Citizen')\n            ) {\n              // console.log('Smart Citizen app detected' + window?.setTicketFinder?.name);\n              let baseUrl = '';\n              if (window?.setTicketFinder?.name.includes('Smart Citizen Mobile Production')) {\n                baseUrl = 'https://m-public-tfwm.smartcitizen.net';\n              } else if (\n                window?.setTicketFinder?.name.includes('Smart Citizen Desktop Production')\n              ) {\n                baseUrl = 'https://public-tfwm.smartcitizen.net';\n              } else if (window?.setTicketFinder?.name.includes('Smart Citizen Mobile Test')) {\n                baseUrl = 'https://m-public-tfwmtest.smartcitizen.net';\n              } else if (window?.setTicketFinder?.name.includes('Smart Citizen Production')) {\n                baseUrl = 'https://public-tfwm.smartcitizen.net';\n              } else if (window?.setTicketFinder?.name.includes('Smart Citizen Test')) {\n                baseUrl = 'https://public-tfwmtest.smartcitizen.net';\n              } else if (window?.setTicketFinder?.name.includes('Smart Citizen Desktop Test')) {\n                baseUrl = 'https://public-tfwmtest.smartcitizen.net';\n              } else if (window?.setTicketFinder?.name.includes('Smart Citizen Dev')) {\n                baseUrl = 'https://public-tfwmdev.smartcitizen.net';\n              }\n              // console.log('baseurl: ' + baseUrl);\n              // eslint-disable-next-line no-unused-vars\n              const [host, queryString] = items.buyTicketUrl.split('?');\n              const matrixid = queryString\n                .replace('https://', '')\n                .replace(/[\\[\\]]/g, '')\n                .replace(/[{}]/g, '')\n                .replace(/:/g, '=')\n                .replace(/'/g, '');\n              items.buyTicketUrl = baseUrl + '?' + matrixid;\n            }\n            // console.log('Final: ' + items.buyTicketUrl);\n            return items.buyTicketUrl;\n          });\n\n          fbus = vm.postedJSON.allowBus || false;\n          ftrain = vm.postedJSON.allowTrain || false;\n          fmetro = vm.postedJSON.allowMetro || false;\n\n          if (\n            vm.postJSON.allowTrain === true ||\n            vm.postJSON.brand === 'nnetwork' ||\n            vm.postJSON.brand === 'ntrain'\n          ) {\n            if (vm.fromStationInfoZone != null) {\n              vm.fromZoneNumber = vm.fromStationInfoZone;\n            } else if (vm.fromStationInfo != null) {\n              vm.fromZoneNumber = vm.fromStationInfo.zone;\n            } else {\n              vm.fromZoneNumber = null;\n            }\n\n            if (vm.toStationInfoZone != null) {\n              vm.toZoneNumber = vm.toStationInfoZone;\n            } else if (vm.toStationInfo != null) {\n              vm.toZoneNumber = vm.toStationInfo.zone;\n            } else {\n              vm.toZoneNumber = null;\n            }\n\n            if (vm.fromZoneNumber === '1') {\n              vm.ffromzone = 1;\n            } else if (vm.fromZoneNumber === '2') {\n              vm.ffromzone = 2;\n            } else if (vm.fromZoneNumber === '3') {\n              vm.ffromzone = 3;\n            } else if (vm.fromZoneNumber === '4') {\n              vm.ffromzone = 4;\n            } else if (vm.fromZoneNumber === '5') {\n              vm.ffromzone = 5;\n            } else {\n              vm.ffromzone = null;\n            }\n\n            if (vm.toZoneNumber === '1') {\n              vm.ftozone = 1;\n            } else if (vm.toZoneNumber === '2') {\n              vm.ftozone = 2;\n            } else if (vm.toZoneNumber === '3') {\n              vm.ftozone = 3;\n            } else if (vm.toZoneNumber === '4') {\n              vm.ftozone = 4;\n            } else if (vm.toZoneNumber === '5') {\n              vm.ftozone = 5;\n            } else {\n              vm.ftozone = null;\n            }\n\n            if (vm.ViaOneZoneNumber === '1') {\n              vm.fViaOnezone = 1;\n            } else if (vm.ViaOneZoneNumber === '2') {\n              vm.fViaOnezone = 2;\n            } else if (vm.ViaOneZoneNumber === '3') {\n              vm.fViaOnezone = 3;\n            } else if (vm.ViaOneZoneNumber === '4') {\n              vm.fViaOnezone = 4;\n            } else if (vm.ViaOneZoneNumber === '5') {\n              vm.fViaOnezone = 5;\n            } else {\n              vm.fViaOnezone = null;\n            }\n\n            if (vm.ViaOneZoneNumber != null) {\n              if (vm.ViaOneZoneNumber < vm.fromZoneNumber) {\n                vm.ffromzone = vm.ViaOneZoneNumber;\n              } else if (vm.ViaOneZoneNumber > vm.toZoneNumber) {\n                vm.ftozone = vm.ViaOneZoneNumber;\n              }\n            }\n          }\n\n          if (vm.postJSON.allowTrain === true) {\n            vm.exactMatch = [];\n            if (vm.fromZoneNumber !== null && vm.toZoneNumber !== null) {\n              // exact results won't work if from zone is greater then the to zone so do a check\n              if (vm.ffromzone < vm.ftozone) {\n                vm.exactMatch = $filter('filter')(response, {\n                  allowBus: fbus,\n                  allowTrain: ftrain,\n                  allowMetro: fmetro,\n                  railZoneFrom: vm.ffromzone,\n                  railZoneTo: vm.ftozone\n                });\n              } else if (vm.ffromzone > vm.ftozone) {\n                vm.exactMatch = $filter('filter')(response, {\n                  allowBus: fbus,\n                  allowTrain: ftrain,\n                  allowMetro: fmetro,\n                  railZoneFrom: vm.ftozone,\n                  railZoneTo: vm.ffromzone\n                });\n              } else if (vm.ffromzone === vm.ftozone) {\n                vm.exactMatch = $filter('filter')(response, {\n                  allowBus: fbus,\n                  allowTrain: ftrain,\n                  allowMetro: fmetro,\n                  railZoneFrom: 1,\n                  railZoneTo: vm.ftozone\n                });\n              }\n            } else {\n              vm.exactMatch = $filter('filter')(response, {\n                allowBus: fbus,\n                allowTrain: ftrain,\n                allowMetro: fmetro\n              });\n            }\n          } else if (vm.postJSON.brand === 'nnetwork' || vm.postJSON.brand === 'ntrain') {\n            vm.exactMatch = [];\n            if (vm.fromZoneNumber !== null && vm.toZoneNumber !== null) {\n              // exact results won't work if from zone is greater then the to zone so do a check\n              if (vm.ffromzone < vm.ftozone) {\n                vm.exactMatch = $filter('filter')(response, {\n                  railZoneFrom: vm.ffromzone,\n                  railZoneTo: vm.ftozone\n                });\n              } else if (vm.ffromzone > vm.ftozone) {\n                vm.exactMatch = $filter('filter')(response, {\n                  railZoneFrom: vm.ftozone,\n                  railZoneTo: vm.ffromzone\n                });\n              } else if (vm.ffromzone === vm.ftozone) {\n                vm.exactMatch = $filter('filter')(response, {\n                  railZoneFrom: 1,\n                  railZoneTo: vm.ftozone\n                });\n              }\n            } else {\n              vm.exactMatch = $filter('filter')(response, {});\n            }\n          } else {\n            // console.log(\"Exact Search without rail\");\n            vm.postedJSON.stationNames = null; // make sure no stations are included if train not checked.\n            vm.exactMatch = $filter('filter')(response, {\n              allowBus: fbus,\n              allowTrain: ftrain,\n              allowMetro: fmetro\n            });\n          }\n\n          // compare search results and exact search results and display difference\n          searchAll = vm.all;\n          searchExact = vm.exactMatch;\n          // console.log('all results');\n          // console.log(searchAll);\n          // console.log(\"search exact results\");\n          // console.log(vm.exactMatch);\n\n          for (i = 0; i < searchExact.length; i += 1) {\n            arrlen = searchAll.length;\n            for (j = 0; j < arrlen; j += 1) {\n              if (searchExact[i] === searchAll[j]) {\n                searchAll = searchAll.slice(0, j).concat(searchAll.slice(j + 1, arrlen));\n              }\n            }\n          }\n\n          vm.otherResults = searchAll;\n\n          bus = vm.postedJSON.allowBus;\n          train = vm.postedJSON.allowTrain;\n          metro = vm.postedJSON.allowMetro;\n\n          // if 1 or 2 modes selected open up the exclude mode filter\n          if (\n            bus !== null ||\n            (bus !== null && train !== null) ||\n            (bus !== null && metro !== null) ||\n            (train !== null && metro !== null)\n          ) {\n            vm.toggleFilter('mode');\n          }\n\n          // if all modes selected open up how to buy filter\n          if (bus !== null && train !== null && metro !== null) {\n            vm.toggleFilter('payment');\n          }\n\n          vm.update(); // When feed is loaded run it through the filters\n          vm.loadingStatus = 'success';\n          vm.errorMessage = ''; // Clear any error messages\n          // scroll to results\n          $location.hash('sbmBtn');\n          $anchorScroll();\n        })\n        .catch(function(error) {\n          vm.errorMessage = 'There was a problem loading ticket data. Please try again later.';\n          vm.loadingStatus = 'error';\n          retryTicketSearch(data);\n          console.error(error);\n        });\n    }\n\n    function update() {\n      let filtered = vm.all;\n      let filteredorg = vm.exactMatch;\n      let filteredother = vm.otherResults;\n\n      // For each filter in the search filters loop through and delete any that state false, this is so it doesn't explicitly match false and shows everything.\n      angular.forEach(vm.searchFilters, function(val, key) {\n        // if Key/Property contains 'Allow\" and the value is true || if Key/Property doesn't contain 'Allow' and val is false (this is to make sure the opposite/exclude filter values are deleted as the trues will be false and vice versa)\n        if (\n          (key.indexOf('allow') !== -1 && val) ||\n          (val === false && key.indexOf('allow') === -1)\n        ) {\n          // Delete the filter and value\n          delete vm.searchFilters[key];\n        }\n        // if pre 9.30 is selected\n        if (vm.searchFilters.timePeriod1) {\n          vm.searchFilters.timePeriod2 = false;\n          vm.searchFilters.timePeriod3 = false;\n          vm.searchFilters.timePeriod4 = false;\n        }\n        // if 9.30 - 3.30 is selected\n        if (vm.searchFilters.timePeriod2) {\n          vm.searchFilters.timePeriod1 = false;\n          vm.searchFilters.timePeriod3 = false;\n          vm.searchFilters.timePeriod4 = false;\n        }\n        // if 3.30 - 6 is selected\n        if (vm.searchFilters.timePeriod3) {\n          vm.searchFilters.timePeriod1 = false;\n          vm.searchFilters.timePeriod2 = false;\n          vm.searchFilters.timePeriod4 = false;\n        }\n        // if after 6 is selected\n        if (vm.searchFilters.timePeriod4) {\n          vm.searchFilters.timePeriod1 = false;\n          vm.searchFilters.timePeriod2 = false;\n          vm.searchFilters.timePeriod3 = false;\n        }\n        // if anytime is selected\n        if (vm.timePeriodAll === 'yes') {\n          // vm.searchFilters.timeLimited = false;\n          // vm.searchFilters.timePeriod1 = '';\n          vm.searchFilters.timePeriod1 = true;\n          vm.searchFilters.timePeriod2 = true;\n          vm.searchFilters.timePeriod3 = true;\n          vm.searchFilters.timePeriod4 = true;\n        }\n      });\n\n      // Filter results by the filters selected\n      filtered = $filter('filter')(filtered, vm.searchFilters);\n      filteredorg = $filter('filter')(filteredorg, vm.searchFilters);\n      filteredother = $filter('filter')(filteredother, vm.searchFilters);\n\n      // Sort results by selected option\n      vm.filteredTickets = $filter('orderBy')(filtered, vm.orderBy);\n      vm.origTickets = $filter('orderBy')(filteredorg, vm.orderBy);\n      vm.otherTickets = $filter('orderBy')(filteredother, vm.orderBy);\n\n      // order filtering\n      if (vm.orderBy === 'orderSequence') {\n        vm.origTickets.sort(function(a, b) {\n          // set conditional attributes for refresher\n          vm.sortPop = 'yes';\n          vm.sortPlw = 'no';\n          vm.sortPhl = 'no';\n          return b.buyOnDirectDebit - a.buyOnDirectDebit;\n        });\n      } else if (vm.orderBy === 'ticketCurrentAmount') {\n        vm.origTickets.sort(function(a, b) {\n          vm.sortPop = 'no';\n          vm.sortPlw = 'yes';\n          vm.sortPhl = 'no';\n          return a.ticketCurrentAmount - b.ticketCurrentAmount;\n        });\n      } else if (vm.orderBy === '-ticketCurrentAmount') {\n        vm.origTickets.sort(function(a, b) {\n          vm.sortPop = 'no';\n          vm.sortPlw = 'no';\n          vm.sortPhl = 'yes';\n          return b.ticketCurrentAmount - a.ticketCurrentAmount;\n        });\n      }\n\n      // console.log(\"Search Filters:\");\n      // console.log(vm.searchFilters);\n      // console.log(\"Filtered Tickets:\");\n      // console.log(vm.filteredTickets);\n      // console.log('Original Search:');\n      // console.log(vm.origTickets);\n      // console.log('Other Results:');\n      // console.log(vm.otherTickets);\n\n      vm.updateGrid();\n    }\n\n    updateGrid.$inject = ['$timeout', 'angularGridInstance'];\n    function updateGrid() {\n      $timeout(\n        function() {\n          $timeout(\n            function() {\n              let searchURL;\n              let urlstring;\n              let abus;\n              let atrain;\n              let ametro;\n              let atime;\n              let obj;\n              if (vm.filteredTickets && vm.filteredTickets.length > 0) {\n                // set storage url according to search filters\n                // set data to be displayed in serializer\n                obj = {\n                  passengerType: vm.postedJSON.passengerType,\n                  timeBand: vm.postedJSON.timeBand,\n                  brand: vm.postedJSON.brand,\n                  stationNames: vm.postedJSON.stationNames,\n                  busTravelArea: vm.searchFilters.busTravelArea,\n                  operator: vm.searchFilters.operator,\n                  buyOnDirectDebit: vm.searchFilters.buyOnDirectDebit,\n                  buyOnDirectPurchase: vm.searchFilters.buyOnDirectPurchase || null,\n                  buyOnSwift: vm.searchFilters.buyOnSwift,\n                  hasOnlinePurchaseChannel: vm.searchFilters.hasOnlinePurchaseChannel,\n                  purchaseTic: vm.searchFilters.purchaseTic,\n                  purchaseRailStation: vm.searchFilters.purchaseRailStation,\n                  purchasePayzone: vm.searchFilters.purchasePayzone,\n                  railZoneFrom: vm.searchFilters.railZoneFrom,\n                  railZoneTo: vm.searchFilters.railZoneTo,\n                  limit: vm.limit,\n                  limitExact: vm.limitExact,\n                  excludeBus: vm.searchFilters.allowBus\n                };\n\n                urlstring = $httpParamSerializer(obj);\n\n                if (vm.postedJSON.allowBus) {\n                  abus = 'allowBus';\n                }\n\n                if (vm.postedJSON.allowTrain) {\n                  atrain = 'allowTrain';\n                }\n\n                if (vm.postedJSON.allowMetro) {\n                  ametro = 'allowMetro';\n                }\n\n                // work out time of day selection and update searchURL\n                if (vm.searchFilters.timePeriod1 === true) {\n                  atime = '&timePeriod1=true&timePeriod2=false&timePeriod3=false&timePeriod4=false';\n                } else if (vm.searchFilters.timePeriod2 === true) {\n                  atime = '&timePeriod1=false&timePeriod2=true&timePeriod3=false&timePeriod4=false';\n                } else if (vm.searchFilters.timePeriod3 === true) {\n                  atime = '&timePeriod1=false&timePeriod2=false&timePeriod3=true&timePeriod4=false';\n                } else if (vm.searchFilters.timePeriod4 === true) {\n                  atime = '&timePeriod1=false&timePeriod2=false&timePeriod3=false&timePeriod4=true';\n                } else if (vm.timePeriodAll === true) {\n                  atime = '&timePeriodAll=true';\n                } else {\n                  atime = '';\n                }\n\n                // bus only\n                if (\n                  vm.postedJSON.allowBus &&\n                  !vm.postedJSON.allowTrain &&\n                  !vm.postedJSON.allowMetro\n                ) {\n                  searchURL = '/?' + abus + '&' + urlstring + atime;\n                  // console.log(\"bus only - \" + searchURL);\n                  savedFilter.set('url', searchURL);\n                }\n\n                // bus and train\n                if (\n                  vm.postedJSON.allowBus &&\n                  vm.postedJSON.allowTrain &&\n                  !vm.postedJSON.allowMetro\n                ) {\n                  searchURL = '/?' + abus + '&' + atrain + '&' + urlstring + atime;\n                  // console.log(searchURL);\n                  savedFilter.set('url', searchURL);\n                }\n                // bus and metro\n                if (\n                  vm.postedJSON.allowBus &&\n                  !vm.postedJSON.allowTrain &&\n                  vm.postedJSON.allowMetro\n                ) {\n                  searchURL = '/?' + abus + '&' + ametro + '&' + urlstring + atime;\n                  // console.log(searchURL);\n                  savedFilter.set('url', searchURL);\n                }\n                // train only\n                if (\n                  !vm.postedJSON.allowBus &&\n                  vm.postedJSON.allowTrain &&\n                  !vm.postedJSON.allowMetro\n                ) {\n                  searchURL = '/?' + atrain + '&' + urlstring + atime;\n                  // console.log(searchURL);\n                  savedFilter.set('url', searchURL);\n                }\n                // train and metro\n                if (\n                  !vm.postedJSON.allowBus &&\n                  vm.postedJSON.allowTrain &&\n                  vm.postedJSON.allowMetro\n                ) {\n                  searchURL = '/?' + atrain + '&' + ametro + '&' + urlstring + atime;\n                  // console.log(searchURL);\n                  savedFilter.set('url', searchURL);\n                }\n                // metro only\n                if (\n                  !vm.postedJSON.allowBus &&\n                  !vm.postedJSON.allowTrain &&\n                  vm.postedJSON.allowMetro\n                ) {\n                  searchURL = '/?' + ametro + '&' + urlstring + atime;\n                  // console.log(searchURL);\n                  savedFilter.set('url', searchURL);\n                }\n                // all modes selected\n                if (\n                  vm.postedJSON.allowBus &&\n                  vm.postedJSON.allowTrain &&\n                  vm.postedJSON.allowMetro\n                ) {\n                  searchURL = '/?' + abus + '&' + atrain + '&' + ametro + '&' + urlstring + atime;\n                  // console.log(searchURL);\n                  savedFilter.set('url', searchURL);\n                }\n                // no modes selected\n                if (\n                  !vm.postedJSON.allowBus &&\n                  !vm.postedJSON.allowTrain &&\n                  !vm.postedJSON.allowMetro\n                ) {\n                  searchURL = '/?' + urlstring + atime;\n                  // console.log(searchURL);\n                  savedFilter.set('url', searchURL);\n                }\n                // load.log(searchURL);\n              }\n            },\n            0,\n            false\n          );\n        },\n        0,\n        false\n      );\n    }\n\n    // get Out Of County Rail stations for autocomplete\n    function getoocStations() {\n      ticketingService\n        .getStations()\n        .then(function(response) {\n          // console.log(\"out of county stations\");\n          // console.log(response);\n          const OutOfCounty = $filter('filter')(response, {\n            outOfCounty: 'true'\n          });\n          vm.stationoocList = OutOfCounty;\n        })\n        .catch(function(error) {\n          vm.errorMessage =\n            'There was a problem loading train station data. Please try again later.';\n          vm.loadingStatus = 'error';\n          console.error(error);\n        });\n    }\n\n    // get In County Rail stations for autocomplete\n    function geticStations() {\n      ticketingService\n        .getStations()\n        .then(function(response) {\n          const inCounty = $filter('filter')(response, { outOfCounty: 'false' });\n          vm.stationicList = inCounty;\n        })\n        .catch(function(error) {\n          vm.errorMessage =\n            'There was a problem loading train station data. Please try again later.';\n          vm.loadingStatus = 'error';\n          console.error(error);\n        });\n    }\n\n    // reset search\n    function clearFilter() {\n      $location.url('').replace();\n      defaultVars();\n      // clear filter checkboxes\n      vm.excludeBusCheck = function() {\n        return false;\n      };\n      vm.excludeTrainCheck = function() {\n        return false;\n      };\n      vm.excludeTramCheck = function() {\n        return false;\n      };\n      vm.buyOnDirectDebitCheck = function() {\n        return false;\n      };\n      vm.buyOnDirectPurchaseCheck = function() {\n        return false;\n      };\n      vm.buyOnSwiftCheck = function() {\n        return false;\n      };\n      vm.hasOnlinePurchaseChannelCheck = function() {\n        return false;\n      };\n      vm.purchaseTicCheck = function() {\n        return false;\n      };\n      vm.purchaseRailStationCheck = function() {\n        return false;\n      };\n      vm.purchasePayzoneCheck = function() {\n        return false;\n      };\n      vm.timePeriod1CheckAll = function() {\n        return false;\n      };\n      vm.timePeriod1Check = function() {\n        return false;\n      };\n      vm.timePeriod2Check = function() {\n        return false;\n      };\n      vm.timePeriod3Check = function() {\n        return false;\n      };\n      vm.timePeriod4Check = function() {\n        return false;\n      };\n      savedFilter.set('url', '');\n      vm.postJSON.stationNames = null;\n      clearFromStation();\n      clearToStation();\n      clearViaOneStation();\n    }\n\n    // if a pass is selected deselect all modes\n    function clearModes() {\n      vm.postJSON.allowBus = null;\n      vm.postJSON.allowTrain = null;\n      vm.postJSON.allowMetro = null;\n    }\n\n    // if no stations set in url make sure from station is set to null. This is to fix back function adding [] in from station\n    function clearStation() {\n      if ($location.search().stationNames === '[]') {\n        clearFromStation();\n      }\n    }\n\n    // clear time selections\n    function clearTime() {\n      // uncheck time of day checkboxes\n      vm.timePeriod1CheckAll = function() {\n        return false;\n      };\n      vm.timePeriod1Check = function() {\n        return false;\n      };\n      vm.timePeriod2Check = function() {\n        return false;\n      };\n      vm.timePeriod3Check = function() {\n        return false;\n      };\n      vm.timePeriod4Check = function() {\n        return false;\n      };\n      // make time selections false to reset default search criteria\n      vm.timePeriodAll = false;\n      vm.searchFilters.timePeriod1 = false;\n      vm.searchFilters.timePeriod2 = false;\n      vm.searchFilters.timePeriod3 = false;\n      vm.searchFilters.timePeriod4 = false;\n      vm.update();\n    }\n\n    function checkTimeAll() {\n      if (vm.timePeriodAll === 'yes') {\n        vm.searchFilters.timePeriod1 = true;\n        vm.searchFilters.timePeriod2 = true;\n        vm.searchFilters.timePeriod3 = true;\n        vm.searchFilters.timePeriod4 = true;\n\n        vm.timePeriod1CheckAll = function() {\n          return true;\n        };\n        vm.timePeriod1Check = function() {\n          return false;\n        };\n        vm.timePeriod2Check = function() {\n          return false;\n        };\n        vm.timePeriod3Check = function() {\n          return false;\n        };\n        vm.timePeriod4Check = function() {\n          return false;\n        };\n      } else if (vm.timePeriodAll === 'no') {\n        vm.searchFilters.timePeriod1 = '';\n        vm.searchFilters.timePeriod2 = '';\n        vm.searchFilters.timePeriod3 = '';\n        vm.searchFilters.timePeriod4 = '';\n      }\n    }\n\n    // disable anytime if another time period is selected\n    function checkTime() {\n      vm.timePeriodAll = false;\n      if (vm.timePeriodAll === false) {\n        vm.timePeriod1CheckAll = function() {\n          return false;\n        };\n      }\n    }\n\n    // rail stations - at least 2 required for api to work\n\n    // set From Rail Station\n    vm.fromEmpty = 'none';\n\n    vm.fromStationInputChanged = function(str) {\n      vm.fromStationText = str;\n    };\n\n    vm.fromfocusState = 'None';\n    vm.fromFocusIn = function() {\n      vm.fromfocusState = 'In';\n    };\n    vm.fromFocusOut = function() {\n      vm.fromfocusState = 'Out';\n\n      if (vm.stationToName != null) {\n        vm.stationFromReq = true;\n      }\n\n      if (vm.fromStationText != null && vm.stationFromName == null) {\n        vm.stationFromReq = true;\n      }\n    };\n\n    vm.stationFromReq = false; // set from station to not required\n    vm.stationFromReqOOC = true; // set ooc station to required\n    vm.stationFrom = function(selected) {\n      if (selected) {\n        vm.postJSON.stationNames = [];\n        vm.stationFromName = selected.originalObject.name; // set From station\n        vm.postJSON.stationNames[0] = selected.originalObject.name;\n        vm.stationFromNameZone = selected.originalObject.zone;\n        vm.stationFromNameOoc = selected.originalObject.outOfCounty;\n        vm.stationFromNameOocZ5 = selected.originalObject.zone5InCounty;\n        vm.fromZoneNumber = selected.originalObject.zone;\n        vm.fromStationInfoZone = selected.originalObject.zone;\n        vm.stationFromReq = false; // set from to required to ensure selection is made from list\n        vm.fromEmpty = true;\n      } else {\n        vm.stationFromName = null;\n        vm.postJSON.stationNames[0] = null;\n        vm.stationFromReq = false; // set from to required to ensure selection is made from list\n        vm.fromEmpty = false;\n      }\n    };\n\n    // reset from station\n    function clearFromStation() {\n      $scope.$broadcast('angucomplete-alt:clearInput', 'stationFrom');\n      $scope.$broadcast('angucomplete-alt:clearInput', 'stationFromOOC');\n      vm.stationFromName = null;\n      vm.postJSON.stationNames[0] = null;\n      vm.stationFromReq = false; // set from station to not required\n      vm.stationFromNameOocZ5 = null; // clear zone 5 in county\n      vm.fromStationInfoZone = null;\n      vm.fromStationText = null;\n    }\n\n    // set To Rail Station\n    vm.toEmpty = 'none';\n\n    vm.toStationInputChanged = function(str) {\n      vm.toStationText = str;\n    };\n\n    vm.tofocusState = 'None';\n    vm.toFocusIn = function() {\n      vm.tofocusState = 'In';\n\n      if (vm.stationFromName != null) {\n        vm.stationToReq = true;\n      }\n    };\n    vm.toFocusOut = function() {\n      vm.tofocusState = 'Out';\n\n      if (vm.stationFromName != null) {\n        vm.stationToReq = true;\n      }\n\n      if (vm.toStationText !== null && vm.stationToName === null) {\n        vm.stationToReq = true;\n      }\n    };\n\n    vm.stationToReq = false; // set to station to not required\n    vm.stationToReqOOC = true;\n    vm.stationTo = function(selected) {\n      if (selected) {\n        vm.stationToName = selected.title; // set To Station\n        vm.postJSON.stationNames[1] = selected.originalObject.name;\n        vm.stationToTitle = selected.originalObject.name;\n        vm.stationToNameZone = selected.originalObject.zone;\n        vm.stationToNameOoc = selected.originalObject.outOfCounty;\n        vm.stationToNameOocZ5 = selected.originalObject.zone5InCounty;\n        vm.toZoneNumber = selected.originalObject.zone;\n        vm.toStationInfoZone = selected.originalObject.zone;\n        vm.stationToReq = false; // set to to required to ensure selection is made from list\n        vm.toEmpty = true;\n      } else {\n        vm.stationToName = null;\n        vm.postJSON.stationNames[1] = null;\n        vm.stationToTitle = null;\n        vm.toEmpty = false;\n      }\n    };\n\n    // reset to station\n    function clearToStation() {\n      $scope.$broadcast('angucomplete-alt:clearInput', 'stationTo');\n      $scope.$broadcast('angucomplete-alt:clearInput', 'stationTo2');\n      $scope.$broadcast('angucomplete-alt:clearInput', 'stationTo3');\n      vm.stationToName = '';\n      vm.postJSON.stationNames[1] = null;\n      vm.stationToReq = false; // set to station to not required\n      vm.stationToNameOocZ5 = null; // clear zone 5 in county\n      vm.toStationInfoZone = null;\n      vm.toStationText = '';\n    }\n\n    // via station\n    vm.viaOneStationInputChanged = function(str) {\n      vm.viaOneStationText = str;\n    };\n\n    vm.viaOnefocusState = 'None';\n    vm.stationViaOneFocusIn = function() {\n      vm.viaOnefocusState = 'In';\n    };\n    vm.stationViaOneFocusOut = function() {\n      vm.viaOnefocusState = 'Out';\n\n      if (vm.stationViaOneName != null) {\n        vm.stationviaOneReq = true;\n      }\n\n      if (vm.viaOneStationText != null || vm.stationViaOneName == null) {\n        vm.stationViaOneReq = true;\n        vm.stationToReq = true;\n        vm.stationFromReq = true;\n      }\n    };\n\n    vm.stationViaOne = function(selected) {\n      if (selected) {\n        vm.stationViaOneName = selected.originalObject.name; // set To Station\n        vm.postJSON.stationNames[2] = selected.originalObject.name;\n        vm.stationViaOneTitle = selected.originalObject.name;\n        vm.stationViaOneNameZone = selected.originalObject.zone;\n        vm.stationViaOneNameOoc = selected.originalObject.outOfCounty;\n        vm.stationViaOneNameOocZ5 = selected.originalObject.zone5InCounty;\n        vm.ViaOneZoneNumber = selected.originalObject.zone;\n        vm.ViaOneStationInfoZone = selected.originalObject.zone;\n      }\n    };\n\n    // show via station if not null\n    if (vm.stationViaOneName != null) {\n      vm.stationVia = true;\n    }\n\n    // reset via one station\n    function clearViaOneStation() {\n      $scope.$broadcast('angucomplete-alt:clearInput', 'stationViaOne');\n      vm.stationViaOneName = null;\n      vm.viaOneStationText = null;\n      vm.stationViaOneName = null;\n      vm.postJSON.stationNames = null;\n    }\n\n    // control filters according to url parameters\n    // exclude bus\n    if (vm.excludebusParameter) {\n      // open how to buy filter\n      vm.filterButtons.mode = !vm.filterButtons.mode;\n      // set search filters to include DD\n      vm.searchFilters.allowBus = false;\n      // make sure DD is ticked\n      vm.excludeBusCheck = function() {\n        return true;\n      };\n    }\n\n    // direct debit\n    if (vm.buyOnDirectDebitParameter) {\n      // open how to buy filter\n      vm.filterButtons.payment = !vm.filterButtons.payment;\n      // set search filters to include DD\n      vm.searchFilters.buyOnDirectDebit = true;\n      // make sure DD is ticked\n      vm.buyOnDirectDebitCheck = function() {\n        return true;\n      };\n    }\n\n    // quick buy\n    if (vm.buyOnDirectPurchaseParameter) {\n      // open how to buy filter\n      vm.filterButtons.payment = !vm.filterButtons.payment;\n      // set search filters to include quick buy\n      vm.searchFilters.buyOnDirectPurchase = true;\n      // make sure quick buy is ticked\n      vm.buyOnDirectPurchaseCheck = function() {\n        return true;\n      };\n    }\n\n    // buy on swift\n    if (vm.buyOnSwiftParameter) {\n      // open how to buy filter\n      vm.filterButtons.payment = !vm.filterButtons.payment;\n      // set search filters to include swift\n      vm.searchFilters.buyOnSwift = true;\n      // make sure swift is ticked\n      vm.buyOnSwiftCheck = function() {\n        return true;\n      };\n    }\n\n    // buy online\n    if (vm.hasOnlinePurchaseChannelParameter) {\n      // pen how to buy filter\n      vm.filterButtons.payment = !vm.filterButtons.payment;\n      // set search filters to include buy online\n      vm.searchFilters.hasOnlinePurchaseChannel = true;\n      // make sure buy online is ticked\n      vm.hasOnlinePurchaseChannelCheck = function() {\n        return true;\n      };\n    }\n\n    // buy at tic\n    if (vm.purchaseTicParameter) {\n      // open how to buy filter\n      vm.filterButtons.payment = !vm.filterButtons.payment;\n      // set search filters to include buy from tic\n      vm.searchFilters.purchaseTic = true;\n      // make sure tic is ticked\n      vm.purchaseTicCheck = function() {\n        return true;\n      };\n    }\n\n    // buy rail station\n    if (vm.purchaseRailStationParameter) {\n      // open how to buy filter\n      vm.filterButtons.payment = !vm.filterButtons.payment;\n      // set search filters to include rail station\n      vm.searchFilters.purchaseRailStation = true;\n      // make sure rail station is ticked\n      vm.purchaseRailStationCheck = function() {\n        return true;\n      };\n    }\n\n    // payzone\n    if (vm.purchasePayzoneParameter) {\n      // open how to buy filter\n      vm.filterButtons.payment = !vm.filterButtons.payment;\n      // set search filters to include payzone\n      vm.searchFilters.purchasePayzone = true;\n      // make sure payzone is ticked\n      vm.purchasePayzoneCheck = function() {\n        return true;\n      };\n    }\n\n    // us travel area\n    if (vm.busTravelAreaParameter) {\n      // open bus area filter\n      vm.filterButtons.busTravelAreaBtn = !vm.filterButtons.busTravelAreaBtn;\n      // set search filters to include bus area\n      vm.searchFilters.busTravelArea = vm.busTravelAreaParameter;\n    }\n\n    // us operator\n    if (vm.operatorParameter) {\n      // open bus operator filter\n      vm.filterButtons.operatorBtn = !vm.filterButtons.operatorBtn;\n      // set search filters to include bus operator\n      vm.searchFilters.operator = vm.operatorParameter;\n    }\n\n    // from rail zone\n    if (vm.railZoneFromParameter) {\n      // open rail zones filter\n      vm.filterButtons.railZoneBtn = !vm.filterButtons.railZoneBtn;\n      // set search filters to include from rail zone\n      vm.searchFilters.railZoneFrom = vm.railZoneFromParameter;\n    }\n\n    // to rail zone\n    if (vm.railZoneToParameter) {\n      // open rail zone filter\n      vm.filterButtons.railZoneBtn = !vm.filterButtons.railZoneBtn;\n      // set search filters to include to rail zone\n      vm.searchFilters.railZoneTo = vm.railZoneToParameter;\n    }\n\n    // anytime\n    if ($location.search().timePeriodAll === 'true') {\n      // update search filters\n      vm.searchFilters.timeLimited = false;\n      vm.searchFilters.timePeriod1 = '';\n      // open time of day filter\n      vm.filterButtons.time = !vm.filterButtons.time;\n      // set search filters to include timePeriod1\n      vm.timePeriodAll = true;\n      // make sure payzone is ticked\n      vm.timePeriod1CheckAll = function() {\n        return true;\n      };\n    }\n\n    // pre 9.30\n    if ($location.search().timePeriod1 === 'true') {\n      // open time of day filter\n      vm.filterButtons.time = !vm.filterButtons.time;\n      // set search filters to include timePeriod1\n      vm.searchFilters.timePeriod1 = true;\n      // make sure payzone is ticked\n      vm.timePeriod1Check = function() {\n        return true;\n      };\n    }\n\n    // 9.30 - 3.30\n    if ($location.search().timePeriod2 === 'true') {\n      // open time of day filter\n      vm.filterButtons.time = !vm.filterButtons.time;\n      // set search filters to include timePeriod1\n      vm.searchFilters.timePeriod2 = true;\n      // make sure payzone is ticked\n      vm.timePeriod2Check = function() {\n        return true;\n      };\n    }\n\n    // 3.30 - 6\n    if ($location.search().timePeriod3 === 'true') {\n      // pen time of day filter\n      vm.filterButtons.time = !vm.filterButtons.time;\n      // set search filters to include timePeriod1\n      vm.searchFilters.timePeriod3 = true;\n      // make sure payzone is ticked\n      vm.timePeriod3Check = function() {\n        return true;\n      };\n    }\n\n    // after 6\n    if ($location.search().timePeriod4 === 'true') {\n      // open time of day filter\n      vm.filterButtons.time = !vm.filterButtons.time;\n      // set search filters to include timePeriod1\n      vm.searchFilters.timePeriod4 = true;\n      // make sure payzone is ticked\n      vm.timePeriod4Check = function() {\n        return true;\n      };\n    }\n\n    // filters\n    vm.hideModalFilter = function() {\n      vm.modalShownFilter = !vm.modalShownFilter;\n    };\n    vm.modalShownFilter = false;\n    function toggleModalFilter() {\n      vm.modalShownFilter = !vm.modalShownFilter;\n    }\n\n    // other matches and swift load more button\n    function loadMore() {\n      vm.limit += 6;\n      $location.search('limit', vm.limit);\n      vm.updateGrid();\n      vm.refreshOther();\n    }\n\n    // exact matches load more button\n    function loadMoreExact() {\n      vm.limitExact += 6;\n      $location.search('limitExact', vm.limitExact);\n      vm.updateGrid();\n      vm.refreshExact();\n    }\n\n    // refresh exact results grid\n    refreshExact.$inject = ['$timeout', 'angularGridInstance'];\n    function refreshExact() {\n      angular.element(document).ready(function() {\n        $timeout(function() {\n          angularGridInstance.origTicketResults.refresh();\n        }, 0);\n      });\n    }\n\n    // refresh other results grid\n    refreshOther.$inject = ['$timeout', 'angularGridInstance'];\n    function refreshOther() {\n      angular.element(document).ready(function() {\n        $timeout(function() {\n          angularGridInstance.ticketResults.refresh();\n        }, 0);\n      });\n    }\n\n    // toggle filter accordions\n    function toggleFilter(type) {\n      vm.filterButtons[type] = !vm.filterButtons[type];\n    }\n\n    // if pass is swift payg\n    function swiftPAYG() {\n      vm.passValue = vm.postJSON.brand;\n      if (vm.passValue === 'Swift PAYG') {\n        // console.log('swift payg');\n        vm.isHideCheck = !vm.isHideCheck;\n        vm.postJSON.passengerType = null;\n        vm.postJSON.timeBand = null;\n        vm.postJSON.stationNames = null;\n      } else if (\n        vm.passValue === 'nbus' ||\n        vm.passValue === 'National Express' ||\n        vm.passValue === 'Diamond Bus' ||\n        vm.passValue === 'Stagecoach' ||\n        vm.passValue === 'Swift PAYG' ||\n        vm.passValue === 'West Midlands Metro'\n      ) {\n        // Clear stationNames list if non-rail pass selected\n        vm.postJSON.stationNames = null;\n      }\n    }\n\n    // if pass is swift abt\n    function swiftABT() {\n      vm.passValue = vm.postJSON.brand;\n      if (vm.passValue === 'Swift Go') {\n        vm.isHideCheck = !vm.isHideCheck;\n        vm.postJSON.timeBand = null;\n        vm.postJSON.stationNames = null;\n      } else if (\n        vm.passValue === 'nbus' ||\n        vm.passValue === 'National Express' ||\n        vm.passValue === 'Diamond Bus' ||\n        vm.passValue === 'Stagecoach' ||\n        vm.passValue === 'Swift PAYG' ||\n        vm.passValue === 'West Midlands Metro'\n      ) {\n        // Clear stationNames list if non-rail pass selected\n        vm.postJSON.stationNames = null;\n      }\n    }\n\n    // if brand is ntrain out of county\n    function ntrainOOC() {\n      vm.passValue = vm.postJSON.brand;\n\n      if (vm.passValue === 'ntrain - Out of County') {\n        vm.isHideCheck = !vm.isHideCheck;\n        vm.stationFromReqOOC = true; // set from station to required\n        vm.stationToReqOOC = true; // set to station to required\n        vm.stationFromName = null;\n        vm.stationToName = null;\n        vm.stationViaOneName = null;\n      } else {\n        vm.stationFromReqOOC = false; // set from station to not required\n        vm.stationToReqOOC = false; // set to station to not required\n        if ($location.search().stationNames) {\n          // if station names in url assign station vars\n          stations = $location.search().stationNames;\n          stationSel = stations.toString();\n          stationSplit = stationSel.split(',');\n          vm.stationFromName = stationSplit['0'];\n          vm.stationToName = stationSplit['1'];\n          vm.stationViaOneName = stationSplit['2'];\n        }\n      }\n    }\n\n    // get tickets you can buy on swift\n    function getSwiftPAYG() {\n      ticketingService\n        .getSwiftSearch()\n        .then(function(response) {\n          vm.swiftPaygIds = [];\n\n          angular.forEach(response, function(item) {\n            if (item.swiftCurrentAmount) {\n              vm.swiftPaygIds.push(item);\n            }\n          });\n        })\n        .catch(function(error) {\n          vm.errorMessage = 'There was a problem loading Swift data. Please try again later.';\n          vm.loadingStatus = 'error';\n          console.error(error);\n        });\n    }\n\n    // if pass is swift abt\n    function selectPass() {\n      vm.passValue = vm.postJSON.brand;\n      if (vm.passValue === '') {\n        console.log('select pass');\n        vm.clearFilter();\n      }\n    }\n\n    // set current date to test for ticketFutureDate\n    vm.date = new Date();\n  }\n\n  // FILTERS\n\n  // filter to replace text\n  replace.$inject = [];\n  function replace() {\n    let regex;\n    return function(input, from, to) {\n      if (input === undefined) {\n        return;\n      }\n      regex = new RegExp(from, 'g');\n      return input.replace(regex, to);\n    };\n  }\n})();\n"]}